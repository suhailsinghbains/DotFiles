'use strict';var yf;var zf=chrome.i18n.getMessage("545449835455981095");u("mr.IssueSeverity",{rt:"fatal",iy:"warning",wv:"notification"});u("mr.IssueAction",{et:"dismiss",Du:"learn_more"});
var Af=function(a,b){this.sinkId=this.routeId=null;this.severity=b;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction="dismiss";this.helpPageId=this.secondaryActions=null},Cf=function(){var a=new Af(Bf,"notification");a.helpPageId=6320939;a.defaultAction="learn_more";a.secondaryActions=["dismiss"];return a},Df=function(a){a.isBlocking=!0;return a},Ef=function(a,b){a.routeId=b;return a},Ff=function(a,b){a.sinkId=b;return a};var Gf=function(a,b){var c=this;this.f=void 0===b?null:b;this.b=new Promise(function(b,e){var d=function(a){c.f=null;e(a)};c.g=d;a(function(a){c.f=null;b(a)},d)})};Gf.prototype.cancel=function(a){this.g(a);if(this.f){var b=this.f;this.f=null;setTimeout(function(){return b(a)},0)}};var Hf=function(a,b,c){c=void 0===c?null:c;return new Gf(function(d,e){a.b.then(function(a){if(b)try{d(b(a))}catch(h){e(h)}else d(a)},function(a){if(c)try{d(c(a))}catch(h){e(h)}else e(a)})},function(c){a.cancel(c)})};
Gf.prototype.then=function(a,b){return Hf(this,a,void 0===b?null:b)};Gf.prototype.catch=function(a){return Hf(this,null,a)};var If=function(a){return new Gf(function(b){b(a)})},Jf=function(a){return new Gf(function(b,c){c(a)})},Kf=function(a){return new Gf(function(b,c){a.then(b,c)})},Lf=function(a,b){var c=!1,d=null;return new Gf(function(e,f){a.then(function(a){c||(d=b(a),d.b.then(e,f))},f)},function(a){d?d.cancel(a):c=!0})};var Mf={qs:0,os:1,ss:2,ps:3,Pr:4,rs:5,Xt:6,Kx:7,Zs:8,Tn:9},Nf=function(a,b){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=b&&9>=b?b:9};n(Nf,Error);var Of=function(){var a=k(navigator.userAgent.match(/Windows NT (\d+.\d+)/)||[]);a.next();a=a.next().value;return 6.2<=parseFloat(a)},Pf=function(){var a=navigator.userAgent;return a.includes("CrOS")?"ChromeOS":a.includes("Windows")?"Windows":a.includes("Macintosh")?"Mac":a.includes("Linux")?"Linux":"Other"};var Qf=!("undefined"==typeof chrome||!chrome.networkingPrivate||!chrome.networkingPrivate.setWifiTDLSEnabledState||"ChromeOS"!=Pf()),Rf=["ChromeOS","Windows"].includes(Pf());var Sf=function(a,b,c,d){this.f=a;this.b=b;this.g=c||null;this.presentationId=d||null},Vf=function(a,b){if("tab"==a.f)a=Tf(a);else if("offscreen_tab"==a.f)b=Tf(a),b.presentationId=a.presentationId,a=b;else{var c={audio:!1,video:!1};a.b.shouldCaptureVideo?(c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b}},Uf(a,c.video.mandatory),Rf&&a.b.shouldCaptureAudio&&(c.audio={mandatory:{chromeMediaSource:"system",chromeMediaSourceId:b}})):a.b.shouldCaptureAudio&&(c.audio={mandatory:{chromeMediaSource:"system"}});
a=c}return a},Tf=function(a){var b={audio:a.b.shouldCaptureAudio,video:a.b.shouldCaptureVideo};a.b.shouldCaptureVideo&&(b.videoConstraints={mandatory:{enableAutoThrottling:!0}},Uf(a,b.videoConstraints.mandatory));return b},Uf=function(a,b){var c=a.b.minWidth,d=a.b.minHeight;if(a.b.senderSideLetterboxing){c=a.b;if(0==c.minHeight||0==c.maxHeight?0:Math.floor(100*c.minWidth/c.minHeight)==Math.floor(100*c.maxWidth/c.maxHeight))c={width:c.minWidth,height:c.minHeight};else{d=c.maxWidth;for(var e=c.maxHeight;0!=
e;){var f=d%e;d=e;e=f}e=c.maxWidth/d;d=c.maxHeight/d;if(e<c.minWidth||d<c.minHeight)if(f=Math.max(c.minWidth/e,c.minHeight/d),e*=f,d*=f,e>c.maxWidth||d>c.maxHeight)e=c.maxWidth,d=c.maxHeight;e=Math.round(e);d=Math.round(d);c={width:e,height:d}}d=c;c=d.width;d=d.height}Object.assign(b,{minWidth:c,minHeight:d,maxWidth:a.b.maxWidth,maxHeight:a.b.maxHeight,minFrameRate:a.b.minFrameRate,maxFrameRate:a.b.maxFrameRate})};var Wf=function(a){this.b=a;this.f=this.Df=null;this.m=gb("mr.mirror.MirrorMediaStream")};Wf.prototype.start=function(){return"tab"==this.b.f?Xf(this):"offscreen_tab"==this.b.f?Yf(this):Zf(this)};var Xf=function(a){var b=Vf(a.b);a.m.info("Starting tab capture with constraints "+JSON.stringify(b));return new Promise(function(c,d){chrome.tabCapture.capture(b,function(b){b?($f(a,b),c(a)):d(ag())});window.setTimeout(function(){d(new Nf("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};
Wf.prototype.g=function(a){a&&this.m.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
var ag=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new Nf(chrome.runtime.lastError.message,7):new Nf("empty_stream",0)},bg=function(a){var b=void 0===b?6E4:b;return new Promise(function(c,d){var e=["screen","audio"];"Linux"==Pf()&&e.push("window");var f=window.setTimeout(function(){h&&chrome.desktopCapture.cancelChooseDesktopMedia(h);d(new Nf("timeout",1))},b);var h=chrome.desktopCapture.chooseDesktopMedia(e,a||null,function(a){window.clearTimeout(f);a?c(a):d(new Nf("User cancelled capture dialog",
3))})})},cg=function(a,b){return new Promise(function(c,d){a.m.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(b)});navigator.mediaDevices.getUserMedia(b).then(function(b){b||d(new Nf("empty_stream",8));$f(a,b);c(b)},function(a){var c=8;"NotAllowedError"==a.name&&(c=3);d(new Nf(a.name+" "+a.constraintName+": "+a.message,c))})})},Zf=function(a){return Rf&&a.b.b.shouldCaptureAudio&&!a.b.b.shouldCaptureVideo?cg(a,Vf(a.b)).then(function(){return a}):bg().then(function(b){b=
Vf(a.b,b);return cg(a,b).then(function(){return a})})},Yf=function(a){var b=Vf(a.b);a.m.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(b)});return new Promise(function(c,d){chrome.tabCapture.captureOffscreenTab(a.b.g.toString(),b,function(b){b?($f(a,b),c(a)):d(ag())})})},$f=function(a,b){a.f=b;b.getAudioTracks().length||b.getVideoTracks();b.getTracks().forEach(function(c){c.onended=a.g.bind(a)})};
Wf.prototype.stop=function(){this.f&&(this.f.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.f=null,this.Df&&this.Df())};var dg=function(){},hg=function(a){var b=eg.get(a)||null;if(b)return Promise.resolve(b);b=fg.get(a);b||(b=new Cb,fg.set(a,b),gg(a,b));return b.b},gg=function(a,b){var c=ig.get(a)||null;if(!c)b.reject(Error("No corresponding bundle for "+a));else if(!jg.has(c)){var d=kg.get(c);d||(lg.info("Loading bundle "+c+" for module "+a),d=mg(c),kg.set(c,d));d.catch(function(a){b.reject(a)})}},mg=function(a){var b=new Cb;b.b.then(function(){lg.info("Bundle "+a+" loaded")},function(c){lg.error("Failed to load bundle "+
a);throw c;});var c=document.createElement("script");c.src=chrome.extension.getURL(a);c.setAttribute("type","text/javascript");c.async=!0;c.onload=function(){return b.resolve(void 0)};c.onerror=function(){return b.reject(Error("Failed to load bundle "+a))};document.head.appendChild(c);return b.b},og=function(a,b){if(eg.has(a))throw Error("Duplicate module "+a);eg.set(a,b);(a=fg.get(a))&&a.resolve(b)};
dg.prototype.handleEvent=function(a,b){for(var c=1;c<arguments.length;++c);throw Error("Not implemented");};
var ig=new Map([["mr.cast.ChannelService","background_script.js"],["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.slarti.SinkDiscoveryService","background_script.js"],["mr.cloud.discovery.WeaveSinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.mirror.hangouts.MeetingsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService",
"mirroring_webrtc.js"]]),jg=new Set(["background_script.js"]),lg=gb("mr.Module"),eg=new Map,fg=new Map,kg=new Map;var pg,qg={Mu:0,ts:1,us:2,at:3,bt:4,Ct:5,Zt:6,Ku:7,mv:8,nv:9,uw:10,fx:11,gx:12,vx:13,Jx:14},rg=function(a){void 0==pg&&(Bb("MediaRouter.Provider.WakeEvent",a,qg),pg=a)};var vg=function(a){return sg(a)||tg(a)},wg=function(a){if(!a.startsWith("http:")&&!a.startsWith("https:"))return!1;var b=document.createElement("a");b.href=a;return"http:"!=b.protocol&&"https:"!=b.protocol?!1:-1==b.hash.indexOf("__castAppId__")},xg=["https://docs.google.com"],sg=function(a){return a.startsWith("urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},tg=function(a){return"urn:x-org.chromium.media:source:desktop"==a},yg=function(a){var b=a.search("urn:x-org.chromium.media:source:tab:");
return-1==b?null:parseInt(a.substr(b+36),10)||null};var zg=function(a,b){this.Y=a;this.g=b||null;this.f=this.b=null;this.L=gb("mr.mirror.Service."+a);this.M=this.zb.bind(this);this.u=!1};n(zg,dg);g=zg.prototype;g.initialize=function(a,b){this.u||(this.g=a,this.u=!0,this.bg(b))};g.bg=function(){};g.getName=function(){return this.Y};
g.Zi=function(a,b,c,d,e){var f=this;this.L.info("Start mirroring on route "+a.id);if(!this.u)return Jf(Error("Not initialized"));var h=new Promise(function(h,r){f.l().then(function(){var a=Ag(b,c,d);return(new Wf(a)).start()}).then(function(c){if(f.f)throw c.stop(),new Nf("Cannot start multiple streams");f.f=c;c=f.w.bind(f);f.f.Df=c;return e?e(a).b:a}).then(function(a){if(f.b)throw new Nf("Cannot start multiple sessions");if(!f.f)throw new Nf("Media stream ended before session could start.");f.b=
f.eh(c,a);a.ib.bc=f.b.bc;a=f.g.Ai.bind(f.g);f.b.C=a;return f.b.start(f.f.f)}).then(function(){sg(b)&&!chrome.tabs.onUpdated.hasListener(f.M)&&chrome.tabs.onUpdated.addListener(f.M);return f.O(a,b,c)}).then(function(){h(a)}).catch(function(a){Bg(f,a);return f.w().then(function(){r(a)})})});return Kf(h)};g.aj=function(a,b,c,d,e,f){this.L.info("Update mirroring on route "+a.id);return this.u?Kf(Cg(this,a,b,c,d,f)):Jf(Error("Not initialized"))};
var Cg=function(a,b,c,d,e,f){if(!a.b)return Promise.reject(new Nf("No session to update streams on",7));if(!a.b.qm())return Promise.reject(new Nf("Session does not support updating stream",7));var h=!1;return new Promise(function(l,r){var y=Ag(c,d,e);(new Wf(y)).start().then(function(c){a.f&&(a.f.Df=null,a.f.stop(),a.Eg());a.f=c;c=a.w.bind(a);a.f.Df=c;h=!0;return f?f(b).b:b}).then(function(){if(!a.b)throw new Nf("Session ended while updating stream");if(!a.f)throw new Nf("Media stream ended before session could be updated.");
return a.b.xm(a.f.f)}).then(a.O.bind(a,b,c,d)).then(function(){return l(b)}).catch(function(c){Bg(a,c);if(h)return a.w().then(function(){r(c)});r(c)})})};
zg.prototype.O=function(a,b,c){var d=this;return new Promise(function(e,f){if(d.b){sg(b)?(Dg(d.b,a.ib.tabId),d.Fg()):wg(b)?(Dg(d.b,a.ib.tabId),d.Hh()):d.Cg();f=d.f;var h=a.sinkId;c.shouldCaptureAudio&&f.f&&!f.f.getAudioTracks().length&&d.g.ze(Ff(new Af(zf,"notification"),h));Eg(d.b);e()}else f(new Nf("Session gone before executing post-startup steps",7))})};
var Bg=function(a,b){b.reason=null!=b.reason?b.reason:9;a.L.error("Failed to start mirroring: "+b.message+(",  reason = "+b.reason+": "+b.stack));a.Gh(b.reason)};zg.prototype.l=function(){var a=this;return this.u?this.w().then(function(b){b&&a.Dg();return b}):Promise.reject("Not initialized")};
zg.prototype.w=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.M);var b=this.f;this.f=null;b&&(b.Df=null);var c=this.b;this.b=null;var d;c?d=this.hi(c).catch(function(c){return a.L.error("Error in before-cleanup steps",c)}).then(function(){return c.stop()}).catch(function(c){return a.L.error("Error stopping session",c)}).then(function(){a.g.cj(c.f.id)}).catch(function(c){return a.L.error("Error in ended callbacks",c)}).then(function(){return!0}):d=Promise.resolve(!1);b&&(d=d.then(function(c){b.stop();
a.Eg();return c}));return d};zg.prototype.hi=function(){return Promise.resolve()};zg.prototype.zb=function(a,b,c){rg(14);this.b&&Fg(this.b,a,b,c)};var Ag=function(a,b,c){if(sg(a))return new Sf("tab",b);if(tg(a))return new Sf("desktop",b);if(wg(a)){if(!c)throw new Nf("Missing offscreen tab presentation id");return new Sf("offscreen_tab",b,a,c)}throw new Nf("Source URN does not suggest a known capture type.");};g=zg.prototype;g.eh=function(){};g.Fg=function(){};g.Cg=function(){};g.Hh=function(){};
g.Dg=function(){};g.Gh=function(){};g.Eg=function(){};g.Yi=function(){return db()};g.createMediaRouteController=function(){return db()};var Gg=function(a,b,c){this.f=a;this.h=b;this.b=void 0===c?null:c;this.g=null},Hg=function(a){switch(a.f){case "mirror_tab":return a.b?"Casting tab ("+a.b+")":"Casting tab";case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return a.b?"Casting media ("+a.b+")":"Casting media";case "presentation":return"Casting "+(a.b||"site");default:return""}},Ig=function(a){if(a.h)return"Casting active";switch(a.f){case "mirror_tab":return"Casting tab";
case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return"Casting media";case "presentation":return"Casting site";default:return""}};var Jg=function(a){return(new Promise(function(b){chrome.tabs.get(a,b)})).then(function(b){if(!b)throw Error("No such tab "+a);return b})};var Kg=function(a,b){this.f=a;this.C=void 0===b?null:b;b=null;var c=a.mediaSource;if(wg(c)){var d="presentation";b=(new URL(c)).origin}else sg(c)?d="mirror_tab":tg(c)&&(d="mirror_desktop");this.bc=new Gg(d,a.offTheRecord,b);this.j=this.tabId=null;this.D=!1},Dg=function(a,b){a.tabId!=b?(a.tabId=b,Jg(b).then(function(c){a.j=c;Eg(a)})):Promise.resolve()},Fg=function(a,b,c,d){b==a.tabId&&("complete"==c.status||c.favIconUrl&&"complete"==d.status)&&(a.j=d,Eg(a))},Eg=function(a){if(a.j){a.bc.g=a.j.title;
a.bc.h=a.j.incognito;var b=new URL(a.j.url);"file:"==b.protocol?(a.bc.f="mirror_file",a.bc.b=null):(a.bc.f=a.D?"media_remoting":"mirror_tab",a.bc.b="https:"==b.protocol?b.origin.substr(8):b.origin)}a.f.description=Hg(a.bc);a.C&&a.C(a.f,a.bc);a.am()};g=Kg.prototype;g.start=function(){};g.qm=function(){return!1};g.xm=function(){};g.stop=function(){return Promise.resolve()};g.am=function(){};var Og=function(){var a=this;this.maxWidth=1920;this.maxHeight=1080;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.minFrameRate=0;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.maxLatencyMillis=800;this.animatedLatencyMillis=this.minLatencyMillis=400;this.dscpEnabled=["Mac","Linux","ChromeOS"].includes(Pf())||Of();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;var b=window.localStorage?
window.localStorage.getItem(Lg):null;if(b)try{var c=JSON.parse(String(b));if(c instanceof Object)Mg(this,c),gb("mr.mirror.Settings").F(function(){return"Initial mr.mirror.Settings overridden to: "+Ng(a)});else throw Error("localStorage["+Lg+"] "+("does not parse as an Object: "+b));}catch(d){throw gb("mr.mirror.Settings").error(Lg+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',d),Error("Overrides not parseable.  See ERROR log for details.");}};
Og.prototype.clone=function(){var a=new Og;Mg(a,this);return a};
var Ng=function(a){return JSON.stringify(a,function(a,c){if(0==a.length||!a.endsWith("_"))return c})},Mg=function(a,b){for(var c=k(Object.keys(b)),d=c.next();!d.done;d=c.next())d=d.value,d.endsWith("_")||typeof b[d]!==typeof a[d]||(a[d]=b[d])},Pg=function(a){var b=screen.width,c=screen.height;a.maxHeight*b<a.maxWidth*c?(b=Math.min(a.maxWidth,b),b-=b%160,c=90*b/160):(c=Math.min(a.maxHeight,c),c-=c%90,b=160*c/90);if(b<Math.max(160,a.minWidth)||c<Math.max(90,a.minHeight))b=Math.max(160,a.minWidth),c=
Math.max(90,a.minHeight);a.maxWidth=b;a.maxHeight=c},Lg="mr.mirror.Settings.Overrides";var Qg=function(a,b){this.type=a;this.data=b},Rg=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new Qg(a.type,a.data)},Sg=function(a,b,c,d,e){this.description=a;this.settings=b||null;this.mediaConstraints=c||null;this.presentationUrl=d||null;this.presentationId=e||null};var Vg=function(a,b){this.m=gb("cv2.PeerConnection");this.N=Tg;this.Z=Ug(this,b);this.h=this.Z.createDataChannel(a,{reliable:!1});this.C=new Cb;this.o=!1;this.g=0;this.f=null;this.A=this.j=0;this.b=!1;this.w=function(){};this.l=function(){};this.B=function(){};this.u=function(){}},Wg=function(a,b){a.l=b},Xg=function(a,b){a.B=b},Yg=function(a,b){a.u=b},Zg=function(a,b){a.w=b},$g=function(a,b){a.h.onmessage=function(a){b(a.data)}},ah=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);
return b},Ug=function(a,b){var c=ah(b);b=new webkitRTCPeerConnection(c);b.onicecandidate=a.G.bind(a);b.b=a.M.bind(a);b.oniceconnectionstatechange=a.K.bind(a);a.m.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(c)});return b};Vg.prototype.start=function(){this.b||(this.b=!0,bh(this))};Vg.prototype.stop=function(){this.m.info("Stopping peer connection...");this.b&&(this.b=!1,"closed"!=this.Z.signalingState&&this.Z.close());this.Z=null};
var bh=function(a){a.m.info("Sending offer to peer.");a.j=Date.now();a.Z.createOffer(a.D.bind(a),function(b){a.m.F("Error creating offer.",b)},a.N);a.C.b.then(function(b){a.w(b)})};Vg.prototype.D=function(a){var b=this;this.m.info(function(){return"Setting local description: "+JSON.stringify(a)});this.Z.setLocalDescription(a,function(){b.m.info("Local description set successfully")},function(a){b.m.F("Error setting local description.",a)})};
var ch=function(a,b){nb(a.m,function(){return"<===: "+JSON.stringify(b)});var c=new RTCSessionDescription(b);a.m.info(function(){return"Setting remote description: "+JSON.stringify(c)});a.Z.setRemoteDescription(c,function(){a.m.info("Remote description set successfully.")},function(c){a.m.F("Error setting remote description.",c)})};
Vg.prototype.G=function(a){var b=this;a.candidate?(this.g++,this.A=Date.now(),1==this.g?this.f=setTimeout(function(){b.m.info("ICE candidate gathering timed out.");b.f=null;dh(b)},5E3):this.o&&this.m.F("Received ICE candidate after resolving session description.")):(this.m.info("End of ICE candidates."),tb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.j),dh(this),0<this.g&&tb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.A-this.j))};
Vg.prototype.M=function(){"completed"==this.Z.iceGatheringState&&dh(this)};var dh=function(a){clearTimeout(a.f);a.f=null;if(!a.o){a.m.info("Resolving sesion description after gathering "+a.g+" ICE candidates.");var b=a.Z.localDescription;a.C.resolve({type:b.type,sdp:b.sdp});a.o=!0}};
Vg.prototype.K=function(a){var b=this;if(this.Z){var c=this.Z.iceConnectionState;this.m.info("New ICE connection state: "+c+".");"connected"==c?this.l("iceconnected"):"completed"==c?this.l("icecompleted"):"failed"==c?(this.m.F(function(){return"Ice connection failed: "+JSON.stringify(a)}),this.B("icefailed")):"closed"==c?this.u("iceclosed"):"disconnected"==c&&(this.m.F("Ice connection state is bad."),this.b&&(this.m.info("Restarting ICE."),this.Z.createOffer(this.D.bind(this),function(a){b.m.F("Error creating new offer.",
a)},eh)))}};var Tg={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},eh={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};var fh=function(){var a=window.crypto.getRandomValues(new Uint8Array(16));return Mb(a,function(a){a=a.toString(16);return 1<a.length?a:"0"+a}).join("")},gh=function(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(55296==(e&64512)&&d+1<a.length&&56320==(a.charCodeAt(d+1)&64512)?(e=65536+((e&1023)<<10)+(a.charCodeAt(++d)&1023),b[c++]=e>>18|240,b[c++]=e>>12&63|128):b[c++]=e>>12|224,b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b},hh=function(a){for(var b=
[],c=0,d=0;c<a.length;){var e=a[c++];if(128>e)b[d++]=String.fromCharCode(e);else if(191<e&&224>e){var f=a[c++];b[d++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){f=a[c++];var h=a[c++],l=a[c++];e=((e&7)<<18|(f&63)<<12|(h&63)<<6|l&63)-65536;b[d++]=String.fromCharCode(55296+(e>>10));b[d++]=String.fromCharCode(56320+(e&1023))}else f=a[c++],h=a[c++],b[d++]=String.fromCharCode((e&15)<<12|(f&63)<<6|h&63)}return b.join("")};var ih=bd(),jh=dd()||Kc("iPod"),kh=Kc("iPad"),lh=Kc("Android")&&!(cd()||bd()||Kc("Opera")||Kc("Silk")),mh=cd(),nh=Kc("Safari")&&!(cd()||Kc("Coast")||Kc("Opera")||Kc("Edge")||bd()||Kc("Silk")||Kc("Android"))&&!(dd()||Kc("iPad")||Kc("iPod"));var oh=null,ph=null,rh=function(a){qh();for(var b=oh,c=[],d=0;d<a.length;d+=3){var e=a[d],f=d+1<a.length,h=f?a[d+1]:0,l=d+2<a.length,r=l?a[d+2]:0,y=e>>2;e=(e&3)<<4|h>>4;h=(h&15)<<2|r>>6;r&=63;l||(r=64,f||(h=64));c.push(b[y],b[e],b[h],b[r])}return c.join("")},th=function(a){var b=a.length,c=0;"="===a[b-2]?c=2:"="===a[b-1]&&(c=1);var d=new Uint8Array(Math.ceil(3*b/4)-c),e=0;sh(a,function(a){d[e++]=a});return d.subarray(0,e)},sh=function(a,b){function c(c){for(;d<a.length;){var b=a.charAt(d++),e=ph[b];
if(null!=e)return e;if(!qc(b))throw Error("Unknown base64 encoding at char: "+b);}return c}qh();for(var d=0;;){var e=c(-1),f=c(0),h=c(64),l=c(64);if(64===l&&-1===e)break;b(e<<2|f>>4);64!=h&&(b(f<<4&240|h>>2),64!=l&&b(h<<6&192|l))}},qh=function(){if(!oh){oh={};ph={};for(var a=0;65>a;a++)oh[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),ph[oh[a]]=a,62<=a&&(ph["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}};var uh=0,vh=0,wh=function(a){var b=0>a;a=Math.abs(a);var c=a>>>0;a=Math.floor((a-c)/4294967296);a>>>=0;b&&(a=~a>>>0,c=(~c>>>0)+1,4294967295<c&&(c=0,a++,4294967295<a&&(a=0)));uh=c;vh=a},xh=function(a){var b=0>a?1:0;a=b?-a:a;if(0===a)0<1/a?uh=vh=0:(vh=0,uh=2147483648);else if(isNaN(a))vh=0,uh=2147483647;else if(3.4028234663852886E38<a)vh=0,uh=(b<<31|2139095040)>>>0;else if(1.1754943508222875E-38>a)a=Math.round(a/Math.pow(2,-149)),vh=0,uh=(b<<31|a)>>>0;else{var c=Math.floor(Math.log(a)/Math.LN2);a*=
Math.pow(2,-c);a=Math.round(8388608*a)&8388607;vh=0;uh=(b<<31|c+127<<23|a)>>>0}},yh=function(a){if(a.constructor===Uint8Array)return a;if(a.constructor===ArrayBuffer)return new Uint8Array(a);if(a.constructor===Array)return new Uint8Array(a);if(a.constructor===String)return th(a);Gb("Type not convertible to Uint8Array.");return new Uint8Array(0)};var Ah=function(a,b,c){this.f=null;this.A=this.u=this.b=this.g=this.j=0;this.o=!1;a&&zh(this,a,b,c)},Bh=[],Ch=function(a,b,c){if(Bh.length){var d=Bh.pop();a&&zh(d,a,b,c);return d}return new Ah(a,b,c)};Ah.prototype.clone=function(){return Ch(this.f,this.j,this.g-this.j)};Ah.prototype.clear=function(){this.f=null;this.b=this.g=this.j=0;this.o=!1};var zh=function(a,b,c,d){a.f=yh(b);a.j=Ia(c)?c:0;a.g=Ia(d)?a.j+d:a.f.length;a.b=a.j};Ah.prototype.reset=function(){this.b=this.j};
Ah.prototype.h=function(){var a=this.f;var b=a[this.b+0];var c=b&127;if(128>b)return this.b+=1,c;b=a[this.b+1];c|=(b&127)<<7;if(128>b)return this.b+=2,c;b=a[this.b+2];c|=(b&127)<<14;if(128>b)return this.b+=3,c;b=a[this.b+3];c|=(b&127)<<21;if(128>b)return this.b+=4,c;b=a[this.b+4];c|=(b&15)<<28;if(128>b)return this.b+=5,c>>>0;this.b+=5;128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&this.b++;return c};Ah.prototype.l=Ah.prototype.h;Ah.prototype.B=function(){return this.l()};var Dh=function(a){this.b=Ch(a,void 0,void 0);this.l=this.b.b;this.h=this.f=-1;this.j=!1},Eh=function(a){return 4==a.h};Dh.prototype.reset=function(){this.b.reset();this.h=this.f=-1};
var Fh=function(a){var b=a.b;if(b.b==b.g)return!1;(b=a.j)||(b=a.b,b=b.o||0>b.b||b.b>b.g);if(b)return Gb("Decoder hit an error"),!1;a.l=a.b.b;var c=a.b.h();b=c>>>3;c&=7;if(0!=c&&5!=c&&1!=c&&2!=c&&3!=c&&4!=c)return Gb("Invalid wire type: %s (at position %s)",c,a.l),a.j=!0,!1;a.f=b;a.h=c;return!0},Gh=function(a){switch(a.h){case 0:if(0!=a.h)Gb("Invalid wire type for skipVarintField"),Gh(a);else{for(a=a.b;a.f[a.b]&128;)a.b++;a.b++}break;case 1:1!=a.h?(Gb("Invalid wire type for skipFixed64Field"),Gh(a)):
(a=a.b,a.b+=8);break;case 2:if(2!=a.h)Gb("Invalid wire type for skipDelimitedField"),Gh(a);else{var b=a.b.h();a=a.b;a.b+=b}break;case 5:5!=a.h?(Gb("Invalid wire type for skipFixed32Field"),Gh(a)):(a=a.b,a.b+=4);break;case 3:b=a.f;do{if(!Fh(a)){Gb("Unmatched start-group tag: stream EOF");a.j=!0;break}if(4==a.h){a.f!=b&&(Gb("Unmatched end-group tag"),a.j=!0);break}Gh(a)}while(1);break;default:Gb("Invalid wire encoding for field.")}};
Dh.prototype.g=function(a,b){var c=this.b.g,d=this.b.h();d=this.b.b+d;this.b.g=d;b(a,this);this.b.b=d;this.b.g=c};
var Hh=function(a){return!!a.b.h()},Ih=function(a){a=a.b;a:{for(var b,c=0,d,e=0;4>e;e++)if(b=a.f[a.b++],c|=(b&127)<<7*e,128>b){a.u=c>>>0;a.A=0;break a}b=a.f[a.b++];c|=(b&127)<<28;d=0|(b&127)>>4;if(128>b)a.u=c>>>0,a.A=d>>>0;else{for(e=0;5>e;e++)if(b=a.f[a.b++],d|=(b&127)<<7*e+3,128>b){a.u=c>>>0;a.A=d>>>0;break a}Gb("Failed to read varint, encoding is invalid.");a.o=!0}}b=a.u;c=a.A;if(a=c&2147483648)b=~b+1>>>0,c=~c>>>0,0==b&&(c=c+1>>>0);b=4294967296*c+b;return a?-b:b},Jh=function(a){var b=a.b.h();a=
a.b;var c=a.f,d=a.b,e=d+b,f=[];for(b="";d<e;){var h=c[d++];if(128>h)f.push(h);else if(192>h)continue;else if(224>h){var l=c[d++];f.push((h&31)<<6|l&63)}else if(240>h){l=c[d++];var r=c[d++];f.push((h&15)<<12|(l&63)<<6|r&63)}else if(248>h){l=c[d++];r=c[d++];var y=c[d++];h=(h&7)<<18|(l&63)<<12|(r&63)<<6|y&63;h-=65536;f.push((h>>10&1023)+55296,(h&1023)+56320)}8192<=f.length&&(b+=String.fromCharCode.apply(null,f),f.length=0)}if(8192>=f.length)f=String.fromCharCode.apply(null,f);else{c="";for(e=0;e<f.length;e+=
8192)c+=String.fromCharCode.apply(null,fc(f,e,e+8192));f=c}a.b=d;return b+f},Kh=function(a,b){var c=a.b.h();c=a.b.b+c;for(var d=[];a.b.b<c;)d.push(b.call(a.b));return d};var Lh=function(a,b){this.b=a;this.f=b},Mh=function(a){return new Lh((a.b>>>1|(a.f&1)<<31)>>>0,a.f>>>1>>>0)},Nh=function(a){return new Lh(a.b<<1>>>0,(a.f<<1|a.b>>>31)>>>0)};Lh.prototype.add=function(a){return new Lh((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};Lh.prototype.sub=function(a){return new Lh((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};
var Oh=function(a){var b=a&65535,c=a>>>16;a=10*b+65536*(0*b&65535)+65536*(10*c&65535);for(b=0*c+(0*b>>>16)+(10*c>>>16);4294967296<=a;)a-=4294967296,b+=1;return new Lh(a>>>0,b>>>0)};
Lh.prototype.toString=function(){for(var a="",b=this;0!=b.b||0!=b.f;){var c=new Lh(0,0);b=new Lh(b.b,b.f);for(var d=new Lh(10,0),e=new Lh(1,0);!(d.f&2147483648);)d=Nh(d),e=Nh(e);for(;0!=e.b||0!=e.f;)0>=(d.f<b.f||d.f==b.f&&d.b<b.b?-1:d.f==b.f&&d.b==b.b?0:1)&&(c=c.add(e),b=b.sub(d)),d=Mh(d),e=Mh(e);c=[c,b];b=c[0];a=c[1].b+a}""==a&&(a="0");return a};
var Ph=function(a){for(var b=new Lh(0,0),c=new Lh(0,0),d=0;d<a.length;d++){if("0">a[d]||"9"<a[d])return null;c.b=parseInt(a[d],10);var e=Oh(b.b);b=Oh(b.f);b.f=b.b;b.b=0;b=e.add(b).add(c)}return b};Lh.prototype.clone=function(){return new Lh(this.b,this.f)};var Qh=function(a,b){this.b=a;this.f=b};Qh.prototype.add=function(a){return new Qh((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};
Qh.prototype.sub=function(a){return new Qh((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};Qh.prototype.clone=function(){return new Qh(this.b,this.f)};Qh.prototype.toString=function(){var a=0!=(this.f&2147483648),b=new Lh(this.b,this.f);a&&(b=(new Lh(0,0)).sub(b));return(a?"-":"")+b.toString()};var Rh=function(){this.b=[]};Rh.prototype.length=function(){return this.b.length};var Sh=function(a){var b=a.b;a.b=[];return b},Th=function(a,b,c){for(;0<c||127<b;)a.b.push(b&127|128),b=(b>>>7|c<<25)>>>0,c>>>=7;a.b.push(b)},Uh=function(a,b){for(;127<b;)a.b.push(b&127|128),b>>>=7;a.b.push(b)},Vh=function(a,b){if(0<=b)Uh(a,b);else{for(var c=0;9>c;c++)a.b.push(b&127|128),b>>=7;a.b.push(1)}},Wh=function(a,b){a.b.push(b>>>0&255);a.b.push(b>>>8&255);a.b.push(b>>>16&255);a.b.push(b>>>24&255)};var z=function(){this.h=[];this.g=0;this.f=new Rh},Yh=function(a,b){Xh(a,b,2);b=Sh(a.f);a.h.push(b);a.g+=b.length;b.push(a.g);return b},Zh=function(a,b){var c=b.pop();for(c=a.g+a.f.length()-c;127<c;)b.push(c&127|128),c>>>=7,a.g++;b.push(c);a.g++};z.prototype.reset=function(){this.h=[];Sh(this.f);this.g=0};
var A=function(a){for(var b=new Uint8Array(a.g+a.f.length()),c=a.h,d=c.length,e=0,f=0;f<d;f++){var h=c[f];b.set(h,e);e+=h.length}c=Sh(a.f);b.set(c,e);a.h=[b];return b},Xh=function(a,b,c){Uh(a.f,8*b+c)},C=function(a,b,c){null!=c&&null!=c&&(Xh(a,b,0),Vh(a.f,c))},D=function(a,b,c){null!=c&&null!=c&&(Xh(a,b,0),a=a.f,wh(c),Th(a,uh,vh))},$h=function(a,b,c){if(null!=c){var d=c;(c=0<d.length&&"-"==d[0])&&(d=d.substring(1));d=Ph(d);null===d?c=null:(c&&(d=(new Lh(0,0)).sub(d)),c=new Qh(d.b,d.f));Xh(a,b,0);
Th(a.f,c.b,c.f)}},ai=function(a,b,c){null!=c&&null!=c&&(Xh(a,b,0),Uh(a.f,c))},bi=function(a,b,c){null!=c&&null!=c&&(Xh(a,b,0),a=a.f,wh(c),Th(a,uh,vh))},ci=function(a,b,c){null!=c&&(c=Ph(c),Xh(a,b,0),Th(a.f,c.b,c.f))},di=function(a,b,c){null!=c&&(Xh(a,b,5),Wh(a.f,c))},ei=function(a,b,c){null!=c&&(Xh(a,b,5),a=a.f,xh(c),Wh(a,uh))},E=function(a,b,c){null!=c&&(Xh(a,b,0),a.f.b.push(c?1:0))},F=function(a,b,c){null!=c&&(Xh(a,b,0),Vh(a.f,c))},H=function(a,b,c){if(null!=c){b=Yh(a,b);for(var d=a.f,e=0;e<c.length;e++){var f=
c.charCodeAt(e);if(128>f)d.b.push(f);else if(2048>f)d.b.push(f>>6|192),d.b.push(f&63|128);else if(65536>f)if(55296<=f&&56319>=f&&e+1<c.length){var h=c.charCodeAt(e+1);56320<=h&&57343>=h&&(f=1024*(f-55296)+h-56320+65536,d.b.push(f>>18|240),d.b.push(f>>12&63|128),d.b.push(f>>6&63|128),d.b.push(f&63|128),e++)}else d.b.push(f>>12|224),d.b.push(f>>6&63|128),d.b.push(f&63|128)}Zh(a,b)}},fi=function(a,b,c){null!=c&&(c=yh(c),Xh(a,b,2),Uh(a.f,c.length),b=Sh(a.f),a.h.push(b),a.h.push(c),a.g+=b.length+c.length)};
z.prototype.b=function(a,b,c){null!=b&&(a=Yh(this,a),c(b,this),Zh(this,a))};
var gi=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(Xh(e,b,0),Vh(e.f,f))}},hi=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(Xh(e,b,0),e=e.f,wh(f),Th(e,uh,vh))}},ii=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(Xh(e,b,0),Uh(e.f,f))}},ji=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)di(a,b,c[d])},ki=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)F(a,b,c[d])},li=function(a,b,c){if(null!=
c)for(var d=0;d<c.length;d++)H(a,b,c[d])},mi=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)fi(a,b,c[d])},I=function(a,b,c,d){if(null!=c)for(var e=0;e<c.length;e++){var f=Yh(a,b);d(c[e],a);Zh(a,f)}},ni=function(a,b,c,d){if(null!=c)for(var e=0;e<c.length;e++)Xh(a,b,3),d(c[e],a),Xh(a,b,4)},oi=function(a,b,c){if(null!=c&&c.length){b=Yh(a,b);for(var d=0;d<c.length;d++)Vh(a.f,c[d]);Zh(a,b)}},pi=function(a,b,c){if(null!=c&&c.length){b=Yh(a,b);for(var d=0;d<c.length;d++)Vh(a.f,c[d]);Zh(a,b)}};var J=function(){},qi="function"==typeof Uint8Array,K=function(a,b,c,d,e,f){a.b=null;b||(b=c?[c]:[]);a.Sh=c?String(c):void 0;a.h=0===c?-1:0;a.f=b;a:{c=a.f.length;b=-1;if(c&&(b=c-1,c=a.f[b],!(null===c||"object"!=typeof c||Ua(c)||qi&&c instanceof Uint8Array))){a.A=b-a.h;a.g=c;break a}-1<d?(a.A=Math.max(d,b+1-a.h),a.g=null):a.A=Number.MAX_VALUE}a.w={};if(e)for(d=0;d<e.length;d++)b=e[d],b<a.A?(b+=a.h,a.f[b]=a.f[b]||ri):(si(a),a.g[b]=a.g[b]||ri);if(f&&f.length)for(d=0;d<f.length;d++)ti(a,f[d])},ri=Object.freeze?
Object.freeze([]):[],si=function(a){var b=a.A+a.h;a.f[b]||(a.g=a.f[b]={})},ui=function(a,b,c,d){for(var e in c){var f=c[e],h=f.Po;if(!f.ji)throw Error("Message extension present that was generated without binary serialization support");var l=d.call(a,h);if(null!=l)if(h.Xf)if(f.tk)f.ji.call(b,h.Dk,l,f.tk);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else f.ji.call(b,h.Dk,l)}},L=function(a,b){if(b<a.A){b+=
a.h;var c=a.f[b];return c===ri?a.f[b]=[]:c}if(a.g)return c=a.g[b],c===ri?a.g[b]=[]:c},M=function(a,b){if(b<a.A){b+=a.h;var c=a.f[b];return c===ri?a.f[b]=[]:c}c=a.g[b];return c===ri?a.g[b]=[]:c},vi=function(a,b){a=L(a,b);return null==a?a:+a},wi=function(a){if(null==a||a instanceof Uint8Array)return a;if(Ja(a))return th(a);Gb("Cannot coerce to Uint8Array: "+Sa(a));return null},yi=function(a){xi(a);return!a.length||a[0]instanceof Uint8Array?a:Mb(a,wi)},xi=function(a){if(a&&1<a.length){var b=Sa(a[0]);
w(a,function(a){Sa(a)!=b&&Gb("Inconsistent type in JSPB repeated field array. Got "+Sa(a)+" expected "+b)})}},N=function(a,b,c){a=L(a,b);return null==a?c:a},Q=function(a,b,c){b<a.A?a.f[b+a.h]=c:(si(a),a.g[b]=c)},R=function(a,b,c){zi(a,b,c,"")},Ai=function(a,b,c){zi(a,b,c,0)},zi=function(a,b,c,d){c!==d?Q(a,b,c):a.f[b+a.h]=null},ti=function(a,b){for(var c,d,e=0;e<b.length;e++){var f=b[e],h=L(a,f);null!=h&&(c=f,d=h,Q(a,f,void 0))}return c?(Q(a,c,d),c):0},S=function(a,b,c,d){a.b||(a.b={});if(!a.b[c]){var e=
L(a,c);if(d||e)a.b[c]=new b(e)}return a.b[c]},T=function(a,b,c){Bi(a,b,c);b=a.b[c];b==ri&&(b=a.b[c]=[]);return b},Bi=function(a,b,c){a.b||(a.b={});if(!a.b[c]){for(var d=M(a,c),e=[],f=0;f<d.length;f++)e[f]=new b(d[f]);a.b[c]=e}},U=function(a,b,c){a.b||(a.b={});var d=c?Ci(c):c;a.b[b]=c;Q(a,b,d)},Di=function(a,b,c){a.b||(a.b={});c=c||[];for(var d=[],e=0;e<c.length;e++)d[e]=Ci(c[e]);a.b[b]=c;Q(a,b,d)},Ei=function(a,b,c,d,e){Bi(a,d,b);var f=a.b[b];f||(f=a.b[b]=[]);c=c?c:new d;a=M(a,b);void 0!=e?(f.splice(e,
0,c),a.splice(e,0,Ci(c))):(f.push(c),a.push(Ci(c)));return c},Fi=function(a){if(a.b)for(var b in a.b){var c=a.b[b];if(Ua(c))for(var d=0;d<c.length;d++)c[d]&&Ci(c[d]);else c&&Ci(c)}},Ci=function(a){Fi(a);return a.f};J.prototype.wa=qi?function(){var a=Uint8Array.prototype.toJSON;Uint8Array.prototype.toJSON=function(){return rh(this)};try{return JSON.stringify(this.f&&Ci(this),Gi)}finally{Uint8Array.prototype.toJSON=a}}:function(){return JSON.stringify(this.f&&Ci(this),Gi)};
var Gi=function(a,b){return p(b)&&(isNaN(b)||Infinity===b||-Infinity===b)?String(b):b},Ii=function(a){var b=Hi[a[0]];if(!b)throw Error("Unknown JsPb message type: "+a[0]);return new b(a)};J.prototype.toString=function(){Fi(this);return this.f.toString()};J.prototype.u=function(a){if(this.g)return this.b||(this.b={}),a.Xf?(!this.b[175237375]&&this.g[175237375]&&(this.b[175237375]=new a.Xf(this.g[175237375])),this.b[175237375]):this.g[175237375]};
var Ki=function(a,b){a=a||{};b=b||{};var c={},d;for(d in a)c[d]=0;for(d in b)c[d]=0;for(d in c)if(!Ji(a[d],b[d]))return!1;return!0},Ji=function(a,b){if(a==b)return!0;if(!Xa(a)||!Xa(b))return p(a)&&isNaN(a)||p(b)&&isNaN(b)?String(a)==String(b):!1;if(a.constructor!=b.constructor)return!1;if(qi&&a.constructor===Uint8Array){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0}if(a.constructor===Array){var d=void 0,e=void 0,f=Math.max(a.length,b.length);for(c=0;c<f;c++){var h=
a[c],l=b[c];h&&h.constructor==Object&&(d=h,h=void 0);l&&l.constructor==Object&&(e=l,l=void 0);if(!Ji(h,l))return!1}return d||e?(d=d||{},e=e||{},Ki(d,e)):!0}if(a.constructor===Object)return Ki(a,b);throw Error("Invalid type in JSPB array");};J.prototype.clone=function(){return Li(this)};
var Li=function(a){return new a.constructor(Mi(Ci(a)))},Mi=function(a){if(Ua(a)){for(var b=Array(a.length),c=0;c<a.length;c++){var d=a[c];null!=d&&(b[c]="object"==typeof d?Mi(d):d)}return b}if(qi&&a instanceof Uint8Array)return new Uint8Array(a);b={};for(c in a)d=a[c],null!=d&&(b[c]="object"==typeof d?Mi(d):d);return b},Ni=function(a,b){Hi[a]=b;b.messageId=a},Hi={};var Oi=function(a){K(this,a,0,-1,null,null)};v(Oi,J);var Pi=function(a){K(this,a,0,-1,null,null)};v(Pi,J);Oi.prototype.s=function(){var a=new z;Qi(this,a);return A(a)};var Qi=function(a,b){var c=L(a,1);null!=c&&D(b,1,c);c=L(a,2);null!=c&&H(b,2,c);c=S(a,Pi,3);null!=c&&b.b(3,c,Ri)};Pi.prototype.s=function(){var a=new z;Ri(this,a);return A(a)};var Ri=function(a,b){var c=L(a,1);null!=c&&H(b,1,c);c=L(a,2);null!=c&&D(b,2,c)};Oi.prototype.Bb=function(){return L(this,1)};var Si=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b;this.logRecord=this.deviceJustSetUp=void 0};u("castApp.eventPage.Message",Si);var Ti=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};Si.DeviceData=Ti;Si.DeviceJustSetUp=function(a,b,c,d){this.ipAddress=a;this.name=b;this.udn=c;this.modelName=d};Si.DeviceCapabilities=function(){};
Si.LogRecord=function(a,b,c,d){this.levelValue=a;this.msg=b;this.loggerName=c;this.time=d};var Ui=function(a,b){this.type=a;this.entryPoint=b};u("castApp.frontEnd.ExtensionMessage",Ui);var Vi=function(a){return"urn:x-cast:com.google.cast."+a},Wi=Vi("tp.connection"),Xi=Vi("receiver"),Yi=Vi("remoting"),Zi=Vi("media"),$i=Vi("webrtc"),aj=Vi("broadcast"),bj=Yc({Px:Wi,Qx:Vi("tp.heartbeat"),Bw:Xi,Gw:Yi,Lu:Zi,Ou:Vi("media.universalRemote.optIn"),ky:$i,Zr:aj});var cj=function(a){return"available"==a||"available_rescan"==a};var dj=function(a,b,c,d,e){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=void 0===d?null:d;this.domain=void 0===e?null:e};var ej=window.localStorage,fj=0,hj=function(a){return(a=window.localStorage.getItem(gj(a,!1)))?JSON.parse(a):null},ij=function(a){return(a=window.localStorage.getItem(gj(a,!0)))?JSON.parse(a):null},kj=function(a){if(jj.has(a.Aa()))throw Error("Duplicate instance name "+a.Aa());jj.set(a.Aa(),a);a.eb()},qj=function(a){for(var b=0,c=k(Object.keys(ej)),d=c.next();!d.done;d=c.next()){d=d.value;var e=d.length+window.localStorage.getItem(d).length;d.startsWith("mr.")?fj+=e:b+=e}lj=a;(window.localStorage.getItem("version")&&
window.localStorage.getItem("version")!==chrome.runtime.getManifest().version||mj(a))&&nj();oj.info("initialize: "+fj+" chars used, "+b+" other chars");chrome.runtime.onSuspend.addListener(pj)},lj=null,oj=gb("mr.PersistentDataManager"),jj=new Map,gj=function(a,b){return"mr."+(b?"persistent.":"temp.")+a.Aa()},mj=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},pj=function(){oj.info("onSuspend");rj("version",chrome.runtime.getManifest().version);
lj&&rj("mrInstanceId",lj);for(var a=jj.get("LogManager"),b=k(jj),c=b.next();!c.done;c=b.next())c=k(c.value),c.next(),c=c.next().value,c!=a&&sj(c);a&&sj(a)},sj=function(a){try{var b=a.fb();b&&void 0!=b[0]&&rj(gj(a,!1),JSON.stringify(b[0]));b&&void 0!=b[1]&&rj(gj(a,!0),JSON.stringify(b[1]))}catch(c){oj.error("Error while saving data for "+a.Aa()+": "+c.message)}},rj=function(a,b){var c=window.localStorage.getItem(a);c=null!=c?b.length-c.length:a.length+b.length;52E5<fj+c&&(oj.F("Unable to write "+c+
" chars"),nj());if(52E5<fj+c)throw oj.error("Unable to write "+c+" chars after clearing temporary"),Error("Setting the value of '"+a+"' would exceed the quota, according to accounting.");try{window.localStorage.setItem(a,b)}catch(d){throw Error("Setting the value of '"+a+"' would exceed the quota, according to the browser.");}fj+=c},tj=function(a){a=0==a.size%2?new Blob([a,new Uint8Array([0,0])]):new Blob([a,new Uint8Array([1])]);return new Promise(function(b,c){var d=new FileReader;d.onloadend=function(){if(d.error)c(d.error);
else try{for(var a=d.result,f=[],h=0,l=a.byteLength;h<l;h+=8192)f.push(String.fromCharCode.apply(null,new Uint16Array(a,h,Math.min(l-h,8192)/2)));rj("mr.temp.mirror.cast.Service.eventsBlob",f.join(""));b()}catch(r){c(r)}};d.readAsArrayBuffer(a)})},nj=function(){for(var a=k(Object.keys(ej)),b=a.next();!b.done;b=a.next())b=b.value,b.startsWith("mr.temp.")&&(fj-=b.length+window.localStorage.getItem(b).length,delete window.localStorage[b]);oj.info("removeTemporary_: "+fj+" chars used")};var uj=(new Map).set("+","-").set("/","_").set("=","."),vj=(new Map).set("-","+").set("_","/").set(".","="),wj=function(a){return atob(a.replace(/[-_.]/g,function(a){return vj.get(a)}))},xj=function(a){return btoa(String.fromCharCode.apply(String,m(a))).replace(/[+/=]/g,function(a){return uj.get(a)})};var yj=function(){this.b=[];this.j=[];this.l=[];this.g=[];this.g[0]=128;for(var a=1;64>a;++a)this.g[a]=0;this.h=this.f=0;this.reset()};yj.prototype.reset=function(){this.b[0]=1732584193;this.b[1]=4023233417;this.b[2]=2562383102;this.b[3]=271733878;this.b[4]=3285377520;this.h=this.f=0};
var zj=function(a,b,c){c=void 0===c?0:c;var d=a.l;if("string"===typeof b)for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(b=16;80>b;b++)c=d[b-3]^d[b-8]^d[b-14]^d[b-16],d[b]=(c<<1|c>>>31)&4294967295;b=a.b[0];c=a.b[1];e=a.b[2];for(var f=a.b[3],h=a.b[4],l,r,y=0;80>y;y++)40>y?20>y?(l=f^c&(e^f),r=1518500249):(l=c^e^f,r=1859775393):60>y?(l=c&e|f&(c|e),r=2400959708):(l=
c^e^f,r=3395469782),l=(b<<5|b>>>27)+l+h+r+d[y]&4294967295,h=f,f=e,e=(c<<30|c>>>2)&4294967295,c=b,b=l;a.b[0]=a.b[0]+b&4294967295;a.b[1]=a.b[1]+c&4294967295;a.b[2]=a.b[2]+e&4294967295;a.b[3]=a.b[3]+f&4294967295;a.b[4]=a.b[4]+h&4294967295};
yj.prototype.update=function(a,b){b=void 0===b?a.length:b;for(var c=b-64,d=0,e=this.j,f=this.f;d<b;){if(0==f)for(;d<=c;)zj(this,a,d),d+=64;if("string"===typeof a)for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){zj(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,64==f){zj(this,e);f=0;break}}this.f=f;this.h+=b};
yj.prototype.digest=function(){var a=[],b=8*this.h;56>this.f?this.update(this.g,56-this.f):this.update(this.g,64-(this.f-56));for(var c=63;56<=c;c--)this.j[c]=b&255,b/=256;zj(this,this.j);for(c=b=0;5>c;c++)for(var d=24;0<=d;d-=8)a[b]=this.b[c]>>d&255,++b;return a};var Aj=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};var Cj=function(){this.j=Aj();this.f=new Bj(null,null);this.b=new Bj(null,null);this.l=[];this.g=this.h=0;kj(this)},Ej=function(){Dj||(Dj=new Cj);return Dj},Fj=function(a,b){b=b.toLowerCase();var c=new yj;c.update(b);c.update(a.j);return"r"+xj(c.digest())},Gj=function(){var a=Ej();return a.f.model?a.f:a.b.model?a.b:new Bj(null,null)};Cj.prototype.Aa=function(){return"SinkUtils"};
Cj.prototype.fb=function(){return[{recentLaunchedDevice:this.f,recentDiscoveredDevice:this.b},{receiverIdToken:this.j,fixedIpList:this.l.join(","),castControlPort:this.h,lastCloudSinkCheckTimeMillis:this.g}]};
Cj.prototype.eb=function(){var a=hj(this);a&&(this.f=a.recentLaunchedDevice||new Bj(null,null),this.b=a.recentDiscoveredDevice||new Bj(null,null));if(a=ij(this))this.j=a.receiverIdToken||Aj(),this.l=a.fixedIpList&&a.fixedIpList.split(",")||[],this.h=a.castControlPort||0,this.g=a.lastCloudSinkCheckTimeMillis||0};var Dj=null,Bj=function(a,b){this.model=a;this.ip=b};var Hj=function(a,b){this.kc=this.Ze=this.wd=this.Ga=this.Yb=null;this.lc=new dj(b,a);this.Ub={};this.Zg={};this.fe=!1};Hj.prototype.getId=function(){return this.lc.id};Hj.prototype.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.lc.friendlyName!=a.lc.friendlyName&&(this.lc.friendlyName=a.lc.friendlyName,b=!0);this.wd!=a.wd&&(this.wd=a.wd,b=!0);this.Ze!=a.Ze&&(this.Ze=a.Ze,b=!0);this.Yb!=a.Yb&&(this.Yb=a.Yb,b=!0);this.Ga!=a.Ga&&(this.Ga=a.Ga,b=!0);return b};Hj.prototype.Tb=function(){return this.Yb};
Hj.prototype.wb=function(){return this.Ga};var Ij=function(a,b){return a.Ub[b]||"unknown"},Jj=function(a){var b=new Hj(a.lc.friendlyName,"");b.lc.id=a.lc.id;b.Yb=a.Yb;b.Ga=a.Ga;b.wd=a.wd;b.Ze=a.Ze;b.kc=a.kc;b.Ub=a.Ub;b.Zg=a.Zg;b.fe=a.fe;return b};var Kj=function(a,b,c,d,e,f){this.f=new dj(a,b,d&1?"cast":d&32?"cast_audio_group":"cast_audio");this.kc=c||null;this.b=d||null;this.Yb=e||null;this.Ga=f||null;this.Ub={};this.ni=!1};Kj.prototype.update=function(a,b,c,d){var e=!1;this.f.friendlyName!=a&&(this.f.friendlyName=a,e=!0);null!=b&&this.Yb!=b&&(this.Yb=b,e=!0);null!=c&&this.Ga!=c&&(this.Ga=c,e=!0);null!=d&&this.b!=d&&(this.b=d,e=!0);return e};Kj.prototype.getId=function(){return this.f.id};Kj.prototype.Tb=function(){return this.Yb};
Kj.prototype.wb=function(){return this.Ga};var Lj=function(a,b){return a.Ub[b]||"unknown"};var Mj="StopIteration"in Ha?Ha.StopIteration:{message:"StopIteration",stack:""},Nj=function(){};Nj.prototype.next=function(){throw Mj;};Nj.prototype.Ab=function(){return this};
var Oj=function(a){if(a instanceof Nj)return a;if("function"==typeof a.Ab)return a.Ab(!1);if(Va(a)){var b=0,c=new Nj;c.next=function(){for(;;){if(b>=a.length)throw Mj;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");},Pj=function(a,b,c){if(Va(a))try{w(a,b,c)}catch(d){if(d!==Mj)throw d;}else{a=Oj(a);try{for(;;)b.call(c,a.next(),void 0,a)}catch(d){if(d!==Mj)throw d;}}},Qj=function(a,b){a=Oj(a);try{for(;!b.call(void 0,a.next(),void 0,a););}catch(c){if(c!==Mj)throw c;}},Rj=function(a){if(Va(a))return x(a);
a=Oj(a);var b=[];Pj(a,function(a){b.push(a)});return b};var Tj=function(a,b){this.f={};this.b=[];this.h=this.g=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&Sj(this,a)};Tj.prototype.sa=function(){return this.g};Tj.prototype.ia=function(){Uj(this);for(var a=[],b=0;b<this.b.length;b++)a.push(this.f[this.b[b]]);return a};Tj.prototype.sb=function(){Uj(this);return this.b.concat()};var Wj=function(a,b){return Vj(a.f,b)};
Tj.prototype.hf=function(a){for(var b=0;b<this.b.length;b++){var c=this.b[b];if(Vj(this.f,c)&&this.f[c]==a)return!0}return!1};Tj.prototype.equals=function(a,b){if(this===a)return!0;if(this.g!=a.sa())return!1;b=b||Xj;Uj(this);for(var c,d=0;c=this.b[d];d++)if(!b(this.get(c),a.get(c)))return!1;return!0};var Xj=function(a,b){return a===b};Tj.prototype.Eb=function(){return 0==this.g};Tj.prototype.clear=function(){this.f={};this.h=this.g=this.b.length=0};
Tj.prototype.remove=function(a){return Vj(this.f,a)?(delete this.f[a],this.g--,this.h++,this.b.length>2*this.g&&Uj(this),!0):!1};var Uj=function(a){if(a.g!=a.b.length){for(var b=0,c=0;b<a.b.length;){var d=a.b[b];Vj(a.f,d)&&(a.b[c++]=d);b++}a.b.length=c}if(a.g!=a.b.length){var e={};for(c=b=0;b<a.b.length;)d=a.b[b],Vj(e,d)||(a.b[c++]=d,e[d]=1),b++;a.b.length=c}};Tj.prototype.get=function(a,b){return Vj(this.f,a)?this.f[a]:b};
Tj.prototype.set=function(a,b){Vj(this.f,a)||(this.g++,this.b.push(a),this.h++);this.f[a]=b};var Sj=function(a,b){if(b instanceof Tj)for(var c=b.sb(),d=0;d<c.length;d++)a.set(c[d],b.get(c[d]));else for(c in b)a.set(c,b[c])};Tj.prototype.forEach=function(a,b){for(var c=this.sb(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};Tj.prototype.clone=function(){return new Tj(this)};var Yj=function(a){Uj(a);for(var b={},c=0;c<a.b.length;c++){var d=a.b[c];b[d]=a.f[d]}return b};
Tj.prototype.Ab=function(a){Uj(this);var b=0,c=this.h,d=this,e=new Nj;e.next=function(){if(c!=d.h)throw Error("The map has changed since the iterator was created");if(b>=d.b.length)throw Mj;var e=d.b[b++];return a?e:d.f[e]};return e};var Vj=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var Zj=function(a,b){this.h=b;this.f=a;this.f.ka=this.ka.bind(this);this.b=new Tj;this.j=new Tj;this.m=gb("mr.cast.SinkDiscoveryService");this.g={Tf:0,lg:0}};n(Zj,dg);Zj.prototype.init=function(){kj(this);og("mr.cast.SinkDiscoveryService",this)};
var hk=function(a,b){a.m.info("addSinks returned "+b.length+" sinks");nb(a.m,function(){return"....the list is: "+JSON.stringify(b)});var c=new Set(a.b.sb());b.forEach(function(b){var d=b.sink_id;var e=b.extra_data.cast_media_sink,l=e.ip_endpoint?e.ip_endpoint.address:e.ip_address,r=e.ip_endpoint?e.ip_endpoint.port:Ej().h||8009;d=new Kj(d,b.name,e.model_name,e.capabilities,l.address_bytes.join("."),r);e=a.b.get(d.getId());l=a.f;b=b.extra_data.cast_media_sink.cast_channel_id;r=d.getId();var y=l.f.get(r);
if(!y||y.channelId!=b){ak.info("Added cast channel "+b+" to receiver: "+r);y&&l.b.remove(y.channelId);y={auth:"ssl_verified",ipAddress:d.Tb(),port:d.wb()};y={channelId:b,readyState:"open",keepAlive:!0,audioOnly:!(d.b&1),connectInfo:y};l.f.set(r,y);l.b.set(b,r);var B=l.h.get(r);B&&B.channelId!=b&&(ak.info("Re-connected to receiver: "+d.getId()),bk(l.g,B,y),ck(l.j.j,d,!0));l.h.set(r,y)}if(e){if(l=e.update(d.f.friendlyName,d.Tb(),d.wb(),d.b))e.ni=!1;l&&dk(a.h,e)}else a.m.info("Adding sink "+d.getId()),
ek(a,d),e=a.h,e.g.onSinkAvailabilityUpdated(e,1),dk(e,d),ck(e.j,d),Ej().b=new Bj(d.kc,d.Tb());c.delete(d.getId())});c.forEach(function(c){var b=a.f,d=b.h.get(c);d&&(fk(b.g,d),b.h.remove(c));gk(a,c)});var d=a.b.sa();a.g={Tf:d,lg:d}};Zj.prototype.se=function(){return this.g};
var ek=function(a,b){var c=a.b.get(b.getId()),d=null,e=b.Tb(),f=b.wb();null!=e&&null!=f&&(d=a.j.get(e+":"+f));if(c&&!d){var h=b.Tb(),l=b.wb();h&&l&&a.j.remove(h+":"+l)}d&&!c&&a.b.remove(d.getId());a.b.set(b.getId(),b);null!=e&&null!=f&&a.j.set(e+":"+f,b)},gk=function(a,b){var c=a.b.get(b);if(c){a.m.info("Removing sink "+b);a.b.remove(b);b=c.Tb();var d=c.wb();null!=b&&null!=d&&a.j.remove(b+":"+d);a=a.h;if(0==a.b.b.sa())a.g.onSinkAvailabilityUpdated(a,0);b=a.j;c=c.getId();(c=ik(b.b,c))&&c.session&&
jk(b,c.session.sessionId);kk(a.C);a.g.Nc()}},mk=function(a){a.m.info("Pruning inactive sinks.");Pj(a.b.Ab(!1),function(b){lk(a.f,b)||gk(a,b.getId())})};Zj.prototype.ka=function(a){return this.b.get(a,null)};var nk=function(a,b){var c=[];Pj(a.b.Ab(!1),function(a){cj(Lj(a,b))&&c.push(a)});return c};Zj.prototype.Aa=function(){return"cast.SinkDiscoveryService"};
Zj.prototype.fb=function(){var a=this,b={};Pj(this.b.Ab(!0),function(c){var d=a.b.get(c);d={id:d.getId(),ip:d.Tb(),port:d.wb(),friendlyName:d.f.friendlyName,modelName:d.kc,capabilities:d.b,discoveredByDial:d.ni,appStatusMap:d.Ub};b[c]=d});return[new ok(b,this.g)]};
Zj.prototype.eb=function(){var a=hj(this);if(a&&4==a.version){this.g=a.deviceCounts;a=a.sinkMap;for(var b in a){var c=void 0,d=a[b],e=new Kj("",d.friendlyName,d.modelName,d.capabilities,d.ip,d.port);e.f.id=d.id;e.ni=d.discoveredByDial;e.Ub=d.appStatusMap;for(c in e.Ub)"unavailable"==e.Ub[c]&&(e.Ub[c]="unavailable_rescan");c=e;this.ka(c.getId())||ek(this,c)}mk(this)}};var ok=function(a,b){this.sinkMap=a;this.deviceCounts=b;this.version=4};var pk={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var qk=function(){this.type="GET_STATUS";this.requestId=0};var rk=function(a,b){this.requestId=a;this.Kg=b;this.sm=null};rk.prototype.b=function(){};var sk=function(){this.b=new Tj},tk=function(a,b){a.b.set(b.requestId,b);b.sm=setTimeout(function(){a.b.remove(b.requestId);b.b()},b.Kg)},uk=function(a,b){var c=a.b.get(b);if(!c)return null;clearTimeout(c.sm);a.b.remove(b);return c};var vk=function(a,b,c){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=b;this.message=c};var wk=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var xk=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var yk=function(a){this.f=a;this.b=1E3*Math.floor(1E6*Math.random())},zk=function(a){var b=a.b++;0==b&&(b=a.b++);return b};yk.prototype.Aa=function(){return"IdGenerator."+this.f};yk.prototype.fb=function(){return[this.b]};yk.prototype.eb=function(){var a=hj(this);a&&(this.b=a)};var Ak=function(a,b){this.f=a;this.g=b;this.b=new sk;this.h=new yk("cast.RequestIdGenerator")};Ak.prototype.init=function(){kj(this.h)};var Ck=function(a,b,c,d){var e=zk(a.h);b.requestId=e;b=new Cb;c=new Bk(e,b,p(c)&&0<c?c:6E5,d);tk(a.b,c);return c};
Ak.prototype.sendRequest=function(a,b,c,d,e,f){var h=this;if(!bj.hasOwnProperty(c))return Promise.reject(Error("Custom namespace is not supported"));var l=Ck(this,a,Ia(d)?d:3E3,e),r=l.qb;Dk(this.f,b,c,a,e||this.g,f).then(null,function(){uk(h.b,l.requestId);r.reject(Ek)});return r.b};
Ak.prototype.sendMessage=function(a,b,c,d,e,f){var h=this,l=Ck(this,a,Ia(d)?d:3E3,e),r=l.qb;Dk(this.f,b,c,a,e||this.g,f).then(function(){uk(h.b,l.requestId);r.resolve(!0)},function(){uk(h.b,l.requestId);r.reject(Ek)});return r.b};
var Fk=function(a,b,c){var d=new wk(b.appId);d.language=b.language?b.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return a.sendRequest(d,c,Xi,b.requestSessionTimeout)},Gk=Error("Timeout"),Ek=Error("Failed to send message"),Bk=function(a,b,c,d){rk.call(this,a,c);this.qb=b;this.sourceId=d};n(Bk,rk);Bk.prototype.b=function(){this.qb.reject(Gk)};var Hk=function(a){return a.sa&&"function"==typeof a.sa?a.sa():Va(a)||Ja(a)?a.length:Oc(a)},Ik=function(a){if(a.ia&&"function"==typeof a.ia)return a.ia();if(Ja(a))return a.split("");if(Va(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Qc(a)},Jk=function(a){if(a.sb&&"function"==typeof a.sb)return a.sb();if(!a.ia||"function"!=typeof a.ia){if(Va(a)||Ja(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return Rc(a)}},Kk=function(a){return a.Eb&&"function"==typeof a.Eb?
a.Eb():Va(a)||Ja(a)?Ub(a):Uc(a)},Lk=function(a,b,c){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,c);else if(Va(a)||Ja(a))w(a,b,c);else for(var d=Jk(a),e=Ik(a),f=e.length,h=0;h<f;h++)b.call(c,e[h],d&&d[h],a)},Mk=function(a,b,c){if("function"==typeof a.map)return a.map(b,c);if(Va(a)||Ja(a))return Mb(a,b,c);var d=Jk(a),e=Ik(a),f=e.length;if(d){var h={};for(var l=0;l<f;l++)h[d[l]]=b.call(c,e[l],d[l],a)}else for(h=[],l=0;l<f;l++)h[l]=b.call(c,e[l],void 0,a);return h},Nk=function(a,b){if("function"==
typeof a.every)return a.every(b,void 0);if(Va(a)||Ja(a))return Pb(a,b,void 0);for(var c=Jk(a),d=Ik(a),e=d.length,f=0;f<e;f++)if(!b.call(void 0,d[f],c&&c[f],a))return!1;return!0};var Pk=function(a){this.b=new Tj;a&&Ok(this,a)},Qk=function(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+(a[Ya]||(a[Ya]=++$a)):b.substr(0,1)+a};Pk.prototype.sa=function(){return this.b.sa()};Pk.prototype.add=function(a){this.b.set(Qk(a),a)};var Ok=function(a,b){b=Ik(b);for(var c=b.length,d=0;d<c;d++)a.add(b[d])};g=Pk.prototype;g.removeAll=function(a){a=Ik(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};g.remove=function(a){return this.b.remove(Qk(a))};g.clear=function(){this.b.clear()};
g.Eb=function(){return this.b.Eb()};g.contains=function(a){return Wj(this.b,Qk(a))};g.ia=function(){return this.b.ia()};g.clone=function(){return new Pk(this)};g.equals=function(a){return this.sa()==Hk(a)&&Rk(this,a)};var Rk=function(a,b){var c=Hk(b);if(a.sa()>c)return!1;!(b instanceof Pk)&&5<c&&(b=new Pk(b));return Nk(a,function(a){var c=b;return c.contains&&"function"==typeof c.contains?c.contains(a):c.hf&&"function"==typeof c.hf?c.hf(a):Va(c)||Ja(c)?Tb(c,a):Tc(c,a)})};Pk.prototype.Ab=function(){return this.b.Ab(!1)};var Tk=function(a,b){this.h=a;this.g=b;this.f=new Tj;this.b=new Pk;this.j=0;this.A=new Tj("serviceCheck",this.ep.bind(this),"startDeviceMonitor",this.fp.bind(this),"releaseDeviceMonitor",this.cp.bind(this),"deviceJustSetUp",this.Zo.bind(this),"logRecord",this.ap.bind(this));chrome.runtime.onMessage.addListener(this.o.bind(this));chrome.runtime.onMessageExternal.addListener(this.l.bind(this));Sk(this,"serviceReady")};Tk.prototype.m=gb("castApp.eventPage.Service");
var kk=function(a){if(Uk(a)){var b=new Pk;Pj(a.h.b.Ab(!1),function(a){var c=a.Tb();b.add(c);Wj(this.f,c)||this.g.sendRequest(new qk,a,Xi)}.bind(a));var c=!1;a.f.sb().forEach(function(a){b.contains(a)||(this.f.remove(a),c=!0)}.bind(a));c&&Vk(a)}},Uk=function(a){if(0===a.b.sa())return!1;var b=t();3E4<b-a.j&&(a.j=b,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(a){0===a.length?(this.m.info("No tabs found. Clearing device monitor clients."),
this.b.clear()):this.m.info(function(){return"Tab check found active tabs: "+a.map(function(a){return a.id})})}.bind(a)));b=a.b.sa();a.m.info("Monitor client count: "+b);return 0<b};Tk.prototype.o=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var d=this.A.get(a.subtype);if(!d)return!1;if(!a.originId)return Gb("Missing origin ID in the incoming message."),!1;try{var e=d(a,b,c);e&&c(e)}catch(f){this.m.error("Error while handling request",f)}return!1};
var Sk=function(a,b,c){var d=new Si(b,c);nb(a.m,function(){return"Sending message: "+JSON.stringify(d)});chrome.runtime.sendMessage(d)};g=Tk.prototype;g.ep=function(){Sk(this,"serviceReady")};g.fp=function(a){this.b.contains(a.originId)?this.m.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.m.info("Registering monitor client: "+a.originId),this.b.add(a.originId));Vk(this);Wk(this)};g.cp=function(a){this.m.info("Unregistering monitor client: "+a.originId);this.b.remove(a.originId)};
g.Zo=function(a){a=a.deviceJustSetUp.udn.replace(/-/g,"").toLowerCase();this.m.info("Device just set up: "+a.slice(-4))};g.ap=function(a){a=a.logRecord;jb({level:qb(a.levelValue),L:a.loggerName,time:a.time,message:a.msg})};var Vk=function(a){var b=a.f.ia();Sk(a,"devices",b)},Wk=function(a){a.h.b.ia().forEach(function(a){this.g.sendRequest(new qk,a,Xi)}.bind(a))};
Tk.prototype.l=function(a,b,c){switch(a.type){case "handshake":c(new Ui("handshake"));break;case "launch":b=b.tab&&p(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.VERSION=[1,2];u("chrome.cast.VERSION",chrome.cast.VERSION);chrome.cast.zr=!0;u("chrome.cast.usingPresentationApi",chrome.cast.zr);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};u("chrome.cast.Error",chrome.cast.Error);chrome.cast.Hn=function(a){this.platform=a;this.packageId=this.url=null};u("chrome.cast.SenderApplication",chrome.cast.Hn);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};u("chrome.cast.Image",chrome.cast.Image);
chrome.cast.Volume=function(a,b){this.level=Ia(a)?a:null;this.muted=Ia(b)?b:null};u("chrome.cast.Volume",chrome.cast.Volume);chrome.cast.Tc={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};u("chrome.cast.AutoJoinPolicy",chrome.cast.Tc);chrome.cast.Sg={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};u("chrome.cast.DefaultActionPolicy",chrome.cast.Sg);chrome.cast.vd={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
u("chrome.cast.Capability",chrome.cast.vd);chrome.cast.Vc={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};u("chrome.cast.ErrorCode",chrome.cast.Vc);chrome.cast.un={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
u("chrome.cast.ReceiverAvailability",chrome.cast.un);chrome.cast.In={CHROME:"chrome",IOS:"ios",ANDROID:"android"};u("chrome.cast.SenderPlatform",chrome.cast.In);chrome.cast.Ug={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};u("chrome.cast.ReceiverType",chrome.cast.Ug);chrome.cast.Jm={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};u("chrome.cast.DialAppState",chrome.cast.Jm);chrome.cast.Rf={CAST:"cast",STOP:"stop"};u("chrome.cast.ReceiverAction",chrome.cast.Rf);
chrome.cast.ck={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};u("chrome.cast.SessionStatus",chrome.cast.ck);chrome.cast.fk={ATTENUATION:"attenuation",FIXED:"fixed",MASTER:"master"};u("chrome.cast.VolumeControlType",chrome.cast.fk);chrome.cast.Bm=function(a,b,c,d,e){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=d||chrome.cast.Tc.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=e||chrome.cast.Sg.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};u("chrome.cast.ApiConfig",chrome.cast.Bm);chrome.cast.Lm=function(a,b){this.appName=a;this.launchParameter=b||null};u("chrome.cast.DialRequest",chrome.cast.Lm);
chrome.cast.Nj=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};u("chrome.cast.DialLaunchData",chrome.cast.Nj);chrome.cast.Km=function(a,b){this.doLaunch=a;this.launchParameter=b||null};u("chrome.cast.DialLaunchResponse",chrome.cast.Km);chrome.cast.bk=function(a,b,c){this.appId=a;this.capabilities=Ua(b)?b:[chrome.cast.vd.VIDEO_OUT,chrome.cast.vd.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
u("chrome.cast.SessionRequest",chrome.cast.bk);
chrome.cast.Qh=function(a,b,c,d){this.label=a;a=b;yc.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(sc,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(tc,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(uc,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(vc,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(wc,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(xc,"&#0;")));this.friendlyName=a;this.capabilities=c||[];this.volume=d||null;this.receiverType=chrome.cast.Ug.CAST;this.displayStatus=this.isActiveInput=null};
u("chrome.cast.Receiver",chrome.cast.Qh);chrome.cast.vn=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};u("chrome.cast.ReceiverDisplayStatus",chrome.cast.vn);chrome.cast.ek=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};u("chrome.cast.Timeout",chrome.cast.ek);chrome.cast.timeout=new chrome.cast.ek;u("chrome.cast.timeout",chrome.cast.timeout);chrome.cast.Jj="auto-join";chrome.cast.Yj="cast-session_";chrome.cast.media.ee={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};u("chrome.cast.media.MediaCommand",chrome.cast.media.ee);chrome.cast.media.zc={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};u("chrome.cast.media.MetadataType",chrome.cast.media.zc);chrome.cast.media.Ye={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};u("chrome.cast.media.PlayerState",chrome.cast.media.Ye);
chrome.cast.media.Rh={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};u("chrome.cast.media.RepeatMode",chrome.cast.media.Rh);chrome.cast.media.wn={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};u("chrome.cast.media.ResumeState",chrome.cast.media.wn);chrome.cast.media.dk={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};u("chrome.cast.media.StreamType",chrome.cast.media.dk);
chrome.cast.media.Tm={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};u("chrome.cast.media.IdleReason",chrome.cast.media.Tm);chrome.cast.media.Rn={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};u("chrome.cast.media.TrackType",chrome.cast.media.Rn);chrome.cast.media.On={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};u("chrome.cast.media.TextTrackType",chrome.cast.media.On);
chrome.cast.media.Kn={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};u("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.Kn);chrome.cast.media.Pn={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};u("chrome.cast.media.TextTrackWindowType",chrome.cast.media.Pn);
chrome.cast.media.Ln={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};u("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.Ln);chrome.cast.media.Mn={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};u("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.Mn);chrome.cast.media.Qm=function(){this.customData=null};u("chrome.cast.media.GetStatusRequest",chrome.cast.media.Qm);chrome.cast.media.fn=function(){this.customData=null};u("chrome.cast.media.PauseRequest",chrome.cast.media.fn);chrome.cast.media.hn=function(){this.customData=null};u("chrome.cast.media.PlayRequest",chrome.cast.media.hn);chrome.cast.media.Gn=function(){this.customData=this.resumeState=this.currentTime=null};u("chrome.cast.media.SeekRequest",chrome.cast.media.Gn);
chrome.cast.media.Jn=function(){this.customData=null};u("chrome.cast.media.StopRequest",chrome.cast.media.Jn);chrome.cast.media.Vn=function(a){this.volume=a;this.customData=null};u("chrome.cast.media.VolumeRequest",chrome.cast.media.Vn);chrome.cast.media.Um=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};u("chrome.cast.media.LoadRequest",chrome.cast.media.Um);
chrome.cast.media.yw=function(a){this.type="PRECACHE";this.requestId=0;this.precacheData=a};chrome.cast.media.Om=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};u("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.Om);chrome.cast.media.Pm=function(){this.metadataType=this.type=chrome.cast.media.zc.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};u("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.Pm);
chrome.cast.media.Xm=function(){this.metadataType=this.type=chrome.cast.media.zc.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};u("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.Xm);chrome.cast.media.Sn=function(){this.metadataType=this.type=chrome.cast.media.zc.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
u("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.Sn);chrome.cast.media.Ym=function(){this.metadataType=this.type=chrome.cast.media.zc.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};u("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.Ym);
chrome.cast.media.gn=function(){this.metadataType=this.type=chrome.cast.media.zc.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};u("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.gn);chrome.cast.media.Wm=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.dk.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
u("chrome.cast.media.MediaInfo",chrome.cast.media.Wm);chrome.cast.media.ln=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};u("chrome.cast.media.QueueItem",chrome.cast.media.ln);chrome.cast.media.Hm="CC1AD845";u("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.Hm);chrome.cast.media.timeout={};chrome.cast.media.timeout.load=0;u("chrome.cast.media.timeout.load",chrome.cast.media.timeout.load);
chrome.cast.media.timeout.Oa=0;u("chrome.cast.media.timeout.getStatus",chrome.cast.media.timeout.Oa);chrome.cast.media.timeout.play=0;u("chrome.cast.media.timeout.play",chrome.cast.media.timeout.play);chrome.cast.media.timeout.pause=0;u("chrome.cast.media.timeout.pause",chrome.cast.media.timeout.pause);chrome.cast.media.timeout.seek=0;u("chrome.cast.media.timeout.seek",chrome.cast.media.timeout.seek);chrome.cast.media.timeout.stop=0;u("chrome.cast.media.timeout.stop",chrome.cast.media.timeout.stop);
chrome.cast.media.timeout.jc=0;u("chrome.cast.media.timeout.setVolume",chrome.cast.media.timeout.jc);chrome.cast.media.timeout.oi=0;u("chrome.cast.media.timeout.editTracksInfo",chrome.cast.media.timeout.oi);chrome.cast.media.timeout.Eq=0;u("chrome.cast.media.timeout.queue",chrome.cast.media.timeout.Eq);chrome.cast.media.Qn=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};u("chrome.cast.media.Track",chrome.cast.media.Qn);
chrome.cast.media.Nn=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};u("chrome.cast.media.TextTrackStyle",chrome.cast.media.Nn);chrome.cast.media.nn=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.Rh.OFF;this.customData=null};
u("chrome.cast.media.QueueLoadRequest",chrome.cast.media.nn);chrome.cast.media.kn=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};u("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.kn);chrome.cast.media.sn=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};u("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.sn);
chrome.cast.media.mn=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};u("chrome.cast.media.QueueJumpRequest",chrome.cast.media.mn);chrome.cast.media.rn=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};u("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.rn);
chrome.cast.media.pn=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};u("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.pn);chrome.cast.media.qn=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};u("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.qn);chrome.cast.media.P=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.Ye.IDLE;this.currentTime=0;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.Rh.OFF};u("chrome.cast.media.Media",chrome.cast.media.P);chrome.cast.media.P.prototype.Oa=function(){};
chrome.cast.media.P.prototype.getStatus=chrome.cast.media.P.prototype.Oa;chrome.cast.media.P.prototype.play=function(){};chrome.cast.media.P.prototype.play=chrome.cast.media.P.prototype.play;chrome.cast.media.P.prototype.yq=function(){};chrome.cast.media.P.prototype.playWithContext=chrome.cast.media.P.prototype.yq;chrome.cast.media.P.prototype.pause=function(){};chrome.cast.media.P.prototype.pause=chrome.cast.media.P.prototype.pause;chrome.cast.media.P.prototype.xq=function(){};
chrome.cast.media.P.prototype.pauseWithContext=chrome.cast.media.P.prototype.xq;chrome.cast.media.P.prototype.seek=function(){};chrome.cast.media.P.prototype.seek=chrome.cast.media.P.prototype.seek;chrome.cast.media.P.prototype.stop=function(){};chrome.cast.media.P.prototype.stop=chrome.cast.media.P.prototype.stop;chrome.cast.media.P.prototype.jc=function(){};chrome.cast.media.P.prototype.setVolume=chrome.cast.media.P.prototype.jc;chrome.cast.media.P.prototype.oi=function(){};
chrome.cast.media.P.prototype.editTracksInfo=chrome.cast.media.P.prototype.oi;chrome.cast.media.P.prototype.Gq=function(){};chrome.cast.media.P.prototype.queueInsertItems=chrome.cast.media.P.prototype.Gq;chrome.cast.media.P.prototype.Fq=function(){};chrome.cast.media.P.prototype.queueAppendItem=chrome.cast.media.P.prototype.Fq;chrome.cast.media.P.prototype.Qq=function(){};chrome.cast.media.P.prototype.queueUpdateItems=chrome.cast.media.P.prototype.Qq;chrome.cast.media.P.prototype.Lq=function(){};
chrome.cast.media.P.prototype.queuePrev=chrome.cast.media.P.prototype.Lq;chrome.cast.media.P.prototype.Kq=function(){};chrome.cast.media.P.prototype.queueNext=chrome.cast.media.P.prototype.Kq;chrome.cast.media.P.prototype.Hq=function(a){Xk(this,a)};chrome.cast.media.P.prototype.queueJumpToItem=chrome.cast.media.P.prototype.Hq;chrome.cast.media.P.prototype.Pq=function(){};chrome.cast.media.P.prototype.queueSetRepeatMode=chrome.cast.media.P.prototype.Pq;chrome.cast.media.P.prototype.Nq=function(){};
chrome.cast.media.P.prototype.queueRemoveItems=chrome.cast.media.P.prototype.Nq;chrome.cast.media.P.prototype.Mq=function(a){Xk(this,a)};chrome.cast.media.P.prototype.queueRemoveItem=chrome.cast.media.P.prototype.Mq;chrome.cast.media.P.prototype.Oq=function(){};chrome.cast.media.P.prototype.queueReorderItems=chrome.cast.media.P.prototype.Oq;chrome.cast.media.P.prototype.Jq=function(a,b,c,d){a=Xk(this,a);0>a||(0>b?d&&d(new chrome.cast.Error(chrome.cast.Vc.INVALID_PARAMETER)):a==b&&c&&c())};
chrome.cast.media.P.prototype.queueMoveItemToNewIndex=chrome.cast.media.P.prototype.Jq;chrome.cast.media.P.prototype.xr=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.P.prototype.supportsCommand=chrome.cast.media.P.prototype.xr;chrome.cast.media.P.prototype.So=function(){return this.currentTime};chrome.cast.media.P.prototype.getEstimatedTime=chrome.cast.media.P.prototype.So;chrome.cast.media.P.prototype.ei=function(){};
chrome.cast.media.P.prototype.addUpdateListener=chrome.cast.media.P.prototype.ei;chrome.cast.media.P.prototype.fi=function(){};chrome.cast.media.P.prototype.addUpdateListenerWithContext=chrome.cast.media.P.prototype.fi;chrome.cast.media.P.prototype.rj=function(){};chrome.cast.media.P.prototype.removeUpdateListener=chrome.cast.media.P.prototype.rj;chrome.cast.media.P.prototype.sj=function(){};chrome.cast.media.P.prototype.removeUpdateListenerWithContext=chrome.cast.media.P.prototype.sj;
var Xk=function(a,b){return Qb(a.items,function(a){return a.itemId==b})};var Yk=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var Zk=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.T=function(a,b,c,d,e){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=d;this.receiver=e;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.ck.CONNECTED;this.transportId=""};u("chrome.cast.Session",chrome.cast.T);chrome.cast.T.prototype.nr=function(a,b,c){this.lm(null,a,b,c)};chrome.cast.T.prototype.setReceiverVolumeLevel=chrome.cast.T.prototype.nr;
chrome.cast.T.prototype.lm=function(a,b,c,d){b=new Zk(new chrome.cast.Volume(b,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,b,c,d)};chrome.cast.T.prototype.setReceiverVolumeLevelWithContext=chrome.cast.T.prototype.lm;chrome.cast.T.prototype.mr=function(a,b,c){this.km(null,a,b,c)};chrome.cast.T.prototype.setReceiverMuted=chrome.cast.T.prototype.mr;
chrome.cast.T.prototype.km=function(a,b,c,d){a=new Zk(new chrome.cast.Volume(null,b),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,c,d)};chrome.cast.T.prototype.setReceiverMutedWithContext=chrome.cast.T.prototype.km;chrome.cast.T.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.T.prototype.leave=chrome.cast.T.prototype.leave;chrome.cast.T.prototype.stop=function(){};chrome.cast.T.prototype.stop=chrome.cast.T.prototype.stop;
chrome.cast.T.prototype.ur=function(){};chrome.cast.T.prototype.stopWithContext=chrome.cast.T.prototype.ur;chrome.cast.T.prototype.sendMessage=function(){};chrome.cast.T.prototype.sendMessage=chrome.cast.T.prototype.sendMessage;chrome.cast.T.prototype.dr=function(){};chrome.cast.T.prototype.sendMessageWithContext=chrome.cast.T.prototype.dr;chrome.cast.T.prototype.ei=function(){};chrome.cast.T.prototype.addUpdateListener=chrome.cast.T.prototype.ei;chrome.cast.T.prototype.fi=function(){};
chrome.cast.T.prototype.addUpdateListenerWithContext=chrome.cast.T.prototype.fi;chrome.cast.T.prototype.rj=function(){};chrome.cast.T.prototype.removeUpdateListener=chrome.cast.T.prototype.rj;chrome.cast.T.prototype.sj=function(){};chrome.cast.T.prototype.removeUpdateListenerWithContext=chrome.cast.T.prototype.sj;chrome.cast.T.prototype.qo=function(){};chrome.cast.T.prototype.addMessageListener=chrome.cast.T.prototype.qo;chrome.cast.T.prototype.ro=function(){};
chrome.cast.T.prototype.addMessageListenerWithContext=chrome.cast.T.prototype.ro;chrome.cast.T.prototype.oo=function(){};chrome.cast.T.prototype.addMediaListener=chrome.cast.T.prototype.oo;chrome.cast.T.prototype.po=function(){};chrome.cast.T.prototype.addMediaListenerWithContext=chrome.cast.T.prototype.po;chrome.cast.T.prototype.Vq=function(){};chrome.cast.T.prototype.removeMediaListener=chrome.cast.T.prototype.Vq;chrome.cast.T.prototype.Wq=function(){};
chrome.cast.T.prototype.removeMediaListenerWithContext=chrome.cast.T.prototype.Wq;chrome.cast.T.prototype.Xq=function(){};chrome.cast.T.prototype.removeMessageListener=chrome.cast.T.prototype.Xq;chrome.cast.T.prototype.Yq=function(){};chrome.cast.T.prototype.removeMessageListenerWithContext=chrome.cast.T.prototype.Yq;chrome.cast.T.prototype.sp=function(a){a.sessionId=this.sessionId};chrome.cast.T.prototype.loadMedia=chrome.cast.T.prototype.sp;chrome.cast.T.prototype.Iq=function(a){a.sessionId=this.sessionId};
chrome.cast.T.prototype.queueLoad=chrome.cast.T.prototype.Iq;var bl=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=$k(a);a=new chrome.cast.T(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||al(a)))return null;a.receiver.volume=b.volume;Ka(b.isActiveInput)&&(a.receiver.isActiveInput=b.isActiveInput);return a},cl=function(a){var b=[];if(!a)return b;
a&1&&b.push(chrome.cast.vd.VIDEO_OUT);a&2&&b.push(chrome.cast.vd.VIDEO_IN);a&4&&b.push(chrome.cast.vd.AUDIO_OUT);a&8&&b.push(chrome.cast.vd.AUDIO_IN);a&32&&b.push(chrome.cast.vd.MULTIZONE_GROUP);return b},$k=function(a){var b=Fj(Ej(),a.getId());return new chrome.cast.Qh(b,a.f.friendlyName,cl(a.b))},dl=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],d=b.namespaces||[];if(c.length!=d.length)return!0;for(var e={Of:0};e.Of<c.length;e={Of:e.Of},e.Of++)if(!d.some(function(a){return function(b){return b.name==
c[a.Of].name}}(e)))return!0;return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},el=function(a){Ua(a)?a.forEach(el):Xa(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(Xa(a[b])||Ua(a[b]))&&el(a[b])})},fl=function(a){return a.namespaces.some(function(a){return a.name==Zi})},al=function(a){return null!==a&&"MultizoneLeader"==a.appId},gl=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==a};var hl=function(a,b,c){this.type=a;this.message=b;this.sequenceNumber=Ia(c)?c:-1;this.timeoutMillis=0;this.clientId=""};var il=function(a,b){this.h=a;this.b=b;this.g=[];this.f=new sk},kl=function(a,b){return(a=jl(a.b,b))?a.routeId:null};il.prototype.listen=function(a,b){this.g[a]=b};var ml=function(a,b,c,d){nb(ll,"Sending to "+c);nb(ll,JSON.stringify(d));d.clientId=c;a.h.g.Id(b,d)},nl=function(a,b,c){var d=jl(a.b,b);d&&d.b?ml(a,d.routeId,b,c):a.connect(b).then(function(d){d?(d=kl(a,b))?ml(a,d,b,c):ll.F("No route for "+b):ll.F("No connected client "+b)},null)};
il.prototype.connect=function(a){var b=jl(this.b,a);if(null!=b&&b.b)return Promise.resolve(!0);b=kl(this,a);if(!b)return ll.F("No route for client "+a),Promise.resolve(!1);if(a=this.f.b.get(b,null))return a.qb.b;a=new Cb;tk(this.f,new ol(b,a));return a.b};var ll=gb("mr.cast.ApiMessenger"),ol=function(a,b){rk.call(this,a,3E4);this.qb=b};n(ol,rk);ol.prototype.b=function(){this.qb.resolve(!1)};var pl=function(a,b,c){this.g=a;this.b=b;this.f=c},ql=function(a){var b="cast-dial:"+a.g,c=new URLSearchParams;a.b&&c.set("dialPostData",a.b);a.f&&c.set("clientId",a.f);(a=c.toString())&&(b+="?"+a);return b};var rl=function(a,b,c,d,e,f,h,l,r,y){this.j=a;this.b=b||null;this.f=c||null;this.g=d||null;this.h=Ia(e)?e:null;this.u=f||null;this.B=h||null;this.A=l||!1;this.o=r||null;this.l=y||null},sl=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},ul=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:Lb(Mb(a,function(a){a=sl(a,"__castAppId__");if(!a)return null;a=a.match(tl);if(!a||0==a.length)return null;var c=[];3==a.length&&a[2]&&(c=a[2].split(","));return{appId:a[1],capabilities:c}}),
function(a){return null!=a})},vl=function(a){return Mb(a.j,function(a){return a.appId})},wl=function(a){return a.f?a.f:chrome.cast.Tc.TAB_AND_ORIGIN_SCOPED},xl=function(a){var b=a.j.map(function(c){var b="cast:"+c.appId,e=new URLSearchParams;c.capabilities&&0<c.capabilities.length&&e.set("capabilities",c.capabilities.join(","));a.b&&e.set("clientId",a.b);a.f&&e.set("autoJoinPolicy",a.f);a.g&&e.set("defaultActionPolicy",a.g);null!=a.h&&e.set("launchTimeout",String(a.h));a.A&&e.set("invisibleSender",
"true");a.o&&(e.set("broadcastNamespace",a.o),e.set("broadcastId",String(Math.random())));a.l&&e.set("broadcastMessage",encodeURIComponent(JSON.stringify(a.l)));return b+"?"+e.toString()});a.u&&b.push(ql(new pl(a.u,a.B,a.b)));return b},zl=function(a,b){a=vl(a);var c=yl(b);return Ob(a,function(a){return Tb(c,a)})},Al=function(a){try{var b=new URL(a)}catch(B){return null}if("https:"==b.protocol)if("https:"!=b.protocol||"google.com"!=b.host||"/cast"!=b.pathname)a=null;else{var c=b.hash;if((a=ul(c))&&
0!=a.length){b=sl(c,"__castClientId__");var d=sl(c,"__castAutoJoinPolicy__"),e=sl(c,"__castDefaultActionPolicy__");var f=sl(c,"__castLaunchTimeout__");null==f?f=null:(f=Number(f),f=!isNaN(f)&&0<f?f:null);var h=sl(c,"__dialAppName__"),l=sl(c,"__dialPostData__");var r=sl(c,"__castInvisibleSender__");r=null===r?null:"true"==r;var y=sl(c,"__castBroadcastNamespace__");c=(c=sl(c,"__castBroadcastMessage__"))?JSON.parse(decodeURIComponent(c)):null;a=new rl(a,b,d,e,f,h,l,r,y,c)}else a=null}else if("cast:"==
b.protocol){a=b.pathname;d=b.searchParams.get("capabilities");a={appId:a,capabilities:d?d.split(","):[]};l=b.searchParams;b=l.get("clientId");d=l.get("autoJoinPolicy");e=l.get("defaultActionPolicy");c=Number(l.get("launchTimeout"));if(isNaN(c)||0>=c)c=null;f="true"==l.get("invisibleSender");h=l.get("broadcastNamespace");l=(l=l.get("broadcastMessage"))?JSON.parse(decodeURIComponent(l)):null;a=new rl([a],b,d,e,c,void 0,void 0,f,h,l)}else a=null;return a},yl=function(a){return(a=Al(a))?vl(a):null},Bl=
function(a){return(a=Al(a))?a.b:null},tl=/(^\w+)(?:\(([\w, ]*)\))?$/;var Cl={Cu:0,pu:1},Dl={ey:0,tn:1,Cw:2},El={Hv:0,TIMEOUT:1,FAILED:2},Fl={cu:0,kw:1,SEEK:2,jv:3,wx:4,Qr:5},Gl=function(a){Bb("MediaRouter.Cast.Session.Ended",a,Dl)},Hl=function(a){Bb("MediaRouter.Cast.Controller.ActionType",a,Fl)},Il=function(a){Bb("MediaRouter.Cast.Session.Fail",a,El)};var Jl=function(a,b,c){this.L=gb("mr.MediaRouteController."+a);this.h=new mojo.Binding(mojo.MediaController,this,b);this.g=c;this.b=new mojo.MediaStatus({title:"",description:"",duration:new mojo.TimeDelta({microseconds:0}),current_time:new mojo.TimeDelta({microseconds:0})});this.u=!1;this.h.setConnectionErrorHandler(this.l.bind(this));this.g.ptr.setConnectionErrorHandler(this.l.bind(this))};Jl.prototype.l=function(){this.Ua();this.Ni()};
Jl.prototype.Ua=function(){this.u||(this.u=!0,this.Mi(),this.h&&(this.h.close(),this.h=null),this.g&&(this.g.ptr.reset(),this.g=null))};var Kl=function(a){if(a.g)a.g.onMediaStatusUpdated(a.b)};g=Jl.prototype;g.Mi=function(){};g.Ni=function(){};g.play=function(){};g.pause=function(){};g.Ie=function(){};g.jc=function(){};g.seek=function(){};g.ki=function(a){a.close();throw Error("Not implemented");};Jl.prototype.connectHangoutsMediaRouteController=Jl.prototype.ki;Jl.prototype.seek=Jl.prototype.seek;
Jl.prototype.setVolume=Jl.prototype.jc;Jl.prototype.setMute=Jl.prototype.Ie;Jl.prototype.pause=Jl.prototype.pause;Jl.prototype.play=Jl.prototype.play;var Ll=function(a){var b=new URL(a);a={};a.scheme=b.protocol.replace(":","");a.host=b.hostname;b=b.port?Number.parseInt(b.port,10):0;switch(a.scheme){case "http":a.port=b||80;break;case "https":a.port=b||443;break;default:throw Error("Scheme must be http or https");}a.suborigin="";return new mojo.Origin(a)},Ml=function(a){return new mojo.TimeDelta({microseconds:Math.floor(1E6*a)})};var Nl=function(a,b,c,d){this.type=a;this.mediaSessionId=b;this.requestId=0;this.sessionId=c;this.currentTime=d},Pl=function(a,b,c,d,e){Jl.call(this,"CastRouteController",a,b);this.session=c;this.f=d;this.j=e;this.A=new Date;this.o=new Set;Ol(this);Hl(0)};n(Pl,Jl);
var Ol=function(a){var b=Ql(a);b&&Rl(a,b);b&&a.j||!a.session.statusText||(a.b.title=a.session.statusText.substring(0,256));a.b.volume=null===a.session.receiver.volume.level?0:a.session.receiver.volume.level;a.b.is_muted=!!a.session.receiver.volume.muted;a.b.can_mute=a.session.receiver.volume.controlType!==chrome.cast.fk.FIXED;a.b.can_set_volume=a.b.can_mute;Kl(a)};g=Pl.prototype;g.Ni=function(){Sl(this.f.b,this.session.sessionId)};
g.play=function(){var a=Ql(this);this.b.can_play_pause&&a&&this.b.play_state===mojo.MediaStatus.PlayState.PAUSED&&Tl(this.f,this.session,new Nl("PLAY",a.mediaSessionId,this.session.sessionId));Ul(this,1)};g.pause=function(){var a=Ql(this);this.b.can_play_pause&&a&&this.b.play_state!==mojo.MediaStatus.PlayState.PAUSED&&Tl(this.f,this.session,new Nl("PAUSE",a.mediaSessionId,this.session.sessionId));Ul(this,1)};
g.seek=function(a){var b=Ql(this);a=a?a.microseconds/1E6:0;var c;if(c=this.b.can_seek&&b&&0<=a)c=this.b.duration,c=a<=(c?c.microseconds/1E6:0);c&&Tl(this.f,this.session,new Nl("SEEK",b.mediaSessionId,this.session.sessionId,a));Ul(this,2)};g.Ie=function(a){this.b.can_mute&&a!==this.b.is_muted&&Vl(this.f,this.session,new chrome.cast.Volume(null,a));Ul(this,3)};g.jc=function(a){this.b.can_set_volume&&0<=a&&1>=a&&Vl(this.f,this.session,new chrome.cast.Volume(a));Ul(this,4)};
var Ql=function(a){return a.session.media.find(function(a){return!a.idleReason})||null},Rl=function(a,b){a.j&&b.media&&b.media.metadata&&b.media.metadata.title&&(a.b.title=b.media.metadata.title.substring(0,256));a.b.can_play_pause=b.supportedMediaCommands.includes(chrome.cast.media.ee.PAUSE);a.b.can_seek=b.supportedMediaCommands.includes(chrome.cast.media.ee.SEEK);var c=b.playerState;a.b.play_state=c===chrome.cast.media.Ye.PLAYING?mojo.MediaStatus.PlayState.PLAYING:c===chrome.cast.media.Ye.PAUSED?
mojo.MediaStatus.PlayState.PAUSED:mojo.MediaStatus.PlayState.BUFFERING;a.b.current_time=b.currentTime?Ml(b.playerState===chrome.cast.media.Ye.PLAYING?b.currentTime+(new Date-a.A)/1E3:b.currentTime):Ml(0);a.b.duration=b.media&&b.media.duration?Ml(b.media.duration):Ml(0)},Ul=function(a,b){0==a.o.size&&Hl(5);a.o.has(b)||(Hl(b),a.o.add(b))};Pl.prototype.setVolume=Pl.prototype.jc;Pl.prototype.setMute=Pl.prototype.Ie;Pl.prototype.seek=Pl.prototype.seek;Pl.prototype.pause=Pl.prototype.pause;
Pl.prototype.play=Pl.prototype.play;var Wl=function(a){this.f=a;this.m=gb("mr.cast.SessionLauncher")},Xl=function(a,b,c){Bb("MediaRouter.Cast.Session.Type",0,Cl);return Fk(a.f,b,c).then(a.b.bind(a,c),function(a){a&&Gk==a?Il(1):Il(0);throw a;})};Wl.prototype.b=function(a,b){nb(this.m,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw Il(2),Error(b.reason);a=bl(a,b.status);this.m.info("Launched session: "+a.sessionId);return a};var Yl=function(a){this.b=a;this.m=gb("mr.cast.ReceiverStatusQuerier")},Zl=function(a,b){return(new re(q(a.f,a,b),3500,5)).start().then(null,function(c){a.m.info("Failed to get receiver status from "+b.getId());throw c;})};Yl.prototype.f=function(a){this.m.info("Query receiver status: "+a.getId());return this.b.sendRequest(new qk,a,Xi)};var $l=function(a,b,c,d,e,f){this.g=a;this.l=b;this.j=c;this.b=d;this.o=e;this.h=f;this.f=new il(f,c);this.w=new Yl(this.g);this.C=new Wl(this.g)};$l.prototype.init=function(){this.j.init();this.f.listen("v2_message",this.B.bind(this));this.f.listen("app_message",this.A.bind(this));this.f.listen("leave_session",this.u.bind(this))};
var cm=function(a,b,c,d){am(a.b,b).slice().forEach(function(b){b!=d&&bm(a,b,c)})},bm=function(a,b,c){c.clientId=b;nl(a.f,b,c)},dm=function(a,b,c,d){c={receiver:$k(c),action:d};bm(a,b,new hl("receiver_action",c))};
$l.prototype.B=function(a){var b=a.message,c=b.sessionId;if(c){var d=em(this.b,c);if(d)if(c=fm(this.b,c))if(c=this.l.ka(c))switch(b.type){case "STOP":gm(this,a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":hm(this,a,c,d);break;case "SET_VOLUME":im(this,a,c);break;default:jm.F("Unknown request")}else km(this,
a,chrome.cast.Vc.INVALID_PARAMETER,"No receiver");else km(this,a,chrome.cast.Vc.INVALID_PARAMETER,"No sink ID");else km(this,a,chrome.cast.Vc.INVALID_PARAMETER,"Unknown session ID")}else km(this,a,chrome.cast.Vc.INVALID_PARAMETER,"No session ID")};
var km=function(a,b,c,d){c=new chrome.cast.Error(c,d);lm(a,b,c)},lm=function(a,b,c){nl(a.f,b.clientId,new hl("error",c,b.sequenceNumber))},gm=function(a,b,c){var d=b.message;Ab("MediaRouter.Cast.Session.End");var e=d.sessionId,f=mm(a.b,e);f&&(f.j=!0);f=function(){jk(a,e,b)};a.g.sendRequest(d,c,Xi,b.timeoutMillis,b.clientId).then(f,f)},hm=function(a,b,c,d){var e=b.message,f=e.type;f in pk&&(e.type=pk[f]);a.g.sendRequest(e,c,Zi,b.timeoutMillis,b.clientId,d.transportId).then(function(c){nm(a,d,c);nl(a.f,
b.clientId,new hl("v2_message",c,b.sequenceNumber))},function(c){lm(a,b,c)})},im=function(a,b,c){var d=b.message;delete d.sessionId;a.g.sendRequest(d,c,Xi,b.timeoutMillis,b.clientId).then(function(){nl(a.f,b.clientId,new hl("v2_message",null,b.sequenceNumber))},function(c){lm(a,b,c)})};
$l.prototype.A=function(a){var b=this,c=a.message,d=c.sessionId;if(d){var e=fm(this.b,d);e?(e=this.l.ka(e))?(d=em(this.b,d),Rb(d.namespaces,function(a){return a.name==c.namespaceName})?Dk(this.o,e,c.namespaceName,c.message,a.clientId,d.transportId).then(function(){nl(b.f,a.clientId,new hl("app_message",null,a.sequenceNumber))},function(){km(b,a,chrome.cast.Vc.CHANNEL_ERROR,"Channel to receiver not available")}):km(this,a,chrome.cast.Vc.INVALID_PARAMETER,"Invalid namespace")):jm.F("No receiver from sinkId"):
jm.F("No sinkId from sessionId")}else jm.F("No sessionId")};
$l.prototype.u=function(a){var b=this;jm.info("Leave session");var c=mm(this.b,a.message);if(c){var d=a.clientId,e=jl(this.j,d);if(e){var f=[],h=[],l=e.tabId,r=e.origin,y=e.autoJoinPolicy;c.f.forEach(function(a){var c=jl(b.j,a);y==chrome.cast.Tc.TAB_AND_ORIGIN_SCOPED&&l==c.tabId&&r==c.origin||y==chrome.cast.Tc.ORIGIN_SCOPED&&r==c.origin?(c.f=!0,f.push(a)):h.push(a)});nl(this.f,d,new hl("leave_session",null,a.sequenceNumber));f.forEach(function(a){(a=jl(b.j,a))&&om(b.h,a.routeId,!0,!0)});c.f=h}else jm.F("No client record")}else jm.F("No session")};
var pm=function(a,b,c){fl(b)&&a.g.sendRequest(new qk,c,Zi,void 0,void 0,b.transportId).catch(Qa)},ck=function(a,b,c){var d=b.getId();jm.info("Query status for "+d);Zl(a.w,b).then(function(e){qm(a,d,e);c&&(e=rm(a.b,d))&&pm(a,e,b)},Qa)},sm=function(a,b){if("*"==b.destinationId)return!0;b=b.destinationId;if(b==a.o.l||null!=jl(a.j,b))return!0;jm.info("Invalid destination "+b);return!1},wm=function(a,b,c){nb(jm,function(){return"Cast message: "+JSON.stringify(c)});if(sm(a,c))if(c.namespace_==Yi||c.namespace_==
$i)(b=ik(a.b,b))&&b.b.forEach(function(b){var d=a.h,e=d.f.get(b);e&&e.jf&&d.g.yh(b,c)});else{var d=JSON.parse(c.data),e=tm(a,d);e=e?e.sourceId:void 0;switch(d.type){case "RECEIVER_STATUS":qm(a,b,d);break;case "MEDIA_STATUS":um(a,b,c,e)}}else vm(a.o,b,c.destinationId,c.sourceId,!1)},tm=function(a,b){a=uk(a.g.b,b.requestId);if(!a)return null;var c=a.qb;switch(b.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete b.requestId;c.reject(new chrome.cast.Error(chrome.cast.Vc.SESSION_ERROR,
b.reason||b.type,b));break;default:c.resolve(b)}return a},xm=function(a,b,c){nb(jm,function(){return"App message: "+JSON.stringify(c)});if(b=rm(a.b,b)){var d;"*"==c.destinationId?d=am(a.b,b.sessionId):d=[c.destinationId];var e=new Yk(b.sessionId,c.namespace_,c.data);d.forEach(function(c){nl(a.f,c,new hl("app_message",e))})}else jm.F("No session for incoming app message")},ym=function(a,b){a.forEach(function(a){a.sessionId=b;var c=a.supportedMediaCommands,e=[];c&1&&e.push(chrome.cast.media.ee.PAUSE);
c&2&&e.push(chrome.cast.media.ee.SEEK);c&4&&e.push(chrome.cast.media.ee.STREAM_VOLUME);c&8&&e.push(chrome.cast.media.ee.STREAM_MUTE);a.supportedMediaCommands=e});return a},nm=function(a,b,c){b=b.sessionId;c.sessionId=b;c=ym(c.status,b);zm(a.b,b,c);(a=mm(a.b,b))&&a.controller&&(a=a.controller,a.A=new Date,(c=Ql(a))?Rl(a,c):(a.j&&(a.b.title=""),a.b.can_play_pause=!1,a.b.can_seek=!1),Kl(a))},Am=function(a,b){if(b=rm(a.b,b)){b=b.sessionId;var c=mm(a.b,b);c&&c.j||jk(a,b)}},jk=function(a,b,c){c&&bm(a,c.clientId,
c);(c=mm(a.b,b))&&c.b.slice().forEach(function(c){om(a.h,c,!0)});Bm(a.b,b);Cm(a.h)},qm=function(a,b,c){nb(jm,"Receiver status for "+b);var d=c.status;if(d)if(c=a.l.ka(b)){d=bl(c,d);var e=ik(a.b,b);e?d?d.sessionId==e.session.sessionId?(b=e.session,dl(b,d)&&(nb(jm,"Updating session "+d.sessionId),e.g&&(b.statusText=d.statusText),b.namespaces=d.namespaces,b.receiver.volume=d.receiver.volume,Dm(a.h,e),cm(a,b.sessionId,new hl("update_session",b)),e.controller&&Ol(e.controller))):(Am(a,b),Gl(1),Em(a.h,
null,c,null,d)):(Am(a,b),Gl(1)):d&&Em(a.h,null,c,null,d)}else Ab("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),jm.F("Got message from receiver "+b+", but sink is no longer available.")},um=function(a,b,c,d){if(b=rm(a.b,b))if(c=JSON.parse(c.data))nm(a,b,c),cm(a,c.sessionId,new hl("v2_message",c),d)},Fm=function(a,b){var c=cl(b.b);return(b=Rb(a.j,function(a){return Pb(a.capabilities,function(a){return Tb(c,a)})}))?b.appId:vl(a)[0]},Gm=function(a,b,c){var d=Al(b);if(!d)return Promise.reject(Error("Invalid source "+
b));var e=Fm(d,c),f=new rb("MediaRouter.Cast.Session.Launch");return Xl(a.C,new chrome.cast.bk(e,void 0,null==d.h?chrome.cast.timeout.requestSession:d.h),c).then(function(a){jm.info("Launched session "+a.sessionId+" for appId "+e);f.b("Success");return a},function(a){jm.error("Failed to session for appId "+e);f.b("Failure");throw a;})};
$l.prototype.createMediaRouteController=function(a,b,c){a=Hm(this.b,a);if(!a)return Error("Session not found for the route");var d=a.session;if(a.controller)return Error("Controller already exists for the route");var e=Im(this,d.sessionId);if(!e)return Error("Sink not found for the route");a.controller=new Pl(b,c,d,this,a.g);pm(this,d,e);return null};
var Tl=function(a,b,c){var d=Im(a,b.sessionId);d&&a.g.sendRequest(c,d,Zi,0,"",b.transportId).catch(function(a){jm.F("Failed to send a media control request: "+a)})},Vl=function(a,b,c){c=new Zk(c);(b=Im(a,b.sessionId))&&a.g.sendRequest(c,b,Xi).catch(function(a){jm.F("Failed to send a volume control request: "+a)})},Im=function(a,b){return(b=fm(a.b,b))?a.l.ka(b):null},jm=gb("mr.cast.ApiHandler");var Jm=function(a){return"0F5096E8"==a||"85CDB22F"==a};var Km=function(a,b,c,d,e){for(var f=[],h=4;h<arguments.length;++h)f[h-4]=arguments[h];var l=this;this.j=a;this.l=b;this.Xi=c;this.f=d;this.h=f;this.b=!1;this.g=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];return l.Ho.apply(l,m(c))}};g=Km.prototype;g.addListener=function(){this.b||(this.b=!0,this.f.addListener.apply(this.f,[this.g].concat(m(this.h))))};g.removeListener=function(){this.b&&(this.f.removeListener(this.g),this.b=!1)};
g.Mg=function(a){for(var b=0;b<arguments.length;++b);return!0};g.Ho=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d=this;rg(this.j);if(!this.Mg.apply(this,m(b)))return!1;hg(this.Xi).then(function(a){return a.handleEvent.apply(a,[d.f].concat(m(b)))});return this.mi()};g.Aa=function(){return"mr.EventListener."+this.l};g.fb=function(){return[this.b]};g.eb=function(){hj(this)&&this.addListener()};g.mi=function(){};var Lm=null,Mm=null,Nm=function(){Lm||(Lm=new Km(2,"CastChannelMessageListener","mr.cast.ChannelService",chrome.cast.channel.onMessage));Mm||(Mm=new Km(1,"CastChannelErrorListener","mr.cast.ChannelService",chrome.cast.channel.onError));return[Lm,Mm]};var Om=function(){},Pm=function(a){if(!a.startsWith("urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;var c=b.match(/([^/]*)\/([^-/]*)-([^/]*)\/(.*)/);if(!c)return null;b=new Om;b.g=a;a=k(c);a.next();b.b=a.next().value;b.h=a.next().value;b.j=a.next().value;b.f=a.next().value;return b};Om.prototype.fa=function(){return this.f};var Qm=function(a,b,c,d,e,f){this.id=a;this.presentationId=b;this.sinkId=c;this.mediaSource=d;this.isLocal=e;this.description=f;this.iconUrl=null;this.allowStop=!0;this.customControllerPath=null;this.supportsMediaRouteController=!1;this.controllerType=mojo&&mojo.RouteControllerType&&mojo.RouteControllerType.kNone;this.forDisplay=!0;this.offTheRecord=!1;this.jf=e;this.isOffscreenPresentation=!1},Rm=function(a,b,c,d,e,f){b=d&&wg(d)?a:"urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+d;return new Qm(b,
a,c,d,e,f)};var Sm=function(a,b,c,d){c=Rm(c,"cast",b.getId(),a,d,"");c.supportsMediaRouteController=!0;mojo&&mojo.RouteControllerType&&(c.controllerType=d&&sg(a)&&b.b&1&&mojo.RouteControllerType.kMirroring?mojo.RouteControllerType.kMirroring:mojo.RouteControllerType.kGeneric);return c},Tm=function(a,b){var c=b.ib.bc;c&&(b.description=Hg(c),a.displayName="",a.statusText="mirror_desktop"==c.f?"":c.g||"")};var Um=function(a,b,c,d){return{namespace_:a,data:Ja(b)?b:JSON.stringify(b),sourceId:c,destinationId:d}};var Vm=function(a){this.type="CLOSE";this.reasonCode=a};var Wm=function(a){return(a=a.exec(Hc))?a[1]:""},Xm=function(){if(ih)return Wm(/Firefox\/([0-9.]+)/);if(kd||ld||jd)return Ed;if(mh)return dd()||Kc("iPad")||Kc("iPod")?Wm(/CriOS\/([0-9.]+)/):Wm(/Chrome\/([0-9.]+)/);if(nh&&!(dd()||Kc("iPad")||Kc("iPod")))return Wm(/Version\/([0-9.]+)/);if(jh||kh){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec(Hc);if(a)return a[1]+"."+a[2]}else if(lh)return(a=Wm(/Android\s+([0-9.]+)/))?a:Wm(/Version\/([0-9.]+)/);return""}();var Zm=function(a){this.type="CONNECT";this.origin={};this.userAgent=Hc;var b=this.userAgent.indexOf("(")+1;b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:Xm,platform:Ym(),systemVersion:b,connectionType:1};this.connType=a?0:2},Ym=function(){switch(Pf()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var $m=function(a){if(!chrome.runtime.lastError)return null;var b="chrome.cast.channel.send failed, chrome.runtime.lastError: "+(chrome.runtime.lastError.message||"Unknown error");a&&nb(a,b);return Error(b)};var an=function(){this.b=new Tj};an.prototype.init=function(){kj(this)};var bn=function(a,b,c,d,e){if(!Wj(a.b,[b.channelId,c,d].join("#"))){var f=Um(Wi,new Zm(e),c,d);chrome.cast.channel.send(b,f,a.f.bind(a));a.b.set([b.channelId,c,d].join("#"),e)}};an.prototype.f=function(){$m(cn)};
var fk=function(a,b){a.b.sb().forEach(function(c){c.split("#")[0]==b.channelId.toString()&&a.b.remove(c)})},bk=function(a,b,c){a.b.forEach(function(d,e){var f=e.split("#");f[0]==b.channelId.toString()&&(bn(a,c,f[1],f[2],d),a.b.remove(e))})};an.prototype.Aa=function(){return"cast.VirtualConnectionManager"};an.prototype.fb=function(){var a=Yj(this.b);return[new en(a)]};an.prototype.eb=function(){var a=hj(this);if(a)for(var b in a.b)this.b.set(b,a.b[b])};Ra(an);
var cn=gb("mr.cast.VirtualConnectionManager"),en=function(a){this.b=a};var fn=function(a,b){this.j=b;this.l=a;this.f=new Tj;this.b=new Tj;this.g=an.Ea();this.ka=null;this.h=new Tj};n(fn,dg);fn.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];a==chrome.cast.channel.onMessage?this.A.apply(this,m(c)):a==chrome.cast.channel.onError&&this.o.apply(this,m(c))};fn.prototype.init=function(){this.g.init();kj(this);og("mr.cast.ChannelService",this);Nm().forEach(function(a){return a.addListener()})};
var Dk=function(a,b,c,d,e,f){e=e||a.l;f=f||"receiver-0";var h=lk(a,b);return h?gn(a,h,c,d,e,f):Promise.reject("Channel not found for "+b.getId())},vm=function(a,b,c,d,e){if(b=a.f.get(b))a=a.g,Wj(a.b,[b.channelId,c,d].join("#"))&&(a.b.remove([b.channelId,c,d].join("#")),c=Um(Wi,new Vm(e?5:0),c,d),chrome.cast.channel.send(b,c,a.f.bind(a)))};
fn.prototype.A=function(a,b){var c=this.b.get(a.channelId);if(c){var d=this.ka(c);if(d){if(bj.hasOwnProperty(b.namespace_)){var e=JSON.parse(b.data);switch(e.type){case "CLOSE":this.g.b.remove([a.channelId,b.destinationId,b.sourceId].join("#"));return;case "RPC":break;default:nb(ak,function(){return"Got message "+(e.type||e.responseType)+" "+("from "+d.getId())})}}else nb(ak,"Got message in "+b.namespace_+" from "+d.getId());hn(this.j,d,b)}else ak.F("Got message for unknown receiver (receiverId="+
c+").")}else ak.F("Got message for unknown channel (channelId="+a.channelId+").")};var jn=function(a,b){var c=a.b.get(b.channelId);c&&(a.b.remove(b.channelId),a.f.remove(c))};fn.prototype.o=function(a,b){ak.F(function(){return"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):"")});jn(this,a)};
var lk=function(a,b){b=b.getId();(a=a.f.get(b))||ak.info("Channel not found for receiver: "+b);return a},gn=function(a,b,c,d,e,f){bn(a.g,b,e,f,0==f.indexOf("receiver-0"));el(d);var h=Um(c,d,e,f);"object"===typeof d&&"RPC"==d.type||nb(ak,function(){return"Channel is sending message: "+JSON.stringify(h)});return new Promise(function(c,d){chrome.cast.channel.send(b,h,function(b){b?b.errorState?(d(Error("Failed to send message")),jn(a,b)):c(!0):(b=$m(ak||void 0),d(b))})})};fn.prototype.Aa=function(){return"cast.ChannelService"};
fn.prototype.fb=function(){return[new kn(Yj(this.f),Yj(this.b),Yj(this.h))]};fn.prototype.eb=function(){var a=hj(this);a&&(Sj(this.f,a.f),Sj(this.b,a.b),Sj(this.h,a.g))};var ak=gb("mr.cast.ChannelService"),kn=function(a,b,c){this.f=a;this.b=b;this.g=c};var ln=function(a,b,c,d,e,f){this.routeId=a;this.clientId=b;this.appIds=c;this.autoJoinPolicy=d;this.origin=e;this.tabId=f;this.f=this.b=!1},mn=function(){this.b=[]};mn.prototype.init=function(){kj(this)};mn.prototype.sa=function(){return this.b.length};var jl=function(a,b){return Rb(a.b,function(a){return a.clientId==b})},nn=function(a,b){return Rb(a.b,function(a){return a.routeId==b})},on=function(a,b){a.b=Lb(a.b,function(a){return a.clientId!=b})};mn.prototype.Aa=function(){return"cast.ClientRecords"};
mn.prototype.fb=function(){return[new pn(this.b)]};mn.prototype.eb=function(){var a=hj(this);a&&(this.b=a.b)};var pn=function(a){this.b=a};var qn=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var rn=function(a,b){this.h=a;this.f=b;this.g=new Pk;this.b=new Tj};rn.prototype.init=function(){kj(this)};var sn=function(a,b){var c=a.b.get(b);c&&(c.pj--,0<c.pj||(Pj(a.f.b.Ab(!1),function(a){switch(Lj(a,b)){case "available":a.Ub[b]="available_rescan";break;case "unavailable":a.Ub[b]="unavailable_rescan"}}),a.b.remove(b)))};g=rn.prototype;
g.tl=function(a){var b=this;Pj(this.b.Ab(!0),function(c){a:{switch(Lj(a,c)){case "unknown":case "available_rescan":case "unavailable_rescan":var d=!0;break a}d=!1}if(d){var e=a.getId()+":"+c;b.g.contains(e)||(b.g.add(e),d=function(){b.g.remove(e)},(new re(b.Bo.bind(b,a,c),5500,3)).start().then(b.um.bind(b,a,c),function(){b.m.error("Failed to get app availability response for "+a.getId()+", appId "+c+" after 3 attempts.");b.um(a,c,"unknown")}).then(d,d))}})};
g.um=function(a,b,c){c!=Lj(a,b)&&(this.m.info(b+" on "+a.getId()+" is "+c),a.Ub[b]=c,dk(this.f.h,a))};
g.Bo=function(a,b){var c=this,d=new qn;d.appId=[b];var e=new rb("MediaRouter.Cast.App.Availability");return this.h.sendRequest(d,a,Xi,5E3).then(function(a){e.b("Success");nb(c.m,function(){return"App availability response "+JSON.stringify(a)});for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(d){e.b("Failure");c.m.error("checkAppAvailability_ failed for "+a.getId()+", appId "+b);
throw d;})};g.Aa=function(){return"cast.AppDiscoveryService"};g.fb=function(){return[new tn(Yj(this.b))]};g.eb=function(){var a=hj(this);a&&Sj(this.b,a.b)};g.m=gb("mr.cast.AppDiscoveryService");var tn=function(a){this.b=a};var un=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var vn=function(a,b){this.f=[];this.b=[];this.sinkId=a;this.session=b;this.l=this.h=null;this.offTheRecord=this.j=!1;this.controller=null;this.g=!0},wn=function(){this.m=gb("mr.cast.SessionRecords");this.b=[]};wn.prototype.init=function(){kj(this)};
var Bm=function(a,b){a.m.info("Removing session "+b);Sl(a,b);a.b=Lb(a.b,function(a){return a.session.sessionId!=b})},am=function(a,b){return(a=mm(a,b))?a.f:[]},rm=function(a,b){return(a=ik(a,b))?a.session:null},xn=function(a,b){return Rb(a.b,function(a){return Tb(a.f,b)})},Hm=function(a,b){return Rb(a.b,function(a){return Tb(a.b,b)})},yn=function(a,b){return Rb(a.b,function(a){return null!=Rb(a.b,function(a){return Pm(a).b==b})})},ik=function(a,b){return Rb(a.b,function(a){return a.sinkId==b||a.h==
b})},mm=function(a,b){return Rb(a.b,function(a){return a.session.sessionId==b})},fm=function(a,b){return(a=mm(a,b))?a.sinkId:null},em=function(a,b){return(a=mm(a,b))?a.session:null},zm=function(a,b,c){var d=em(a,b);d&&(a=Lb(c,function(a){return a.playerState!=chrome.cast.media.Ye.IDLE}),a.forEach(function(a){if(!a.media){var c=Rb(d.media,function(c){return c.mediaSessionId==a.mediaSessionId});c&&(a.media=c.media)}}),d.media=a)};wn.prototype.Aa=function(){return"cast.SessionRecords"};
wn.prototype.fb=function(){return[new zn(this.b)]};wn.prototype.eb=function(){var a=hj(this);if(a)for(var b=0;b<a.b.length;b++){var c=a.b[b],d=new vn(c.sinkId,c.session);d.f=c.f;d.b=c.b;d.j=c.j;d.l=c.l;d.h=c.h;d.g=c.g;this.b.push(d)}};
var Sl=function(a,b){(a=mm(a,b))&&a.controller&&(a.controller.Ua(),a.controller=null)},zn=function(a){var b=[];a=k(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=new vn(c.sinkId,c.session);d.f=c.f;d.b=c.b;d.j=c.j;d.l=c.l;d.h=c.h;d.offTheRecord=c.offTheRecord;d.g=c.g;b.push(d)}this.b=b};var An=function(a,b,c){var d=Error.call(this);this.message=d.message;"stack"in d&&(this.stack=d.stack);this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,An);else if(b=Error().stack)this.stack=b;this.errorCode=a};n(An,Error);var Bn=function(a,b){this.sinks=a;this.origins=b||null},Cn=new Bn([]);var Dn=function(a){this.B="sender-"+Dc();this.f=new Tj;this.A=null;kj(this);this.g=a;this.o=new mn;this.h=new wn;this.u=new fn(this.B,this);this.b=new Zj(this.u,this);this.w=new Ak(this.u,this.B);this.l=null;this.j=new $l(this.w,this.b,this.o,this.h,this.u,this);this.C=new Tk(this.b,this.w)};g=Dn.prototype;g.getName=function(){return"cast"};
g.initialize=function(a){a=a&&"boolean"===typeof a.enable_cast_sink_query?a.enable_cast_sink_query:!0;this.m.info("Query enabled: "+a);this.w.init();this.h.init();this.j.init();this.u.init();this.b.init();a&&(this.l=new rn(this.w,this.b),this.l.init())};g.fd=function(){return this.f.ia()};
g.fg=function(a){var b=this;if(null!=En(a))return new Bn([]);var c=new Pk;Fn(a).forEach(function(a){nk(b.b,a).map(function(a){return a.f}).forEach(function(a){c.add(a)})});return new Bn(c.ia(),-1!=a.indexOf("0F5096E8")?xg:null)};
g.startObservingMediaSinks=function(a){var b=this,c=En(a);c?(this.m.info("Received broadcast request "+a),Pj(this.b.b.Ab(!1),function(a){b.w.sendMessage(c,a,aj).catch(function(a){b.m.error("Broadcast failed "+a.message)})})):this.l&&Fn(a).forEach(function(a){var c=b.l,d=c.b.get(a);d?d.pj++:c.b.set(a,{pj:1});c.m.info("Scanning sinks for app availability");Pj(c.f.b.Ab(!1),c.tl,c)})};g.stopObservingMediaSinks=function(a){var b=this;null!=En(a)||this.l&&Fn(a).forEach(function(a){sn(b.l,a)})};
g.startObservingMediaRoutes=function(){};g.stopObservingMediaRoutes=function(){};g.ka=function(a){return(a=this.b.ka(a))?a.f:null};
var Gn=function(a,b,c){a.m.error("Error launching.",c);om(a,b.id,!1,!0,"error");c=new Af(un,"warning");Ef(c,b.id);Ff(c,b.sinkId);a.g.ze(c)},Jn=function(a,b,c,d,e,f,h,l){Ej().f=new Bj(c.kc,c.Tb());var r=Sm(b,c,d,!0);r.forDisplay=!1;r.offTheRecord=e;a.f.set(r.id,r);a.g.Cf(a,r);Cm(a);(e=Al(b))&&e.b&&Hn(a,e,r.id,h,l);vg(b)||wg(b)?(r.ib={tabId:l,sessionId:"",If:c.Tb()||"",Od:c.kc||"",sr:c.f.friendlyName||""},wg(b)&&(r.isOffscreenPresentation=!0),a.g.Oi(a,r,d,function(e){return Kf(In(a,b,c,d,f,h,l,e))}).b.then(function(){var c=
Hm(a.h,r.id);c.g=!1;Tm(c.session,r);c.controller&&(c.controller.j=!1,Ol(c.controller))},function(c){Gn(a,r,c)})):In(a,b,c,d,f,h,l,r).then(null,function(c){Gn(a,r,c)});return Promise.resolve(r)},In=function(a,b,c,d,e,f,h,l){return Gm(a.j,Kn(b,c,e),c).then(function(e){Em(a,b,c,d,e,f,h,l);return l})};
Dn.prototype.createRoute=function(a,b,c,d,e,f,h){var l=this,r=this.b.ka(b);if(!r)return Jf(Error("No sink with ID "+b));var y=Bl(a);if(y){setTimeout(function(){dm(l.j,y,r,chrome.cast.Rf.CAST)},0);var B=function(){return Jn(l,a,r,c,d,e,f,h)},G=jl(this.o,y);if(G)return Kf(this.terminateRoute(G.routeId).then(B,B));if(f&&h&&(b=Ln(this,a,f,h,d,e,b)))return b}return Kf(Jn(this,a,r,c,d,e,f,h))};
var om=function(a,b,c,d,e){d=void 0===d?!1:d;e=void 0===e?"closed":e;a.m.info("Remove route "+b);var f=nn(a.o,b);if(f){c=c||f.f;var h=f.clientId;a.m.info("Remove client "+h);for(var l=a.h,r=0;r<l.b.length;r++)$b(l.b[r].f,h);on(a.o,h)}if(h=Hm(a.h,b))$b(h.b,b),Mn(a,h.b);if(l=a.f.get(b))if(l.jf&&h&&(vm(a.u,l.sinkId,f?f.clientId:a.B,h.session.transportId,c),l.forDisplay&&f&&(a.A={gf:f,fm:h})),a.f.remove(b),a.g.ng(l),Cm(a),d)a.g.onPresentationConnectionClosed(b,e,"Remove route");else a.g.onPresentationConnectionStateChanged(b,
"terminated")},Dm=function(a,b){b.b.forEach(function(c){if(c=a.f.get(c)){var d=b.session;if(c.forDisplay){var e=Jm(d.appId);e&&!c.isLocal?(c.description=d.statusText||"",d.displayName="",d.statusText=""):e||(c.description=d.statusText||d.displayName);b.controller&&Ol(b.controller)}a.g.ye(c)}})},Nn=function(a,b){Ob(b,function(c){c=a.f.get(c,null);if(!c||!c.mediaSource)return!1;var b=Al(c.mediaSource);b=b?b.A:!1;return c.isLocal&&!b})&&w(b,function(c){if(c=a.f.get(c,null))c.isLocal=!0})},Mn=function(a,
b){var c=[],d=[],e=null;b.forEach(function(b){if(b=a.f.get(b)){b.forDisplay=!1;var f=Al(b.mediaSource);f&&Rb(vl(f),gl)||(b.jf?(f=f?wl(f):null,e||f==chrome.cast.Tc.CUSTOM_CONTROLLER_SCOPED||(c.push(b),e=b.sinkId)):e&&e!=b.sinkId?c.push(b):d.push(b))}});w(0<c.length?c:d,function(a){a.forDisplay=!0})},Hn=function(a,b,c,d,e){var f=b.b;if(f&&!jl(a.o,f)){a.m.info("Add client "+f);var h=vl(b);a.o.b.push(new ln(c,f,h,wl(b),d||null,Ia(e)?e:null))}},Em=function(a,b,c,d,e,f,h,l){var r=ik(a.h,c.getId());if(!r){var y=
a.h;r=c.getId();y.m.info("Adding new session: "+r+", "+e.sessionId);var B=mm(y,e.sessionId);B?(al(e)?(B.l=e,B.h=r):al(B.session)&&(B.l=B.session,B.h=B.sinkId,B.session=e,B.sinkId=r),r=B):(r=new vn(r,e),y.b.push(r))}l&&l.isLocal&&l.ib&&(r.g=!1);var G=null!=b;if(!G&&gl(e.appId))return null;null==b?(B=new rl([{appId:e.appId,capabilities:e.capabilities}]),b=xl(B)[0]):B=Al(b);if(y=l){if(!a.f.get(y.id))return a.m.F("Route "+y.id+" not added"),y}else y=Sm(b,c,d||e.sessionId,G),a.f.set(y.id,y);d=y.id;a.m.info("Add route "+
d);b=null;B&&(b=B.b,Hn(a,B,d,f,h));Tb(r.b,d)||r.b.push(d);y.jf&&(f=a.u,h=b||a.B,d=e.transportId,B=!(B&&B.A),(G=lk(f,c))&&bn(f.g,G,h,d,B));r.offTheRecord=y.offTheRecord;f=r.b;Nn(a,f);Mn(a,f);f=y;h=e.sessionId;Jm(e.appId)?f.isLocal&&h&&f.ib?f.ib.sessionId=h:(f.description=e.statusText||"",e.displayName="",e.statusText=""):f.description=e.statusText||e.displayName;l?a.g.ye(y):a.g.Cf(a,y);Cm(a);if(l=b)Tb(r.f,b)?l=!1:(r.f.push(b),l=!0);l&&(a=a.j,nl(a.f,b,new hl("new_session",e)),pm(a,e,c));return y};
Dn.prototype.terminateRoute=function(a){var b=this,c=this.f.get(a);if(!c)return Promise.reject(new An(3,"Route in Cast provider not found for routeId  "+a));var d=Hm(this.h,a);if(!d)return om(this,a,!0),Promise.resolve();var e=d.session.sessionId,f=this.b.ka(c.sinkId);if(!f)return jk(this.j,e),Promise.resolve();(a=nn(this.o,a))&&dm(this.j,a.clientId,f,chrome.cast.Rf.STOP);Gl(0);return new Promise(function(a){var c=function(){Am(b.j,f.getId());a()};b.w.sendRequest(new xk(e),f,Xi).then(c,c)})};
var On=function(a,b){var c=null;Qj(a.f.Ab(!1),function(d){if(!d.jf)return!1;var e=a.b.ka(d.sinkId);if(!e||!zl(b,Kn(d.mediaSource,e)))return!1;c=d;return!0});if(!c||!c.mediaSource)return null;var d=Bl(c.mediaSource);if(!d)return null;var e=jl(a.o,d);return e?(d=xn(a.h,d))?{gf:e,fm:d}:null:null},Ln=function(a,b,c,d,e,f,h){var l=null;Qj(a.f.Ab(!1),function(a){var c=a.ib;return c&&null!=c.tabId&&c.tabId==d&&sg(a.mediaSource)?(l=a,!0):!1});if(!l)return null;var r=function(){return a.createRoute(b,h||l.sinkId,
"",e,f,c,null==d?void 0:d)};return Kf(a.terminateRoute(l.id).then(r,r))};g=Dn.prototype;g.connectRouteByRouteId=function(a,b,c,d,e){if(!Al(a))return Jf(Error("Unsupported presentation URL"));if(!b)return Jf(Error("No routeId"));b=Pm(b);b=mm(this.h,b.b);if(!b)return Jf(Error("No matching route"));var f=this.b.ka(b.sinkId);return f?(a=Em(this,a,f,c,b.session,d,e))?If(a):Jf(Error("Failed to create route")):Jf(Error("No sink"))};
g.joinRoute=function(a,b,c,d,e,f){var h=Al(a);if(!h)return Jf(Error("Unsupported presentation URL"));if(b==chrome.cast.Jj){a:{var l=On(this,h);if(!l){if(!this.A||this.A.gf.origin!=e||this.A.gf.tabId!=f){l=null;break a}l=this.A}switch(wl(h)){case chrome.cast.Tc.PAGE_SCOPED:l=null;break a;case chrome.cast.Tc.ORIGIN_SCOPED:if(e!=l.gf.origin){l=null;break a}break;case chrome.cast.Tc.TAB_AND_ORIGIN_SCOPED:if(e!=l.gf.origin||f!=l.gf.tabId){l=null;break a}}l=mm(this.h,l.fm.session.sessionId)}if(!l&&(h.g?
h.g:chrome.cast.Sg.CREATE_SESSION)!=chrome.cast.Sg.CAST_THIS_TAB&&(d=Ln(this,a,e,f,c,d)))return d}else l=Pn(this,b);if(!l)return Jf(Error("No matching route"));if(l.offTheRecord!=c)return Jf(Error("Off the record mismatch"));d=this.b.ka(l.sinkId);if(!d)return Jf(Error("No sink"));a=Em(this,a,d,b,l.session,e,f);a.offTheRecord=c;return If(a)};g.detachRoute=function(a){om(this,a,!1,!0)};
g.nf=function(a){var b=this.b.ka(a);if(!b)throw Error("Cannot mirror with no sink.");var c=new Og;b=b.b;b&1||(c.shouldCaptureVideo=!1);b&4||(c.shouldCaptureAudio=!1);c.shouldCaptureAudio&&!c.shouldCaptureVideo&&(c.minLatencyMillis=c.maxLatencyMillis,c.animatedLatencyMillis=c.maxLatencyMillis);c.senderSideLetterboxing=!0;Pg(c);Object.freeze(c);this.m.info(function(){return"Settings for "+a+": "+Ng(c)});if(!c.shouldCaptureAudio&&!c.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture");
return c};g.te=function(){return"cast_streaming"};g.zh=function(a){var b=this.f.get(a);b&&b.ib&&b.ib.bc&&(a=Hm(this.h,a))&&(Tm(a.session,b),a.controller&&Ol(a.controller))};
g.sendRouteMessage=function(a,b,c){var d=this;if(!c)return new Promise(function(a,c){"string"!==typeof b&&c(Error("Cannot send non-string messages via ApiHandler."));c=d.j.f;nb(ll,"Received: "+b);var e=JSON.parse(b),f=e.clientId;"client_connect"==e.type?(nb(ll,"App "+f),(e=jl(c.b,f))?(e.b=!0,(c=uk(c.f,e.routeId))&&c.qb.resolve(!0)):ll.F("Client not found "+f)):kl(c,f)?(c=c.g[e.type])&&c(e):ll.F("No route for "+f);a()});var e=Hm(this.h,a);if(!e)return Promise.reject(Error("Not managing the route "+
a));var f=this.b.ka(e.sinkId);if(!f)return Promise.reject(Error("Sink no longer accessible"));var h=(a=nn(this.o,a))?a.clientId:this.B;return new Promise(function(a){Dk(d.u,f,c.namespace,b,h,e.session.transportId).then(a,a)})};g.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};g.Vf=function(a,b){var c=this.b.ka(b);if(!c)return!1;if(!this.l)return!0;a=Kn(a,c);return(a=yl(a))&&0!=a.length?Ob(a,function(a){return cj(Lj(c,a))}):!1};
g.ff=function(a,b,c){var d=Fn(a);return d&&0!=d.length?b==chrome.cast.Jj?!0:c&&c.mediaSource?(a=yl(c.mediaSource),Ob(a,function(a){return Tb(d,a)})):void 0==b||Pn(this,b)?!0:!1:!1};
var Kn=function(a,b,c){return Al(a)?a:vg(a)||wg(a)?(a={appId:0==(b.b&1)?"85CDB22F":"0F5096E8",capabilities:cl(b.b)},xl(new rl([a],void 0,void 0,void 0,c))[0]):a},Fn=function(a){var b=[],c=Al(a);if(c)b=vl(c);else if(vg(a)||wg(a))tg(a)||b.push("85CDB22F"),b.push("0F5096E8");return b},En=function(a){var b=Al(a);if(!b)return null;a=Fn(a);var c=b.o||"";b=b.l;return c&&b?new vk(a,c,JSON.stringify(b)):null},Pn=function(a,b){return 0==b.indexOf(chrome.cast.Yj)?mm(a.h,b.substr(chrome.cast.Yj.length)):yn(a.h,
b)},hn=function(a,b,c){var d=a.C;if(Uk(d)&&bj.hasOwnProperty(c.namespace_)){var e=b.Tb();if(e){var f=JSON.parse(c.data);if("RECEIVER_STATUS"===f.type){var h=f.status&&f.status.applications&&f.status.applications[0],l=f=null;h&&(h.appId&&(f=h.appId),h.sessionId&&(l=h.sessionId));h=d.f.get(e);d.f.set(e,new Ti(e,f,l));h&&h.appId===f||Vk(d)}}}a=a.j;b=b.getId();bj.hasOwnProperty(c.namespace_)?wm(a,b,c):xm(a,b,c)},dk=function(a,b){a.l&&a.l.tl(b);kk(a.C);a.g.Nc()};g=Dn.prototype;g.Aa=function(){return"cast.Provider"};
g.fb=function(){return[new Qn(this.B,Yj(this.f),this.A)]};g.eb=function(){var a=hj(this);a&&(this.B=a.g,Sj(this.f,a.f),this.A=a.b)};g.searchSinks=function(){return db()};g.createMediaRouteController=function(a,b,c){return(a=this.j.createMediaRouteController(a,b,c))?Promise.reject(a):Promise.resolve()};g.provideSinks=function(a){hk(this.b,a)};var Cm=function(a){var b=a.fd().some(function(a){return a.isLocal});a.g.Ff(a.Aa(),b)};Dn.prototype.m=gb("mr.CastProvider");
var Qn=function(a,b,c){this.g=a;this.f=b;this.b=c};var Rn=function(){this.b=[]};Rn.prototype.listen=function(a,b,c){this.b.push({type:a,bb:b,target:c})};var Sn=function(a,b,c){var d=a.b.findIndex(function(a){return"internal_message"==a.type&&a.bb==b&&a.target==c});-1!=d&&a.b.splice(d,1)},Tn=function(a,b){a.b.forEach(function(a){a.type==b.type&&Promise.resolve().then(function(){return a.bb.call(a.target,b)})})};var Un=function(a,b,c,d){b="["+b+"]: "+c+" "+d.responseURL+" => "+d.status+" ("+d.statusText+")";200<=d.status&&299>=d.status?a.info(b):nb(a,b)};var Vn=function(){this.name="unknown";this.state="error";this.b=null;this.allowStop=!0;this.resource=null;this.extraData={}},Wn=function(){var a=Error.call(this);this.message=a.message;"stack"in a&&(this.stack=a.stack)};n(Wn,Error);var Yn=function(a){if(void 0===b){Xn||(Xn=new te(10,2E3));var b=Xn}this.f=a;this.b=b;this.m=gb("mr.dial.Client")};
Yn.prototype.launchApp=function(a,b){var c=this;return this.b.send(Zn(this,a),"POST",b,{timeoutMillis:15E3}).then(function(a){return $n(c,"launchApp","POST",a)})};
var bo=function(a,b){return ao(a,b).then(function(c){return c.resource?c.resource:(a.m.F("stopApp: Resource path for not available for app "+b+": using fallback path."),"run")},function(){a.m.F("stopApp: getAppInfo failed: using fallback path.");return"run"}).then(function(c){return a.b.send(Zn(a,b)+"/"+c,"DELETE")}).then(function(c){return $n(a,"stopApp","DELETE",c)})},ao=function(a,b){return a.b.send(Zn(a,b),"GET",void 0,{wl:3}).then(function(c){Un(a.m,"GetAppInfo","GET",c);if(!(200<=c.status&&
299>=c.status)){if(404==c.status)throw new Wn;throw Error("Response error: "+c.status);}c=c.responseText;c=(new DOMParser).parseFromString(c,"text/xml");c=c.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length?null:c;if(!c)throw a.m.info("Invalid or empty response"),Error("Invalid or empty response");var d=c.getElementsByTagName("service");if(!d||1!=d.length)throw a.m.info("Invalid GET response (invalid service)"),Error("Invalid GET response (invalid service)");c=new Vn;for(var e=
0,f=d[0].childNodes.length;e<f;e++){var h=d[0].childNodes[e];if("state"==h.nodeName){a:switch(h.textContent){case "running":h="running";break a;case "stopped":h="stopped";break a;default:h="error"}c.state=h}else"name"==h.nodeName?c.name=h.textContent:"link"==h.localName?c.resource=h.getAttribute("href"):"options"==h.nodeName?c.allowStop="false"!=h.getAttribute("allowStop"):c.extraData[h.nodeName]=h.innerHTML}if("unknown"==c.name)throw a.m.info("GET response missing name value"),Error("GET response missing name value");
if(c.name!=b)throw a.m.info("GET app name mismatch"),Error("GET app name mismatch");if("error"==c.state)throw a.m.info("GET response missing state value"),Error("GET response missing state value");if((d=/installable=(.+)/.exec(c.state))&&d[1])c.state="installable",c.b=d[1];else if("running"!=c.state&&"stopped"!=c.state)throw a.m.info("GET response has invalid state value"),Error("GET response has invalid state value");return c})},Zn=function(a,b){a=a.f.wd;"/"!=a.charAt(a.length-1)&&(a+="/");return a+
b},$n=function(a,b,c,d){return new Promise(function(e,f){Un(a.m,b,c,d);200<=d.status&&299>=d.status?e():f(Error(d.statusText))})},Xn=null;var co=function(a,b){this.rc=a;this.appName=b};var eo=function(a){this.b=new Map;this.f=a};eo.prototype.init=function(){kj(this)};eo.prototype.clear=function(){this.b.clear()};eo.prototype.add=function(a){if(!this.b.get(a.rc.id)){this.b.set(a.rc.id,a);var b=this.f;fo(b);b.h.Cf(b,a.rc)}};var go=function(a,b){a=k(a.b);for(var c=a.next();!c.done;c=a.next())if(c=k(c.value),c.next(),c=c.next().value,c.rc.sinkId==b)return c;return null},io=function(a,b){var c=a.b.get(b);c&&(a.b.delete(b),ho(a.f,c))};
eo.prototype.fd=function(){return Array.from(this.b.values(),function(a){return a.rc})};eo.prototype.Aa=function(){return"dial.ActivityRecords"};eo.prototype.fb=function(){return[Array.from(this.b)]};eo.prototype.eb=function(){var a=hj(this);a&&(this.b=new Map(a))};var jo={lt:0,bx:1,Fv:2,kt:3},ko=function(a){Bb("MediaRouter.Dial.Create.Route",a,jo)};var lo=function(a){this.g=a;this.m=gb("mr.dial.SinkDiscoveryService");this.b=new Map;this.f={Tf:0,lg:0};this.h=0};lo.prototype.init=function(){kj(this)};
var oo=function(a,b){a.m.info("addSinks returned "+b.length+" sinks");nb(a.m,function(){return"....the list is: "+JSON.stringify(b)});var c=new Set(a.b.keys());b.forEach(function(b){var d=b.sink_id,e=b.extra_data.dial_media_sink,f=mo.test(e.model_name);b=new Hj(b.name,d);b.Yb=e.ip_address.address_bytes?e.ip_address.address_bytes.join("."):e.ip_address.address.join(".");b.wd=e.app_url.url;b.kc=e.model_name;b.fe=!f;no(a,b);c.delete(b.getId())});var d=[];c.forEach(function(c){var b=a.b.get(c);d.push(b);
a.b.delete(c)});0<d.length&&a.g.Li(d);var e=a.b.size;a.f={Tf:e,lg:e}},no=function(a,b){nb(a.m,"mayAddSink, id = "+b.getId());var c=a.b.get(b.getId());c?c.update(b)&&(nb(a.m,"Updated sink "+c.getId()),a.g.uh(c)):(nb(a.m,function(){return"Adding new sink "+b.getId()+": "+("name = "+b.lc.friendlyName+(b.Yb?", ip = "+b.Yb:"")+(b.kc?", model = "+b.kc:"")+", apps = "+JSON.stringify(b.Ub))}),a.b.set(b.getId(),b),a.g.Ki(b))};lo.prototype.ka=function(a){return this.b.get(a)||null};
var qo=function(a,b){var c=[];a.b.forEach(function(a){"available"==Ij(a,b)&&c.push(a.lc)});return new Bn(c,po[b])};lo.prototype.se=function(){return this.f};lo.prototype.Aa=function(){return"dial.DialSinkDiscoveryService"};lo.prototype.fb=function(){return[new ro(Array.from(this.b),this.f),{deviceCountMetricsRecordTime:this.h}]};
lo.prototype.eb=function(){var a=hj(this);if(a){for(var b=k(a.sinks),c=b.next();!c.done;c=b.next())c=c.value,this.b.set(c[0],Jj(c[1]));this.f=a.deviceCounts}if(a=ij(this))this.h=a.deviceCountMetricsRecordTime};
var po={YouTube:"https://tv.youtube.com https://tv-green-qa.youtube.com https://tv-release-qa.youtube.com https://web-green-qa.youtube.com https://web-release-qa.youtube.com https://www.youtube.com".split(" "),Netflix:["https://www.netflix.com"],Pandora:["https://www.pandora.com"],Radio:["https://www.pandora.com"],Hulu:["https://www.hulu.com"],Vimeo:["https://www.vimeo.com"],Dailymotion:["https://www.dailymotion.com"],"com.dailymotion":["https://www.dailymotion.com"]},mo=/Eureka Dongle|Chromecast Audio|Chromecast Ultra/i,
ro=function(a,b){this.sinks=a;this.deviceCounts=b};var so=function(a){return Promise.all(a.map(function(a){return a.then(function(a){return{Ed:!0,value:a}},function(a){return{Ed:!1,reason:a}})}))};var to=function(a,b){this.m=gb("mr.dial.AppDiscoveryService");this.b=new Set;this.f=a;this.l=b;this.j=new Map;this.o=new Map;this.g=null;this.h=!1};to.prototype.init=function(){kj(this)};to.prototype.start=function(){this.m.info("Starting periodic scanning.");this.h||(this.h=!0,uo(this))};to.prototype.stop=function(){this.m.info("Stopping periodic scanning.");this.h&&(this.h=!1,this.g&&(clearTimeout(this.g),this.g=null),this.j.clear())};
var uo=function(a){a.m.info("Start app status scan.");var b=[];Array.from(a.f.b.values()).forEach(function(c){b.push.apply(b,vo(a,c))});Array.from(a.l.b.values()).forEach(function(c){b.push(wo(a,c))});so(b).then(function(){a.h&&!a.g&&(nb(a.m,"Scan complete; scheduling for next scan."),a.g=setTimeout(function(){nb(a.m,"Start app status scan (timer-based)");a.g=null;uo(a)},6E4))})},vo=function(a,b){if(!b.fe)return[];for(var c=[],d=k(a.b),e=d.next();!e.done;e=d.next())c.push(a.A(e.value,b));return c};
to.prototype.A=function(a,b){var c=this;if("unknown"!=Ij(b,a)&&36E5>Date.now()-(b.Zg[a]||0)||!b.fe)return Promise.resolve();nb(this.m,"Querying "+b.getId()+" for "+a+" to update app status");return xo(this,b,a).then(function(d){a:if("Netflix"==d.name)d=!d.extraData||"websocket"!=d.extraData.capabilities||"running"!=d.state&&"stopped"!=d.state?"unavailable":"available";else switch(d.state){case "running":case "stopped":d="available";break a;default:d="unavailable"}yo(c,b,a,d)},function(d){d instanceof
Wn?yo(c,b,a,"unavailable"):(c.m.F("Failed to process app availability; "+b.getId()+" does not support app availability"),b.fe=!1)})};
var wo=function(a,b){var c=a.f.ka(b.rc.sinkId);if(!c)return a.m.F("Activity refers to nonexistent sink: "+b.rc.id),Promise.resolve();if(!c.fe)return Promise.resolve();var d=b.appName;nb(a.m,"Querying "+c.getId()+" for "+d+" to update activity");return xo(a,c,d).then(function(b){"running"!=b.state&&zo(a,c,d)},function(){return zo(a,c,d)})},Ao=function(a,b){var c=a.o.get(b.getId());c||(c=new Yn(b),nb(a.m,"Created DIAL client for "+b.getId()),a.o.set(b.getId(),c));return c},xo=function(a,b,c){var d=
Bo(b,c),e=a.j.get(d);if(e)return e;e=ao(Ao(a,b),c);a.j.set(d,e);b=function(){a.j.delete(d)};e.then(b,b);return e},Bo=function(a,b){return a.getId()+":"+b},yo=function(a,b,c,d){nb(a.m,"Got app status "+d+" from "+b.getId()+" for "+c);var e=Ij(b,c);b.Ub[c]=d;b.Zg[c]=Date.now();d!=e&&a.f.g.uh(b)},zo=function(a,b,c){(b=go(a.l,b.getId()))&&b.appName==c&&io(a.l,b.rc.id)},Co=function(a,b){return Array.from(a.f.b.values()).some(function(a){return"unknown"==Ij(a,b)})};to.prototype.Aa=function(){return"dial.AppDiscoveryService"};
to.prototype.fb=function(){return[Array.from(this.b)]};to.prototype.eb=function(){var a=hj(this);this.b=new Set(a||[])};var Do=function(a,b){this.appName=a;this.launchParameter=void 0===b?"":b},Go=function(a){try{var b=new URL(a)}catch(c){return Eo.info("Invalid URL: "+a),null}switch(b.protocol){case "dial:":a:if(a=b.pathname,a.match(/^\w+$/)){if(b=b.searchParams.get("postData")||void 0)try{b=wj(b)}catch(c){Eo.F("Invalid base64 encoded postData:"+b);a=null;break a}a=new Do(a,b)}else Eo.F("Invalid app name: "+a),a=null;return a;case "https:":return Fo(b);default:return nb(Eo,"Unhandled protocol: "+b.protocol),null}},
Fo=function(a){var b=a.hash;if(!b)return null;a=(a=Ho.exec(b))?a[1]:null;if(!a)return null;a=decodeURIComponent(a);if(b=(b=Io.exec(b))?b[1]:void 0)try{b=wj(b)}catch(c){return Eo.F("Invalid base64 encoded postData:"+b),null}return new Do(a,b)},Eo=gb("mr.dial.PresentationUrl"),Ho=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,Io=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var Jo=function(a,b){this.h=a;this.f=b||new lo(this);this.g=new eo(this);this.b=null;this.m=gb("mr.DialProvider")};g=Jo.prototype;g.getName=function(){return"dial"};g.se=function(){return this.f.se()};g.initialize=function(a){a=a&&0==a.enable_dial_sink_query?!1:!0;this.m.info("Dial sink query enabled: "+a+"...");this.g.init();this.f.init();a?(this.b=this.b||new to(this.f,this.g),this.b.init()):this.b=null;fo(this)};
g.fg=function(a){if(!this.b)return Cn;nb(this.m,"GetAvailableSinks for "+a);return(a=Go(a))?qo(this.f,a.appName):Cn};g.startObservingMediaSinks=function(a){if(this.b){var b=Go(a);if(b){a=this.b;b=b.appName;if(!a.b.has(b)||Co(a,b))a.b.add(b),0!=a.f.b.size&&(a.h?Array.from(a.f.b.values()).forEach(a.A.bind(a,b)):a.start());fo(this)}}};g.stopObservingMediaSinks=function(a){this.b&&(a=Go(a))&&(this.b.b.delete(a.appName),Ko(this))};g.startObservingMediaRoutes=function(){fo(this)};
g.stopObservingMediaRoutes=function(){Ko(this)};var Ko=function(a){a.b&&(0==a.f.b.size||0==a.b.b.size&&0==a.g.b.size)&&a.b.stop()},fo=function(a){a.b&&0<a.f.b.size&&(0<a.b.b.size||0<a.g.b.size)&&a.b.start()};g=Jo.prototype;g.ka=function(a){return(a=this.f.ka(a))?a.lc:null};g.fd=function(){return this.g.fd()};
g.createRoute=function(a,b,c,d){var e=this,f=this.f.ka(b);if(!f)return ko(0),Jf(Error("Unkown sink: "+b));Ej().f=new Bj(f.kc,f.Tb());var h=Go(a);if(!h)return Jf(Error("No app name set."));var l=h.appName,r=new Yn(f);return Kf(ao(r,l).then(function(a){if("running"==a.state)return bo(r,l)}).then(function(){return r.launchApp(l,h.launchParameter)}).then(function(){return Lo(e,b,a,l,c,d)}).catch(function(a){ko(3);throw a;}))};g.joinRoute=function(){return Jf(Error("Not supported"))};
g.connectRouteByRouteId=function(){return Jf(Error("Not supported"))};g.detachRoute=function(){};var Lo=function(a,b,c,d,e,f){ko(1);b=Rm(e,a.getName(),b,c,!0,d);b.offTheRecord=f;a.g.add(new co(b,d));return b};Jo.prototype.Ki=function(a){this.h.onSinkAvailabilityUpdated(this,1);this.b&&(fo(this),vo(this.b,a));this.h.Nc();Ej().b=new Bj(a.kc,a.Tb())};
Jo.prototype.Li=function(a){var b=this;if(0==this.f.b.size)this.h.onSinkAvailabilityUpdated(this,0);Ko(this);a.forEach(function(a){var c=b.g;a=a.getId();if(a=go(c,a))c.b.delete(a.rc.id),ho(c.f,a)});this.h.Nc()};Jo.prototype.uh=function(){this.h.Nc()};var ho=function(a,b){b=b.rc;if(b.isLocal)a.h.onPresentationConnectionStateChanged(b.id,"terminated");Ko(a);a.h.ng(b)};g=Jo.prototype;
g.terminateRoute=function(a){var b=this.g.b.get(a)||null;if(!b)return Promise.reject(new An(3,"Route in DIAL provider not found for routeId "+a));io(this.g,a);return(a=this.f.ka(b.rc.sinkId))?bo(new Yn(a),b.appName):Promise.reject(new An(3,"Sink in DIAL provider not found for sinkId "+b.rc.sinkId))};g.nf=function(){throw Error("Not implemented.");};g.te=function(){return null};g.zh=function(){};g.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};
g.sendRouteBinaryMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};g.Vf=function(a,b){b=this.f.ka(b);return!b||vg(a)?!1:(a=Go(a))?"available"==Ij(b,a.appName):!1};g.ff=function(){return!1};g.searchSinks=function(){return db()};g.createMediaRouteController=function(){return db()};g.provideSinks=function(a){oo(this.f,a)};var Mo=function(a){this.o=new lo(this);this.g=new Tj;this.f=a;this.l=this.j=0;this.h=new Pk;this.b=new Jo(this,this.o)};g=Mo.prototype;g.Aa=function(){return"cast.DialProviderWrapper"};g.fb=function(){return[new No(Yj(this.g),this.j,this.l,this.h.ia())]};g.eb=function(){var a=hj(this);a&&(Sj(this.g,a.f),this.j=a.sequenceNumber,this.l=a.g,Ok(this.h,a.b))};g.getName=function(){return this.b.getName()};g.initialize=function(a){this.b.initialize(a);kj(this)};g.fd=function(){return this.b.fd()};
g.fg=function(a){return(a=Oo(a))?this.b.fg(a):Cn};g.startObservingMediaSinks=function(a){(a=Oo(a))&&this.b.startObservingMediaSinks(a)};g.stopObservingMediaSinks=function(a){(a=Oo(a))&&this.b.stopObservingMediaSinks(a)};g.startObservingMediaRoutes=function(a){(a=Oo(a))&&this.b.startObservingMediaRoutes(a)};g.stopObservingMediaRoutes=function(a){(a=Oo(a))&&this.b.stopObservingMediaRoutes(a)};g.ka=function(a){return this.b.ka(a)};
var Ro=function(a,b,c,d,e){var f=Oo(b);if(!f)return Promise.reject(Error("Invalid source"));var h=Go(f),l=a.o.ka(c);if(!l)return Promise.reject(Error("Attempting custom launch with closed route"));var r=h.appName;if(!r)return Promise.reject(Error("No app name given"));var y=Po(b);return y?ao(new Yn(l),r).then(function(f){var B=Lo(a.b,c,b,r,e,d);f={routeId:B.id,sinkId:l.getId(),appName:r,nk:f,launchParameter:h.launchParameter,session:null,clientId:null};a.g.set(B.id,f);var aa=Qo(a,f.sinkId),P=new hl("receiver_action",
{receiver:aa,action:chrome.cast.Rf.CAST});P.clientId=y;a.f.Id(f.routeId,P);P=chrome.cast.T;var ha=String(a.l);a.l=(a.l+1)%9007199254740992;aa=new P(ha,"",f.appName,[],aa);f.session=aa;f.clientId=y;aa=new hl("new_session",aa);aa.clientId=y;a.f.Id(f.routeId,aa);return B}):Promise.reject(Error("No client ID"))};Mo.prototype.createRoute=function(a,b,c,d,e,f,h){return a.startsWith("cast-dial:")||So.test(a)?Kf(Ro(this,a,b,d,c)):this.b.createRoute(a,b,c,d,e,f,h)};
Mo.prototype.terminateRoute=function(a){var b=this.g.get(a);if(b&&b.session&&b.clientId){var c={receiver:Qo(this,b.sinkId),action:chrome.cast.Rf.STOP};c=new hl("receiver_action",c);c.clientId=b.clientId;this.f.Id(b.routeId,c);this.f.onPresentationConnectionStateChanged(b.routeId,"terminated")}return this.b.terminateRoute(a)};
Mo.prototype.sendRouteMessage=function(a,b,c){var d=JSON.parse(b);switch(d.type){case "client_connect":return b=d.clientId,(a=this.g.get(a))?(c=Qo(this,a.sinkId),c.receiverType=chrome.cast.Ug.DIAL,c=new hl("custom_dial_launch",new chrome.cast.Nj(c,a.nk.state,a.nk.extraData)),c.clientId=b,b=this.j,this.j=(this.j+1)%9007199254740992,c.sequenceNumber=b,this.h.add(c.sequenceNumber),this.f.Id(a.routeId,c),a=Promise.resolve()):a=Promise.reject(Error("Unknown route")),a;case "custom_dial_launch":if(this.h.contains(d.sequenceNumber))return this.h.remove(d.sequenceNumber),
b=d.message,(a=this.g.get(a))?b&&!b.doLaunch?a=Promise.resolve():(c=this.o.ka(a.sinkId))?(c=new Yn(c),d=a.launchParameter,d=(b?b.launchParameter:null)||d,a=c.launchApp(a.appName,d)):a=Promise.reject(Error("Custom launch response for sink that no longer exists")):a=Promise.reject(Error("Unknown route")),a;break;case "v2_message":if("STOP"==d.message.type)return this.terminateRoute(a),Promise.resolve()}return this.b.sendRouteMessage(a,b,c)};
Mo.prototype.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};var Qo=function(a,b){a=a.o.ka(b);b=Fj(Ej(),b);b=new chrome.cast.Qh(b,a.lc.friendlyName);b.ipAddress=a.Tb();b.receiverType=chrome.cast.Ug.DIAL;return b};g=Mo.prototype;g.nf=function(a){return this.b.nf(a)};g.te=function(a){return this.b.te(a)};g.zh=function(){};g.Vf=function(a,b){return a.startsWith("cast-dial:")||So.test(a)||this.b.Vf(a,b)};
g.ff=function(a,b,c){return this.b.ff(a,b,c)};g.connectRouteByRouteId=function(a,b,c,d,e){return this.b.connectRouteByRouteId(a,b,c,d,e)};g.joinRoute=function(a,b,c,d,e,f){return this.b.joinRoute(a,b,c,d,e,f)};g.detachRoute=function(a){this.g.remove(a);this.b.detachRoute(a)};g.Nc=function(){this.f.Nc()};g.onSinkAvailabilityUpdated=function(a,b){this.f.onSinkAvailabilityUpdated(a,b)};g.Cf=function(a,b){this.f.Cf(this,b)};g.ng=function(a){this.f.ng(a)};g.ye=function(a){this.f.ye(a)};g.Ai=function(){};
g.getMirroringServiceHostForTab=function(){};g.getMirroringServiceHostForDesktop=function(){};g.getMirroringServiceHostForOffscreenTab=function(){};g.Id=function(a,b){this.f.Id(a,b)};g.onPresentationConnectionStateChanged=function(a,b){this.f.onPresentationConnectionStateChanged(a,b)};g.onPresentationConnectionClosed=function(a,b,c){this.f.onPresentationConnectionClosed(a,b,c)};g.ui=function(a){return this.f.ui(a)};g.wi=function(){return this.f.wi()};g.ze=function(a){this.f.ze(a)};
g.yh=function(a,b){this.f.yh(a,b)};g.cj=function(a){this.f.cj(a)};g.Ki=function(a){this.b.Ki(a)};g.Li=function(a){this.b.Li(a)};g.uh=function(a){this.b.uh(a)};g.Oi=function(){};g.pl=function(){};g.searchSinks=function(a,b){return this.b.searchSinks(a,b)};g.provideSinks=function(a){this.b.provideSinks(a)};g.createMediaRouteController=function(){return db()};g.Ff=function(a,b){return this.f.Ff(a,b)};g.se=function(){return this.b.se()};
var Oo=function(a){try{var b=new URL(a)}catch(e){return null}if("dial:"==b.protocol)return a;if("cast-dial:"==b.protocol){var c=b;a="cast-dial:"!=c.protocol?null:new pl(c.pathname,c.searchParams.get("dialPostData"),c.searchParams.get("clientId"));c=a.g;var d=a.b}else if("https:"==b.protocol){a=Al(a);if(!a)return null;c=a.u;d=a.B}c?(a=d||"",c=new URL("dial:"+c),a&&c.searchParams.set("postData",a),c=c.toString()):c=null;return c},Po=function(a){try{var b=new URL(a)}catch(c){return null}return"cast-dial:"==
b.protocol?b.searchParams.get("clientId"):"https:"==b.protocol?Bl(a):null},No=function(a,b,c,d){this.f=a;this.sequenceNumber=b;this.g=c;this.b=d},So=/__dialAppName__/;var To=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,Uo=function(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}},Vo=function(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=
a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a},Wo=/#|$/,Xo=function(a,b){var c=a.search(Wo);a:{var d=0;for(var e=b.length;0<=(d=a.indexOf(b,d))&&d<c;){var f=a.charCodeAt(d-1);if(38==f||63==f)if(f=a.charCodeAt(d+e),!f||61==f||38==f||35==f)break a;d+=e+1}d=-1}if(0>d)return null;e=a.indexOf("&",d);if(0>e||e>c)e=c;d+=b.length+1;return decodeURIComponent(a.substr(d,e-d).replace(/\+/g," "))},Yo=function(a,b){var c=a.length-1;0<=c&&
a.indexOf("/",c)==c&&(a=a.substr(0,a.length-1));oc(b,"/")&&(b=b.substr(1));return Cc(a,"/",b)};var Zo=function(a){this.ec=this.l=this.g="";this.Ga=null;this.h=this.b="";this.j=!1;var b;a instanceof Zo?(this.j=Ia(void 0)?void 0:a.j,$o(this,a.g),this.l=a.l,this.ec=a.ec,ap(this,a.wb()),this.b=a.b,bp(this,a.f.clone()),this.h=a.h):a&&(b=String(a).match(To))?(this.j=!1,$o(this,b[1]||"",!0),this.l=cp(b[2]||""),this.ec=cp(b[3]||"",!0),ap(this,b[4]),this.b=cp(b[5]||"",!0),bp(this,b[6]||"",!0),this.h=cp(b[7]||"")):(this.j=!1,this.f=new dp(null,this.j))};
Zo.prototype.toString=function(){var a=[],b=this.g;b&&a.push(ep(b,fp,!0),":");var c=this.ec;if(c||"file"==b)a.push("//"),(b=this.l)&&a.push(ep(b,fp,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.wb(),null!=c&&a.push(":",String(c));if(c=this.b)this.ec&&"/"!=c.charAt(0)&&a.push("/"),a.push(ep(c,"/"==c.charAt(0)?gp:hp,!0));(c=this.f.toString())&&a.push("?",c);(c=this.h)&&a.push("#",ep(c,ip));return a.join("")};
Zo.prototype.resolve=function(a){var b=this.clone(),c=!!a.g;c?$o(b,a.g):c=!!a.l;c?b.l=a.l:c=!!a.ec;c?b.ec=a.ec:c=null!=a.Ga;var d=a.b;if(c)ap(b,a.wb());else if(c=!!a.b){if("/"!=d.charAt(0))if(this.ec&&!this.b)d="/"+d;else{var e=b.b.lastIndexOf("/");-1!=e&&(d=b.b.substr(0,e+1)+d)}e=d;if(".."==e||"."==e)d="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){d=oc(e,"/");e=e.split("/");for(var f=[],h=0;h<e.length;){var l=e[h++];"."==l?d&&h==e.length&&f.push(""):".."==l?((1<f.length||1==f.length&&""!=
f[0])&&f.pop(),d&&h==e.length&&f.push("")):(f.push(l),d=!0)}d=f.join("/")}else d=e}c?b.b=d:c=""!==a.f.toString();c?bp(b,a.f.clone()):c=!!a.h;c&&(b.h=a.h);return b};Zo.prototype.clone=function(){return new Zo(this)};var $o=function(a,b,c){a.g=c?cp(b,!0):b;a.g&&(a.g=a.g.replace(/:$/,""))};Zo.prototype.wb=function(){return this.Ga};
var ap=function(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Ga=b}else a.Ga=null},bp=function(a,b,c){b instanceof dp?(a.f=b,jp(a.f,a.j)):(c||(b=ep(b,kp)),a.f=new dp(b,a.j))},cp=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},ep=function(a,b,c){return Ja(a)?(a=encodeURI(a).replace(b,lp),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},lp=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},
fp=/[#\/\?@]/g,hp=/[#\?:]/g,gp=/[#\?]/g,kp=/[#\?@]/g,ip=/#/g,dp=function(a,b){this.f=this.b=null;this.g=a||null;this.h=!!b},mp=function(a){a.b||(a.b=new Tj,a.f=0,a.g&&Uo(a.g,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))},op=function(a){var b=Jk(a);if("undefined"==typeof b)throw Error("Keys are undefined");var c=new dp(null,void 0);a=Ik(a);for(var d=0;d<b.length;d++){var e=b[d],f=a[d];Ua(f)?np(c,e,f):c.add(e,f)}return c};g=dp.prototype;g.sa=function(){mp(this);return this.f};
g.add=function(a,b){mp(this);this.g=null;a=pp(this,a);var c=this.b.get(a);c||this.b.set(a,c=[]);c.push(b);this.f+=1;return this};g.remove=function(a){mp(this);a=pp(this,a);return Wj(this.b,a)?(this.g=null,this.f-=this.b.get(a).length,this.b.remove(a)):!1};g.clear=function(){this.b=this.g=null;this.f=0};g.Eb=function(){mp(this);return 0==this.f};var qp=function(a,b){mp(a);b=pp(a,b);return Wj(a.b,b)};g=dp.prototype;g.hf=function(a){var b=this.ia();return Tb(b,a)};
g.forEach=function(a,b){mp(this);this.b.forEach(function(c,d){w(c,function(c){a.call(b,c,d,this)},this)},this)};g.sb=function(){mp(this);for(var a=this.b.ia(),b=this.b.sb(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};g.ia=function(a){mp(this);var b=[];if(Ja(a))qp(this,a)&&(b=cc(b,this.b.get(pp(this,a))));else{a=this.b.ia();for(var c=0;c<a.length;c++)b=cc(b,a[c])}return b};
g.set=function(a,b){mp(this);this.g=null;a=pp(this,a);qp(this,a)&&(this.f-=this.b.get(a).length);this.b.set(a,[b]);this.f+=1;return this};g.get=function(a,b){if(!a)return b;a=this.ia(a);return 0<a.length?String(a[0]):b};var np=function(a,b,c){a.remove(b);0<c.length&&(a.g=null,a.b.set(pp(a,b),x(c)),a.f+=c.length)};
dp.prototype.toString=function(){if(this.g)return this.g;if(!this.b)return"";for(var a=[],b=this.b.sb(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.ia(d);for(var f=0;f<d.length;f++){var h=e;""!==d[f]&&(h+="="+encodeURIComponent(String(d[f])));a.push(h)}}return this.g=a.join("&")};dp.prototype.clone=function(){var a=new dp;a.g=this.g;this.b&&(a.b=this.b.clone(),a.f=this.f);return a};
var pp=function(a,b){b=String(b);a.h&&(b=b.toLowerCase());return b},jp=function(a,b){b&&!a.h&&(mp(a),a.g=null,a.b.forEach(function(a,b){var c=b.toLowerCase();b!=c&&(this.remove(b),np(this,c,a))},a));a.h=b};dp.prototype.extend=function(a){for(var b=0;b<arguments.length;b++)Lk(arguments[b],function(a,b){this.add(b,a)},this)};var rp=function(a,b){this.input=a;this.domain=b};var sp=function(a){this.b=a;this.m=gb("mr.ExternalMessageHandler")};
sp.prototype.onMessage=function(a,b,c){var d=this;this.m.info("Received a message from "+b.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,this.b.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new rp(a.meetingName,a.domain)).then(function(a){var f="PresentationId"+b.id+tp++;d.b.createRoute("urn:x-org.chromium.media:source:desktop",a,f).then(function(a){c(new Ce(e,"route",a.id))}).catch(function(a){c(new Ce(e,"error",a))})},function(){c(new Ce(e,"error",
Error("Failed to find sink.")))})):"stop"==a.type?this.b.terminateRoute(a.message.routeId).then(function(){c(new Ce(e,"stopped"))}):"subscribe_log_data"==a.type?(ib.push(function(a){chrome.runtime.sendMessage(b.id,new Ce(e,"log_message",a))}),c(new Ce(e,"subscribed"))):(c(new Ce(e,"error",Error("Unhandled message type"))),this.m.error("Unhandled message type "+a.type))};var tp=0;var up=function(){this.b=[];this.f=[]};g=up.prototype;g.enqueue=function(a){if(1E3<=this.sa()){if(this.Eb())throw Error("Empty queue");0==this.b.length&&(this.b=this.f,this.b.reverse(),this.f=[]);this.b.pop()}this.f.push(a)};g.sa=function(){return this.b.length+this.f.length};g.Eb=function(){return 0==this.sa()};g.ia=function(){var a=this.b.slice();a.reverse();a.push.apply(a,m(this.f));return a};g.clear=function(){this.b=[];this.f=[]};var vp=function(){this.b=new up;this.f=Date.now()},xp=function(){null==wp&&(wp=new vp);return wp};vp.prototype.init=function(){hb=1;var a=gb("browser"),b=window.onerror;window.onerror=function(c,e,f,h,l){b&&b(c,e,f,h,l);a.error("Error: "+c+" ("+e+" @ Line: "+f+")",l)};ib.push(this.h.bind(this));var c=window.localStorage["debug.logs"];c&&(hb=pb(c.toUpperCase()));(c=window.localStorage["debug.console"])&&"false"!=c.toLowerCase()&&ib.push(this.g.bind(this))};
vp.prototype.h=function(a){this.b.enqueue(yp(this,a,!1));a=a.pc;a instanceof Error&&a.stack&&this.b.enqueue(a.stack)};vp.prototype.g=function(a){var b=[yp(this,a,!0)];a.pc&&b.push(a.pc);switch(a.level){case 3:console.error.apply(console,m(b));break;case 2:console.warn.apply(console,m(b));break;case 1:console.log.apply(console,m(b));break;default:console.debug.apply(console,m(b))}};
var yp=function(a,b,c){var d=["["];if(c)d.push(("       "+((Date.now()-a.f)/1E3).toFixed(3)).slice(-7));else{a=new Date(b.time);var e=function(a){return 10>a?"0"+a:a};d.push(a.getFullYear().toString(),"-",e(a.getMonth()+1),"-",e(a.getDate())," ",e(a.getHours()),":",e(a.getMinutes()),":",e(a.getSeconds()),".",e(Math.floor(a.getMilliseconds()/10)))}d.push("][",ob[b.level],"][",b.L,"] ",b.message);if(!c&&null!=b.pc)if(d.push("\n"),b.pc instanceof Error)d.push(b.pc.message);else try{d.push(JSON.stringify(b.pc))}catch(f){d.push(b.pc.toString())}d.push("\n");
return d.join("")},zp=function(){var a=xp();return 0==a.b.sa()?"NA":a.b.ia().join("")},Ap=function(){var a=xp();kj(a)};vp.prototype.Aa=function(){return"LogManager"};vp.prototype.fb=function(){return[this.b.ia()]};vp.prototype.eb=function(){var a=this.b.ia();this.b.clear();for(var b=k(hj(this)||[]),c=b.next();!c.done;c=b.next())this.b.enqueue(c.value);a=k(a);for(c=a.next();!c.done;c=a.next())this.b.enqueue(c.value)};var wp=null;var Bp=function(a){this.b=a;this.m=gb("mr.InternalMessageHandler")};
Bp.prototype.onMessage=function(a,b,c){var d=this;if("retrieve_log_data"!=a.type)c(new Ce(chrome.runtime.id,"error",Error("Unhandled message type")));else{var e={logs:zp(),device:Gj()};b=[];var f=Be(e.device.ip).then(function(a){a.b&&(e.device.version=a.b)});b.push(f);var h=this.b.u;h&&(a=Cp(this,h,a.source).then(function(a){a&&(e.castStreamingLogs=a)},function(){d.m.error("Log upload failed for service: "+h)}),b.push(a));e.dialDeviceCounts=Dp(this);b.push(Ep(this,e));a=this.b.getMediaSinkServiceStatus().then(function(a){e.mediaSinkServiceStatus=
a.status},function(){d.m.error("Fail to get media sink service status")});b.push(a);e.dialogType=this.b.N;so(b).then(function(){c(e)})}};var Ep=function(a,b){return hg("mr.cast.SinkDiscoveryService").then(function(a){a=a.se();b.castDeviceCounts=a.lg+"."+a.Tf},function(){a.m.error("Failed to get device counts for castDeviceCounts.")})},Dp=function(a){a=Fp(a.b,"dial");if(!a)return"";a=a.se();return a.lg+"."+a.Tf},Cp=function(a,b,c){return Gp(a.b,b).then(function(a){return a.Yi(c)})};var Hp={ACCEPTED:0,Ys:1,TIMEOUT:2},Ip={SUCCESS:0,qt:1},Jp={Un:0,tn:1,my:2,Qt:3,Pt:4,cv:5,TIMEOUT:6,sw:7},Kp={Nt:0,Ex:1},Lp={Vv:0,Ju:1,USER:2,It:3},Mp=function(a){Bb("MediaRouter.Cloud.Knock.Result",a,Hp)},Np=function(a){Bb("MediaRouter.Cloud.Session.Start",a,Ip)},Op=function(a){Bb("MediaRouter.Cloud.Session.Type",a,Kp)},Pp=function(a){Bb("MediaRouter.Cloud.Device.UserRole",a,Lp)};var Qp=function(a,b){this.b=a;this.f=b},Rp=new Qp("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Sp=new Qp("https://castedumessaging-pa.googleapis.com/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Tp=new Qp("https://www.googleapis.com/calendar/v3",""),Up=new Qp("https://www.googleapis.com/hangouts/v1",""),Vp=new Qp("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var Wp=function(a,b,c,d,e,f){c=void 0===c?null:c;a||null==c&&(c="default");this.kl=a;this.Ka=b;this.ec=c;this.yf=void 0===d?null:d;this.Gc=void 0===e?null:e;this.Ge=void 0===f?null:f};Wp.prototype.f=function(){var a="";this.Gc?a=this.Gc:this.yf&&(a=this.yf);return a};Wp.prototype.kd=function(){return this.kl};Wp.prototype.getId=function(){return this.Ka};Wp.prototype.merge=function(a){!this.Ge&&a.Ge&&(this.Ge=a.Ge);!this.Gc&&a.Gc&&(this.Gc=a.Gc);this.Gc&&a.Gc&&this.Ge&&(this.Gc=a.Gc)};var Xp=function(a,b){this.f=a;this.g=b;this.m=gb("mr.cloud.calendar.CalendarService")},aq=function(a){return Yp(a,a.g.b).then(function(b){a.m.info(Zp(b.length)+" events discovered before filtering.");return $p(a,b)},function(b){a.m.F("Error getting Hangouts from calendar.",b);return[]})},Zp=function(a){return 20<a?"20+":a.toString()},Yp=function(a,b){var c=Date.now();return bq(a,b,new Date(c),new Date(c+9E5)).then(function(c){return c.filter(a.b)})};
Xp.prototype.b=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};
var bq=function(a,b,c,d){b=cq(Tp.b,["calendars",b,"events"],{timeMin:c.toJSON(),timeMax:d.toJSON(),singleEvents:!0});nb(a.m,"Retrieving Hangouts from Calendar: "+b);return dq(a.f,b,"GET").then(function(a){return a.items?a.items:[]})},$p=function(a,b){var c=[];b.filter(function(a){return a.hangoutLink}).forEach(function(b){var d=new Zo(b.hangoutLink);if("meet.google.com"==d.ec)c.push(new Wp(!0,d.b.substring(1),void 0,void 0,b.summary));else if(d=d.b.substring(12).split("/"),2==d.length){var f=k(d);
d=f.next().value;f=f.next().value;if(-1!=d.indexOf(".")){var h=f;var l=d}c.push(new Wp(!1,f+"@"+d,l,h,b.summary,void 0))}else a.m.F("Invalid hangout link from calendar event: "+b.hangoutLink)});a.m.info(Zp(c.length)+" events discovered with Hangout links.");return c};var eq=function(a){this.b=a;this.id=a.id;this.m=gb("mr.cloud.devices.WeaveDevice")};eq.prototype.isAvailable=function(){if(this.getState().appStatus){var a="online"==this.b.connectionStatus,b="available"==this.getState().appStatus,c=fq(this,864E5);nb(this.m,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}a=fq(this,9E5);this.m.info("Availability for legacy receiver app: "+a);return a};
var fq=function(a,b){a=a.b.lastUpdateTimeMs?Number(a.b.lastUpdateTimeMs):null;return!!(a&&a>Date.now()-b)};eq.prototype.f=function(){return this.getState().settings.receiverName};eq.prototype.getId=function(){return this.id};eq.prototype.getState=function(){return this.b.state._cloudCast};var gq=function(a){var b=[],c=[],d={},e=function(a,h){var f=h+"  ";try{if(Ia(a))if(null===a)b.push("NULL");else if(Ja(a))b.push('"'+a.replace(/\n/g,"\n"+h)+'"');else if(Wa(a))b.push(String(a).replace(/\n/g,"\n"+h));else if(Xa(a)){a[Ya]||c.push(a);var r=a[Ya]||(a[Ya]=++$a);if(d[r])b.push("*** reference loop detected (id="+r+") ***");else{d[r]=!0;b.push("{");for(var y in a)Wa(a[y])||(b.push("\n"),b.push(f),b.push(y+" = "),e(a[y],f));b.push("\n"+h+"}");delete d[r]}}else b.push(a);else b.push("undefined")}catch(B){b.push("*** "+
B+" ***")}};e(a,"");for(a=0;a<c.length;a++)Za(c[a]);return b.join("")},hq=function(a){var b=hq;var c=Error();if(Error.captureStackTrace)Error.captureStackTrace(c,b),b=String(c.stack);else{try{throw c;}catch(e){c=e}b=(b=c.stack)?String(b):null}if(b)return b;b=[];c=arguments.callee.caller;for(var d=0;c&&(!a||d<a);){b.push(iq(c));b.push("()\n");try{c=c.caller}catch(e){b.push("[exception trying to get caller]\n");break}d++;if(50<=d){b.push("[...long stack...]");break}}a&&d>=a?b.push("[...reached max depth limit...]"):
b.push("[end]");return b.join("")},iq=function(a){if(jq[a])return jq[a];a=String(a);if(!jq[a]){var b=/function\s+([^\(]+)/m.exec(a);jq[a]=b?b[1]:"[Anonymous]"}return jq[a]},jq={},kq=Object.freeze||function(a){return a};var lq=function(a,b,c){this.reset(a,b,c,void 0,void 0)};lq.prototype.b=null;var mq=0;lq.prototype.reset=function(a,b,c,d,e){"number"==typeof e||mq++;this.j=d||t();this.f=a;this.h=b;this.g=c;delete this.b};lq.prototype.getMessage=function(){return this.h};var nq=function(a){this.j=a;this.b=this.h=this.f=this.g=null},oq=function(a,b){this.name=a;this.value=b};oq.prototype.toString=function(){return this.name};var pq=new oq("SEVERE",1E3),qq=new oq("WARNING",900),rq=new oq("INFO",800),sq=new oq("CONFIG",700),tq=new oq("FINE",500),uq=new oq("FINER",400),vq=new oq("ALL",0);nq.prototype.getName=function(){return this.j};nq.prototype.getChildren=function(){this.h||(this.h={});return this.h};
var wq=function(a){if(a.f)return a.f;if(a.g)return wq(a.g);Gb("Root logger has no level set.");return null};g=nq.prototype;g.log=function(a,b,c){a.value>=wq(this).value&&(Wa(b)&&(b=b()),a=new lq(a,String(b),this.j),c&&(a.b=c),xq(this,a))};g.F=function(a,b){this.log(qq,a,b)};g.info=function(a,b){this.log(rq,a,b)};g.config=function(a,b){this.log(sq,a,b)};g.logRecord=function(a){a.f.value>=wq(this).value&&xq(this,a)};
var xq=function(a,b){for(;a;){var c,d=a,e=b;if(d.b)for(var f=0;c=d.b[f];f++)c(e);a=a.g}},yq={},zq=null,Aq=function(){zq||(zq=new nq(""),yq[""]=zq,zq.f=sq)},Bq=function(a){Aq();var b;if(!(b=yq[a])){b=new nq(a);var c=a.lastIndexOf("."),d=a.substr(c+1);c=Bq(a.substr(0,c));c.getChildren()[d]=b;b.g=c;yq[a]=b}return b};var Cq=function(a,b,c,d){a&&a.log(b,c,d)},Dq=function(a,b,c){a&&a.log(pq,b,c)},V=function(a,b,c){a&&a.F(b,c)},W=function(a,b){a&&a.info(b,void 0)},Eq=function(a,b){a&&a.log(tq,b,void 0)};var Fq=function(){this.m=Bq("mr.cloud.GcmRegistrationSerializer");this.b=Promise.resolve("")};Fq.prototype.register=function(a){var b=this,c=function(){return new Promise(function(c,e){chrome.gcm.register(a,function(a){a?(b.m.info("Got GCM registration ID: "+a),c(a)):e(Error(chrome.runtime.lastError&&chrome.runtime.lastError.message||"unknown error"))})})};return this.b=this.b.then(c,c)};var Gq=function(a){this.email=a;this.imageUrl=null},Hq=function(a){this.type=a},Iq=function(a,b,c,d){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=b||null;this.flungUrl=c||null;this.presentationId=d||null};n(Iq,Hq);
var Jq=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},Kq={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},Lq=new Jq("_knockingStartWebrtcSession",Kq,"viewer"),Mq=new Jq("_startWebrtcSession",Kq),Nq=new Jq("_stopSession",{},"viewer");var Oq=function(a,b){this.j=a;this.l=b;this.f=this.g=this.b=null;this.h=!1;this.m=gb("mr.cloud.devices.WeaveDevicesService");kj(this)};Oq.prototype.getDevice=function(a){a=cq(Rp.b,["devices",a]);return dq(this.j,a,"GET").then(function(a){return new eq(a)})};
var Pq=function(a,b){var c=cq(Rp.b,["devices"],b);return dq(a.j,c,"GET").then(function(c){var d=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new eq(a)});if(c=c.nextPageToken){var f=Wc(b);f.token=c;return Pq(a,f).then(function(a){return d.concat(a)})}return d})};Oq.prototype.Aa=function(){return"WeaveDevicesService"};Oq.prototype.fb=function(){return[new Qq(this.b,this.f,this.g)]};
Oq.prototype.eb=function(){var a=hj(this);a&&(this.b=a.rp,this.f=a.gcmRegistrationId,this.g=a.qp)};
var Rq=function(a){return a.f&&null!=a.g&&a.g+864E5>=Date.now()?Promise.resolve(a.f):a.l.register(["919648714761"]).then(function(b){nb(a.m,"Got GCM ID: "+b);a.f=b;a.g=Date.now();a.b=null;return b},function(b){a.m.F("Error",b);a.f=null;a.g=null;a.b=null;throw b;})},Sq=function(a,b){if(a.h)Promise.resolve();else if(a.h=!0,b&&(!a.b||a.b+864E5<Date.now())){b={filters:["myDevices"],gcmRegistrationId:b,gcmSenderId:"919648714761",expirationTimeMs:864E5};var c=cq(Rp.b,["subscriptions","subscribe"],{});dq(a.j,
c,"POST",b).then(function(){nb(a.m,"Subscribed on: "+Date.now());a.b=Date.now();a.h=!1;return Promise.resolve()},function(c){a.h=!1;throw c;})}else Promise.resolve()},Qq=function(a,b,c){this.rp=a;this.gcmRegistrationId=b;this.qp=c};var Tq=function(a,b,c,d,e,f,h,l){var r=Fj(Ej(),a);this.jb=new dj(r,b,h,l,e);this.deviceId=a;this.b=c;this.model=d;this.isAvailable=f};da.Object.defineProperties(Tq.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.jb.id}},displayName:{configurable:!0,enumerable:!0,set:function(a){this.jb.friendlyName=a}}});var Uq=function(a,b,c,d,e){Tq.call(this,a,b,"weave","Chrome Streaming Receiver",d,e,"education");this.di=c};n(Uq,Tq);
var Vq=function(a){var b=a.ec,c;a.yf&&a.f()!=a.yf&&(c=a.yf);Tq.call(this,a.getId(),a.f(),"mesi","Hangout",b,!1,a.kd()?"meeting":"hangout",c);this.kd=a.kd();this.Gg=a.Ge||""};n(Vq,Tq);var Wq=function(a,b,c){Tq.call(this,a,b,"slarti","Cast Receiver for Education","default",c,"education")};n(Wq,Tq);var Xq=function(a,b,c){this.l=a;this.h=b;this.b=new Map;this.g=new Map;this.f=null;this.j=c};Xq.prototype.Jd=function(){var a=this.f+this.j;if(null==this.f||a<Date.now())this.f=Date.now(),Yq(this);return Array.from(this.b.values())};Xq.prototype.ka=function(a){return this.b.get(a)||null};
var Yq=function(a){a.l().then(function(b){Zq(a,b)})},Zq=function(a,b){var c=new Map(a.b),d=new Map,e=new Map,f=[],h=[];b.forEach(function(a){var b=a.id;d.set(b,a);e.set(b,a.deviceId);c.has(b)?c.has(b)&&JSON.stringify(c.get(b))!=JSON.stringify(a)&&h.push(a.jb):f.push(a.jb);c.delete(b)});b=[].concat(m(c.values())).map(function(a){return a.jb});a.g.clear();a.g=e;a.b.clear();a.b=d;$q(a,f,h,b)},$q=function(a,b,c,d){0<b.length&&ar(a.h,b);0<c.length&&br(a.h,c);0<d.length&&cr(a.h,d)},er=function(a){for(var b=
{},c=k(a.b.entries()),d=c.next();!d.done;d=c.next()){var e=k(d.value);d=e.next().value;e=e.next().value;b[d]=e}c={};d=k(a.g.entries());for(e=d.next();!e.done;e=d.next()){var f=k(e.value);e=f.next().value;f=f.next().value;c[e]=f}return new dr(b,c,a.f)},fr=function(a,b){for(var c in b.sinks){var d=b.sinks[c],e=null;"Hangout"==d.model?e=new Vq(new Wp(d.kd,d.deviceId,d.jb.domain,d.jb.description,d.jb.friendlyName,d.Gg)):"Cast Receiver for Education"==d.model?e=new Wq(d.deviceId,d.jb.friendlyName,d.isAvailable):
"Chrome Streaming Receiver"==d.model&&(e=new Uq(d.deviceId,d.jb.friendlyName,d.di,d.jb.domain,d.isAvailable));a.b.set(c,e)}for(c in b.b)a.g.set(c,b.b[c]);b.f&&(a.f=b.f)},dr=function(a,b,c){this.sinks=a;this.b=b;this.f=c};var ir=function(a,b,c){if(!gr){Aq();var d=zq;d.f=vq;var e=hr;d.b||(d.b=[]);d.b.push(e);gr=!0}this.g=a;this.h=b;this.b=new Xq(this.j.bind(this),c,2E4);this.f=new Map;kj(this)},hr=function(a){jb({L:a.g,level:qb(a.f.value),time:a.j,message:a.getMessage(),pc:a.b})};ir.prototype.Jd=function(){return this.b.Jd()};ir.prototype.ka=function(a){return this.b.ka(a)};
ir.prototype.j=function(){var a=this;this.m.info("Fetching hangouts");return so([jr(this.h),aq(this.g)]).then(function(b){var c=Array.from(a.f.values());b.forEach(function(b){b.Ed?c=c.concat(b.value):a.m.error("Error discovering Hangouts",b.reason)});var d=c.reduce(function(a,c){var b=a[c.getId()];b?b.merge(c):b=c;a[b.getId()]=b;return a},{});return Object.keys(d).map(function(a){a=d[a];Ab("MediaRouter.Cloud.Hangout.Sink.Discovered");return new Vq(a)})})};
var lr=function(a,b){return hg("mr.mirror.hangouts.MeetingsService").then(function(a){return a.fc(b)}).then(function(c){return kr(a,c)},function(){return b.input.match(/^#/)?Promise.reject(Error("Failed to resolve meeting alias.")):kr(a,b.input,b.domain)})},kr=function(a,b,c){c=c||void 0;var d=!c;b=new Wp(d,d?b:b+"@"+c,c,b,void 0,void 0);a.f.set(b.getId(),b);b=new Vq(b);a.b.b.set(b.id,b);return b.jb};ir.prototype.Aa=function(){return"HangoutSinkDiscoveryService"};
ir.prototype.fb=function(){for(var a={},b=k(this.f.entries()),c=b.next();!c.done;c=b.next()){var d=k(c.value);c=d.next().value;d=d.next().value;a[c]=d}return[{cache:er(this.b),manualHangouts:a}]};ir.prototype.eb=function(){var a=hj(this);if(a){fr(this.b,a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.f.set(b,new Wp(c.kl,c.Ka,c.ec,c.yf,c.Gc,c.Ge))}}};ir.prototype.m=gb("mr.cloud.discovery.HangoutSinkDiscoveryService");var gr=!1;var pr=function(){this.f=!1;this.b=null;this.g=!1;this.m=gb("mr.cloud.identity.IdentityService");kj(this);nr(this);or(this)},qr=function(a){return a.b?a.b.substr(a.b.indexOf("@")+1):""};pr.prototype.getAuthToken=function(){return chrome.identity?new Promise(function(a,b){chrome.identity.getAuthToken({interactive:!1},function(c){chrome.runtime.lastError?b(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==c?b(Error("User is not logged in (no token found)")):a(c)})}):Promise.reject(Error("chrome.identity permission required for auth."))};
var rr=function(a){return new Promise(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})},or=function(a){a.getAuthToken().then(function(b){chrome.identity.getProfileUserInfo(function(c){a.f=!!c.email||!!c.id;a.b=c.email||null;b&&!a.f&&(a.g=!0)})},function(b){nb(a.m,"Unable to set sign in and email.",b)})},nr=function(a){chrome.identity.onSignInChanged.addListener(function(b,c){rg(6);a.f=c;a.m.info("Signed in change: "+a.f);a.f?or(a):(a.b=null,a.g=!1)})},sr=function(a){return a.getAuthToken().then(function(b){var c=
window.gapi;if(!c)return a.m.error("gapi not loaded."),!1;a.m.info("Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};pr.prototype.Aa=function(){return"IdentityService"};pr.prototype.fb=function(){return[null,{signedIn:this.f,userEmail:this.b,kioskAuth:this.g}]};pr.prototype.eb=function(){var a=ij(this);a&&(a.signedIn&&(this.f=a.signedIn),a.userEmail&&(this.b=a.userEmail),a.kioskAuth&&(this.g=a.kioskAuth))};var tr="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var ur=function(a){var b=a.method,c=a.uri,d=a.Vb,e=a.sc,f=a.Nl,h=a.headers,l=a.body,r=a.start,y=a.apiKey,B=a.Kg;a=a.cb;this.method=b&&b.toUpperCase()||"GET";(b=c)||(d=[d].concat(m(e||[])).join("/"),d=new Zo(encodeURI(d)),f&&(f=op(f),bp(d,f)),b=d);this.uri=b;y&&this.uri.f.add("key",y);this.b=a||null;this.headers=h||{};(this.body=l)&&(this.headers["Content-Type"]="application/json");this.Kg=Ia(B)?B:1E4;this.start=r||t()},vr=function(a){return(a.b?a.b.getAuthToken():Promise.resolve(null)).then(function(b){b&&
(a.headers.Authorization="Bearer "+b);b={method:a.method,headers:a.headers};a.body&&(b.body=JSON.stringify(a.body));return new Request(a.uri.toString(),b)})};var wr={Ps:100,Ix:101,Rv:200,Qs:201,ACCEPTED:202,uv:203,Iv:204,Mw:205,bw:206,iv:207,hv:300,ev:301,xt:302,jx:303,Ev:304,gy:305,Lx:307,Cm:400,Tx:401,dn:402,wt:403,Av:404,Zu:405,xv:406,ww:407,Kw:408,Ls:409,Gt:410,Fu:411,pw:412,Hw:413,Lw:414,ay:415,Jw:416,it:417,Zx:422,Iu:423,jt:424,qw:428,Ox:429,Iw:431,Sm:500,Bv:501,Vr:502,qx:503,Bt:504,Wt:505,iu:507,ov:511,zw:1223};var xr=function(a,b){Db.call(this,b&&b.message||a.statusText);this.code=a.status;this.response=a;this.status=(this.b=b)&&b.status};n(xr,Db);var Br=function(a){if(yr.has(a.code))return!0;var b=a.b||{};return a.b?zr.has(b.status)?!0:!!(b.errors||[]).find(function(a){return Ar.has(a)}):!1},Cr=function(a,b){a=new Response(void 0,{status:b||408,statusText:a});return new xr(a)},yr=new Set([400,401,403,404,405,406,501]),zr=new Set(["PERMISSION_DENIED"]),Ar=new Set("authError command_is_in_terminal_state forbidden notFound unmanaged_group_acl acl_entry_bad_scope network_error".split(" "));var Dr=function(){this.zb=this.zb;this.Ca=this.Ca};Dr.prototype.zb=!1;Dr.prototype.A=function(){return this.zb};Dr.prototype.Ua=function(){this.zb||(this.zb=!0,this.ba())};Dr.prototype.f=function(a){Er(this,cb(Fr,a))};var Er=function(a,b){a.zb?Ia(void 0)?b.call(void 0):b():(a.Ca||(a.Ca=[]),a.Ca.push(Ia(void 0)?q(b,void 0):b))};Dr.prototype.ba=function(){if(this.Ca)for(;this.Ca.length;)this.Ca.shift()()};
var Fr=function(a){a&&"function"==typeof a.Ua&&a.Ua()},Gr=function(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];Va(d)?Gr.apply(null,d):Fr(d)}};var X=function(a,b){this.type=a;this.f=this.target=b;this.Xl=!0};X.prototype.h=function(){this.Xl=!1};var Hr=!kd||9<=Number(Gd),Ir=kd&&!Fd("9"),Jr=function(){if(!Ha.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{Ha.addEventListener("test",Qa,b),Ha.removeEventListener("test",Qa,b)}catch(c){}return a}();var Kr=function(a,b){X.call(this,a?a.type:"");this.relatedTarget=this.f=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.b=null;a&&this.init(a,b)};v(Kr,X);var Lr=kq({2:"touch",3:"pen",4:"mouse"});
Kr.prototype.init=function(a,b){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.f=b;(b=a.relatedTarget)?nd&&(fd(b,"nodeName")||(b=null)):"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:
a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=Ja(a.pointerType)?a.pointerType:Lr[a.pointerType]||"";this.state=a.state;this.b=a;a.defaultPrevented&&this.h()};
Kr.prototype.h=function(){Kr.ua.h.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Ir)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Mr="closure_listenable_"+(1E6*Math.random()|0),Nr=function(a){return!(!a||!a[Mr])},Or=0;var Pr=function(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.bb=e;this.key=++Or;this.removed=this.ah=!1},Qr=function(a){a.removed=!0;a.listener=null;a.proxy=null;a.src=null;a.bb=null};var Rr=function(a){this.src=a;this.b={};this.f=0};Rr.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.b[f];a||(a=this.b[f]=[],this.f++);var h=Sr(a,b,d,e);-1<h?(b=a[h],c||(b.ah=!1)):(b=new Pr(b,this.src,f,!!d,e),b.ah=c,a.push(b));return b};Rr.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.b))return!1;var e=this.b[a];b=Sr(e,b,c,d);return-1<b?(Qr(e[b]),Zb(e,b),0==e.length&&(delete this.b[a],this.f--),!0):!1};
var Tr=function(a,b){var c=b.type;if(!(c in a.b))return!1;var d=$b(a.b[c],b);d&&(Qr(b),0==a.b[c].length&&(delete a.b[c],a.f--));return d};Rr.prototype.removeAll=function(a){a=a&&a.toString();var b=0,c;for(c in this.b)if(!a||c==a){for(var d=this.b[c],e=0;e<d.length;e++)++b,Qr(d[e]);delete this.b[c];this.f--}return b};var Ur=function(a,b,c,d,e){a=a.b[b.toString()];b=-1;a&&(b=Sr(a,c,d,e));return-1<b?a[b]:null};
Rr.prototype.hasListener=function(a,b){var c=Ia(a),d=c?a.toString():"",e=Ia(b);return Nc(this.b,function(a){for(var f=0;f<a.length;++f)if(!(c&&a[f].type!=d||e&&a[f].capture!=b))return!0;return!1})};var Sr=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==b&&f.capture==!!c&&f.bb==d)return e}return-1};var Vr="closure_lm_"+(1E6*Math.random()|0),Wr={},Xr=0,Zr=function(a,b,c,d,e){if(d&&d.once)return Yr(a,b,c,d,e);if(Ua(b)){for(var f=0;f<b.length;f++)Zr(a,b[f],c,d,e);return null}c=$r(c);return Nr(a)?a.listen(b,c,Xa(d)?!!d.capture:!!d,e):as(a,b,c,!1,d,e)},as=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var h=Xa(e)?!!e.capture:!!e,l=bs(a);l||(a[Vr]=l=new Rr(a));c=l.add(b,c,d,h,f);if(c.proxy)return c;d=cs();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)Jr||(e=h),void 0===e&&(e=
!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(ds(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");Xr++;return c},cs=function(){var a=es,b=Hr?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b},Yr=function(a,b,c,d,e){if(Ua(b)){for(var f=0;f<b.length;f++)Yr(a,b[f],c,d,e);return null}c=$r(c);return Nr(a)?fs(a,b,c,Xa(d)?
!!d.capture:!!d,e):as(a,b,c,!0,d,e)},gs=function(a,b,c,d,e){if(Ua(b))for(var f=0;f<b.length;f++)gs(a,b[f],c,d,e);else d=Xa(d)?!!d.capture:!!d,c=$r(c),Nr(a)?a.N.remove(String(b),c,d,e):a&&(a=bs(a))&&(b=Ur(a,b,c,d,e))&&hs(b)},hs=function(a){if(p(a)||!a||a.removed)return!1;var b=a.src;if(Nr(b))return Tr(b.N,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(ds(c),d):b.addListener&&b.removeListener&&b.removeListener(d);Xr--;(c=bs(b))?(Tr(c,
a),0==c.f&&(c.src=null,b[Vr]=null)):Qr(a);return!0},is=function(a){if(a)if(Nr(a))a.qj(void 0);else if(a=bs(a)){var b=0,c;for(c in a.b)for(var d=a.b[c].concat(),e=0;e<d.length;++e)hs(d[e])&&++b}},ds=function(a){return a in Wr?Wr[a]:Wr[a]="on"+a},ks=function(a,b,c,d){var e=!0;if(a=bs(a))if(b=a.b[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.removed&&(f=js(f,d),e=e&&!1!==f)}return e},js=function(a,b){var c=a.listener,d=a.bb||a.src;a.ah&&hs(a);return c.call(d,b)},es=
function(a,b){if(a.removed)return!0;if(!Hr){var c=b||Pa("window.event");b=new Kr(c,this);var d=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var e=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(h){e=!0}if(e||void 0==c.returnValue)c.returnValue=!0}c=[];for(e=b.f;e;e=e.parentNode)c.push(e);a=a.type;for(e=c.length-1;0<=e;e--){b.f=c[e];var f=ks(c[e],a,!0,b);d=d&&f}for(e=0;e<c.length;e++)b.f=c[e],f=ks(c[e],a,!1,b),d=d&&f}return d}return js(a,new Kr(b,this))},bs=function(a){a=a[Vr];return a instanceof
Rr?a:null},ls="__closure_events_fn_"+(1E9*Math.random()>>>0),$r=function(a){if(Wa(a))return a;a[ls]||(a[ls]=function(b){return a.handleEvent(b)});return a[ls]};var Y=function(){Dr.call(this);this.N=new Rr(this);this.Oh=this;this.B=null};v(Y,Dr);Y.prototype[Mr]=!0;Y.prototype.removeEventListener=function(a,b,c,d){gs(this,a,b,c,d)};
Y.prototype.I=function(a){var b,c=this.B;if(c)for(b=[];c;c=c.B)b.push(c);c=this.Oh;var d=a.type||a;if(Ja(a))a=new X(a,c);else if(a instanceof X)a.target=a.target||c;else{var e=a;a=new X(d,c);$c(a,e)}e=!0;if(b)for(var f=b.length-1;0<=f;f--){var h=a.f=b[f];e=h.lf(d,!0,a)&&e}h=a.f=c;e=h.lf(d,!0,a)&&e;e=h.lf(d,!1,a)&&e;if(b)for(f=0;f<b.length;f++)h=a.f=b[f],e=h.lf(d,!1,a)&&e;return e};Y.prototype.ba=function(){Y.ua.ba.call(this);this.qj();this.B=null};
Y.prototype.listen=function(a,b,c,d){return this.N.add(String(a),b,!1,c,d)};var fs=function(a,b,c,d,e){return a.N.add(String(b),c,!0,d,e)};Y.prototype.qj=function(a){this.N&&this.N.removeAll(a)};Y.prototype.lf=function(a,b,c){a=this.N.b[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==b){var h=f.listener,l=f.bb||f.src;f.ah&&Tr(this.N,f);d=!1!==h.call(l,c)&&d}}return d&&0!=c.Xl};
Y.prototype.hasListener=function(a,b){return this.N.hasListener(Ia(a)?String(a):void 0,b)};var ms=function(a,b){this.g=a;this.h=b;this.f=0;this.b=null};ms.prototype.get=function(){if(0<this.f){this.f--;var a=this.b;this.b=a.next;a.next=null}else a=this.g();return a};var ns=function(a,b){a.h(b);100>a.f&&(a.f++,b.next=a.b,a.b=b)};var os=function(a){Ha.setTimeout(function(){throw a;},0)},ps,qs=function(){var a=Ha.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!Kc("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var c=a.contentWindow;a=c.document;a.open();a.write("");a.close();var b="callImmediate"+Math.random(),d="file:"==c.location.protocol?"*":c.location.protocol+"//"+c.location.host;
a=q(function(a){if(("*"==d||a.origin==d)&&a.data==b)this.port1.onmessage()},this);c.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){c.postMessage(b,d)}}});if("undefined"!==typeof a&&!Kc("Trident")&&!Kc("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(Ia(c.next)){c=c.next;var a=c.xk;c.xk=null;a()}};return function(a){d.next={xk:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?
function(a){var c=document.createElement("SCRIPT");c.onreadystatechange=function(){c.onreadystatechange=null;c.parentNode.removeChild(c);c=null;a();a=null};document.documentElement.appendChild(c)}:function(a){Ha.setTimeout(a,0)}};var rs=function(){this.f=this.b=null},ts=new ms(function(){return new ss},function(a){a.reset()});rs.prototype.add=function(a,b){var c=ts.get();c.set(a,b);this.f?this.f.next=c:this.b=c;this.f=c};rs.prototype.remove=function(){var a=null;this.b&&(a=this.b,this.b=this.b.next,this.b||(this.f=null),a.next=null);return a};var ss=function(){this.next=this.scope=this.b=null};ss.prototype.set=function(a,b){this.b=a;this.scope=b;this.next=null};ss.prototype.reset=function(){this.next=this.scope=this.b=null};var ys=function(a,b){us||vs();ws||(us(),ws=!0);xs.add(a,b)},us,vs=function(){if(Ha.Promise&&Ha.Promise.resolve){var a=Ha.Promise.resolve(void 0);us=function(){a.then(zs)}}else us=function(){var a=zs;!Wa(Ha.setImmediate)||Ha.Window&&Ha.Window.prototype&&!Kc("Edge")&&Ha.Window.prototype.setImmediate==Ha.setImmediate?(ps||(ps=qs()),ps(a)):Ha.setImmediate(a)}},ws=!1,xs=new rs,zs=function(){for(var a;a=xs.remove();){try{a.b.call(a.scope)}catch(b){os(b)}ns(ts,a)}ws=!1};var As=function(a){a.prototype.$goog_Thenable=!0},Bs=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};var Es=function(a,b){this.b=0;this.o=void 0;this.h=this.f=this.g=null;this.j=this.l=!1;if(a!=Qa)try{var c=this;a.call(b,function(a){Cs(c,2,a)},function(a){if(!(a instanceof Ds))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(e){}Cs(c,3,a)})}catch(d){Cs(this,3,d)}},Fs=function(){this.next=this.context=this.f=this.h=this.b=null;this.g=!1};Fs.prototype.reset=function(){this.context=this.f=this.h=this.b=null;this.g=!1};
var Gs=new ms(function(){return new Fs},function(a){a.reset()}),Hs=function(a,b,c){var d=Gs.get();d.h=a;d.f=b;d.context=c;return d},Is=function(a){if(a instanceof Es)return a;var b=new Es(Qa);Cs(b,2,a);return b},Js=function(a){return new Es(function(b,c){c(a)})},Ls=function(a,b,c){Ks(a,b,c,null)||ys(cb(b,a))},Ms=function(a){return new Es(function(b,c){a.length||b(void 0);for(var d=0,e;d<a.length;d++)e=a[d],Ls(e,b,c)})},Ns=function(a){return new Es(function(b,c){var d=a.length,e=[];if(d)for(var f=
function(a,c){d--;e[a]=c;0==d&&b(e)},h=function(a){c(a)},l=0,r;l<a.length;l++)r=a[l],Ls(r,cb(f,l),h);else b(e)})},Os=function(a){return new Es(function(b){var c=a.length,d=[];if(c)for(var e=function(a,e,f){c--;d[a]=e?{Ed:!0,value:f}:{Ed:!1,reason:f};0==c&&b(d)},f=0,h;f<a.length;f++)h=a[f],Ls(h,cb(e,f,!0),cb(e,f,!1));else b(d)})},Qs=function(){var a,b,c=new Es(function(c,e){a=c;b=e});return new Ps(c,a,b)};Es.prototype.then=function(a,b,c){return Rs(this,Wa(a)?a:null,Wa(b)?b:null,c)};As(Es);
var Ts=function(a,b,c){b=Hs(b,b,c);b.g=!0;Ss(a,b);return a},Us=function(a,b,c){return Rs(a,null,b,c)};Es.prototype.cancel=function(a){0==this.b&&ys(function(){var b=new Ds(a);Vs(this,b)},this)};
var Vs=function(a,b){if(0==a.b)if(a.g){var c=a.g;if(c.f){for(var d=0,e=null,f=null,h=c.f;h&&(h.g||(d++,h.b==a&&(e=h),!(e&&1<d)));h=h.next)e||(f=h);e&&(0==c.b&&1==d?Vs(c,b):(f?(d=f,d.next==c.h&&(c.h=d),d.next=d.next.next):Ws(c),Xs(c,e,3,b)))}a.g=null}else Cs(a,3,b)},Ss=function(a,b){a.f||2!=a.b&&3!=a.b||Ys(a);a.h?a.h.next=b:a.f=b;a.h=b},Rs=function(a,b,c,d){var e=Hs(null,null,null);e.b=new Es(function(a,h){e.h=b?function(c){try{var e=b.call(d,c);a(e)}catch(y){h(y)}}:a;e.f=c?function(b){try{var e=c.call(d,
b);!Ia(e)&&b instanceof Ds?h(b):a(e)}catch(y){h(y)}}:h});e.b.g=a;Ss(a,e);return e.b};Es.prototype.u=function(a){this.b=0;Cs(this,2,a)};Es.prototype.B=function(a){this.b=0;Cs(this,3,a)};
var Cs=function(a,b,c){0==a.b&&(a===c&&(b=3,c=new TypeError("Promise cannot resolve to itself")),a.b=1,Ks(c,a.u,a.B,a)||(a.o=c,a.b=b,a.g=null,Ys(a),3!=b||c instanceof Ds||Zs(a,c)))},Ks=function(a,b,c,d){if(a instanceof Es)return Ss(a,Hs(b||Qa,c||null,d)),!0;if(Bs(a))return a.then(b,c,d),!0;if(Xa(a))try{var e=a.then;if(Wa(e))return $s(a,e,b,c,d),!0}catch(f){return c.call(d,f),!0}return!1},$s=function(a,b,c,d,e){var f=!1,h=function(a){f||(f=!0,c.call(e,a))},l=function(a){f||(f=!0,d.call(e,a))};try{b.call(a,
h,l)}catch(r){l(r)}},Ys=function(a){a.l||(a.l=!0,ys(a.A,a))},Ws=function(a){var b=null;a.f&&(b=a.f,a.f=b.next,b.next=null);a.f||(a.h=null);return b};Es.prototype.A=function(){for(var a;a=Ws(this);)Xs(this,a,this.b,this.o);this.l=!1};
var Xs=function(a,b,c,d){if(3==c&&b.f&&!b.g)for(;a&&a.j;a=a.g)a.j=!1;if(b.b)b.b.g=null,at(b,c,d);else try{b.g?b.h.call(b.context):at(b,c,d)}catch(e){bt.call(null,e)}ns(Gs,b)},at=function(a,b,c){2==b?a.h.call(a.context,c):a.f&&a.f.call(a.context,c)},Zs=function(a,b){a.j=!0;ys(function(){a.j&&bt.call(null,b)})},bt=os,Ds=function(a){Db.call(this,a)};v(Ds,Db);Ds.prototype.name="cancel";var Ps=function(a,b,c){this.V=a;this.resolve=b;this.reject=c};var ct=function(a,b){Y.call(this);this.h=a||1;this.g=b||Ha;this.j=q(this.o,this);this.l=t()};v(ct,Y);ct.prototype.enabled=!1;ct.prototype.b=null;var dt=function(a,b){a.h=b;a.b&&a.enabled?(a.stop(),a.start()):a.b&&a.stop()};ct.prototype.o=function(){if(this.enabled){var a=t()-this.l;0<a&&a<.8*this.h?this.b=this.g.setTimeout(this.j,this.h-a):(this.b&&(this.g.clearTimeout(this.b),this.b=null),this.I("tick"),this.enabled&&(this.stop(),this.start()))}};
ct.prototype.start=function(){this.enabled=!0;this.b||(this.b=this.g.setTimeout(this.j,this.h),this.l=t())};ct.prototype.stop=function(){this.enabled=!1;this.b&&(this.g.clearTimeout(this.b),this.b=null)};ct.prototype.ba=function(){ct.ua.ba.call(this);this.stop();delete this.g};
var et=function(a,b,c){if(Wa(a))c&&(a=q(a,c));else if(a&&"function"==typeof a.handleEvent)a=q(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:Ha.setTimeout(a,b||0)},ft=function(a){Ha.clearTimeout(a)},gt=function(a){var b=null;return Us(new Es(function(c,d){b=et(function(){c(void 0)},a);-1==b&&d(Error("Failed to schedule timer."))}),function(a){ft(b);throw a;})};var ht=function(){var a=void 0===a?!0:a;this.m=Bq("mr.cloud.slarti.Fetcher");this.b=0;this.f=a};ht.prototype.execute=function(a){var b=this,c="Fetch call "+ ++this.b,d=new re(function(){return it(b,c,a,function(a){return d.abort(a)})},1E3,this.f?5:1);return d.start()};
var it=function(a,b,c,d){var e=c.uri.toString().replace(/\?.*/,"?<redacted>"),f=c.method+" "+e;W(a.m,b+": "+f);e=[vr(c).then(function(a){return Promise.resolve(fetch(a))})];c.Kg&&e.push(gt(c.Kg).then(function(){throw Cr("API call timed out",504);}));return Promise.race(e).then(function(d){if(!d.ok)return d.json().then(function(a){return a},function(){return null}).then(function(a){var c;a&&a instanceof Object&&a.error&&(c=a.error);throw new xr(d,c);});var e=(t()-c.start)/1E3;W(a.m,b+" succeeded: "+
f+" duration = "+e+"s");return(e=d.headers.get("content-type"))&&e.includes("application/json")?d.json():e&&(e.includes("image")||e.includes("application/octet-stream"))?d.blob():d.text()},function(c){var e="";if(c instanceof xr)e=", ("+c.status+"): "+c.message,Br(c)&&d(c);else{try{e=", "+JSON.stringify(c,null,2)}catch(r){}c instanceof Error&&"Failed to fetch"==c.message&&(c=Cr(c.message))}Dq(a.m,b+" failed: "+e);throw c;})};var jt=function(a,b){this.b=Sp.b;this.cb=a;this.f=b};var kt=function(a,b){jt.call(this,a,b)};n(kt,jt);kt.prototype.register=function(a){a=new ur({method:"POST",Vb:this.b,sc:["user:register"],cb:this.cb,body:{gcmId:a}});return this.f.execute(a)};kt.prototype.unregister=function(a){a=new ur({method:"POST",Vb:this.b,sc:["user:unregister"],cb:this.cb,body:{gcmId:a}});return this.f.execute(a)};var lt=function(a,b,c){this.m=gb("mr.cloud.slarti.GcmRegistration");this.g=a;this.f=b;this.h=c;this.b=null},nt=function(a){if(!a.b){var b=a.f["mr.cloud.slarti.GcmRegistration.ID"];a.b=a.h.register(["307539924703"]).then(function(c){if(c==b)nb(a.m,"Slarti GCM ID unchanged: "+c);else return nb(a.m,"Got new Slarti GCM ID: "+c),(b?mt(a,b):Promise.resolve()).then(function(){return a.g.register(c).then(function(){a.f["mr.cloud.slarti.GcmRegistration.ID"]=c})})},function(c){a.m.F("Error registering for GCM notifications",
c);b&&mt(a,b).catch(function(c){a.m.F("Failed to unregister GCM ID with Slarti",c)});throw c;});a.b.then(function(){a.b=null},function(){a.b=null})}return a.b},mt=function(a,b){return a.g.unregister(b).then(function(){delete a.f["mr.cloud.slarti.GcmRegistration.ID"]},function(c){a.m.F("Failed to unregister GCM ID with Slarti",c)})};var ot=null,pt=function(){Km.call(this,5,"mr.cloud.slarti.GcmEventListener","mr.cloud.slarti.SinkDiscoveryService",chrome.gcm.onMessage);this.m=gb("mr.cloud.slarti.GcmEventListener")};n(pt,Km);pt.prototype.Mg=function(a){if(a&&"307539924703"==a.from&&"object"==typeof a.data&&"string"==typeof a.data.data){var b=JSON.parse(a.data.data);a=b.type;b=b.id;if(a)return this.m.info("Received Slarti GCM notification: "+a+" ("+b+")"),!0}return!1};var qt=function(){null==ot&&(ot=new pt);return ot};var rt=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];d=a;c=k(c);for(var e=c.next();!e.done;e=c.next()){if(void 0==d||"object"!=typeof d)return;d=d[e.value]}return d};var st=function(){Km.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.WeaveSinkDiscoveryService",chrome.gcm.onMessage);this.m=gb("mr.WeaveGcmEventListener")};n(st,Km);st.prototype.Mg=function(a){if(!a||"919648714761"!=a.from)return!1;a=rt(a,"data","notification");if(!a)return this.m.error("Notification json not found"),!1;try{var b=JSON.parse(a);return!!b&&Array.isArray(b.events)&&0<b.events.length}catch(c){return this.m.error("Invalid json: "+a),!1}};
var ut=function(){tt||(tt=new st);return tt},tt=null;var vt=function(a){this.b=a;this.m=gb("mr.cloud.messaging.WeaveGcmMessageHandler")};vt.prototype.onMessage=function(a){var b=this;a=JSON.parse(a.data.notification);var c=Ej();a.events.forEach(function(a){if(a.deviceId){var d=Fj(c,a.deviceId);switch(a.type){case "deviceCreated":wt(b,a);break;case "deviceUpdated":xt(b,a,d);break;case "deviceDeleted":yt(b.b,{sinkId:d});break;default:nb(b.m,function(){return"[unhandled event] "+JSON.stringify(a)})}}else b.m.error("Device ID not provided")})};
var wt=function(a,b){var c=rt(b,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof c?a.m.error("Receiver name not a string: "+c):(b=new Uq(b.deviceId,c,"owner","default",!0),a=a.b,a.b.b.set(b.id,b),a.b.f=Date.now(),ar(a.f,[b.jb]))},xt=function(a,b,c){b=rt(b,"statePatch","_cloudCast","appStatus");if("string"!=typeof b)a.m.error("App status not a string: "+b);else if(a=a.b,b="available"==b,c=a.b.ka(c))c.isAvailable=b||!1,a.b.f=Date.now(),br(a.f,[c.jb])};var zt=function(a,b){this.g=a;this.f=b;this.b=new Xq(this.Fp.bind(this),b,2E4);this.h=new vt(this);ut().addListener();kj(this);og("mr.cloud.discovery.WeaveSinkDiscoveryService",this)};n(zt,dg);g=zt.prototype;g.Jd=function(){var a=this;Rq(this.g).then(function(b){Sq(a.g,b)},function(){});return this.b.Jd().filter(function(a){return a.isAvailable})};g.ka=function(a){return this.b.ka(a)};
g.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.gcm.onMessage)this.h.onMessage.apply(this.h,m(c));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};
g.Fp=function(){return Pq(this.g,{descriptionSubstring:"Chrome Streaming Receiver"}).then(function(a){return a.map(function(a){Ab("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var c=a.isAvailable()&&!(a.b.invitations&&0!=a.b.invitations.length);return new Uq(a.getId(),a.f(),a.b.personalizedInfo.maxRole,"default",c)})})};g.Aa=function(){return"WeaveSinkDiscoveryService"};g.fb=function(){return[{cache:er(this.b)}]};g.eb=function(){var a=hj(this);a&&fr(this.b,a.cache)};
var yt=function(a,b){if(b=a.b.ka(b.sinkId))a.b.b.delete(b.id),a.b.f=Date.now(),cr(a.f,[b.jb])};var At=Ha.JSON.parse,Bt=Ha.JSON.stringify;var Ct=function(a,b,c,d,e,f,h,l,r){this.b=null;this.w=!1;this.B=Qs();this.g=[];this.u=a?encodeURIComponent(String(a)):null;this.C=null;!d&&b&&(this.C=b);this.G=c||null;this.h=!d;this.j=null!=e?e:null;this.o=f||null;this.K=!!h;this.D=l||null;this.l=null!=r?r:null};v(Ct,Dr);var Dt=fe(Rd(new Qd(Od,"https://apis.google.com/js/client.js")));
Ct.prototype.init=function(){var a=q(function(a){this.b=a;var c=Pa("auth",a);Pa("client.request",a)&&c?this.N():a.load("client",q(this.N,this))},this),b=Et("gapi");b?a(b.gapi):Ft(this,a);return this.B.V};
var Et=function(a){for(var b=window,c=Pa(a,b);!c&&b!=window.top&&Gt(b.parent,a);)b=b.parent,c=Pa(a,b);return c?b:null},Gt=function(a,b){try{return!!a&&null!=a.location.href&&fd(a,b)}catch(c){return!1}},Ft=function(a,b){var c=Et("gapi_onload");if(c){var d=c.gapi_onload;c.gapi_onload=function(){d();b(c.gapi)}}else{window.gapi_onload=function(){b(window.gapi)};var e=document.createElement("SCRIPT");pe(e,Dt);a.D&&Je(e,Bt(a.D));document.getElementsByTagName("head")[0].appendChild(e)}};
Ct.prototype.N=function(){for(var a=0;a<this.g.length;a++)this.g[a].qb.resolve(Ht(this,this.g[a].requestData));this.w=!0;this.B.resolve(this.b)};Ct.prototype.sendRequest=function(a){if(this.w)return Ht(this,a);var b=Qs();this.g.push({requestData:a,qb:b});return b.V};
var Ht=function(a,b){var c=Pa("config.get",a.b);if(!a.h){var d=c("googleapis.config/auth/useFirstPartyAuth");var e=c("googleapis.config/auth/useOriginToken")}var f;null!=a.j&&(f=c("client/cors"));var h;null!=a.l&&(h=c("client/xd4"));try{var l=Pa("config.update",a.b);a.h||(l("googleapis.config/auth/useFirstPartyAuth",!1),l("googleapis.config/auth/useOriginToken",!1));null!=a.j&&l("client/cors",a.j);null!=a.l&&l("client/xd4",a.l);var r=It(a);b.headers&&$c(r,b.headers);var y={headers:r,root:a.G,path:b.path,
method:b.method,body:b.body},B=b.params||{};a.u&&!a.o?$c(B,{key:a.u}):a.o&&$c(B,{key:null});Uc(B)||(y.params=B);var G=Is(Pa("client.request",a.b)(y));b.callback&&G.then(function(a){b.callback.apply(null,[a.result,a])},function(a){b.callback.apply(null,[a.result,a])});return G}finally{c=Pa("config.update",a.b),a.h||(c("googleapis.config/auth/useFirstPartyAuth",d),c("googleapis.config/auth/useOriginToken",e)),null!=a.j&&c("client/cors",f),null!=a.l&&c("client/xd4",h)}},It=function(a){if(a.h){if(a.o)return{Authorization:"Bearer "+
a.o};var b=Pa("auth.getAuthHeaderValueForFirstParty",a.b);return{Authorization:a.K?b([]):b(),"X-Goog-AuthUser":a.C}}return{}};var Jt=function(a){this.b=a},cq=function(a,b,c){var d="";b.forEach(function(a){d+="/"+encodeURIComponent(a)});a=new Zo(a+d);c&&(c=op(c),bp(a,c));return a},dq=function(a,b,c,d){return a.b.getAuthToken().then(function(e){var f=Kt(e);return Lt(f,b,c,d).catch(function(f){if("INVALID_ACCESS_ERROR"==f)return Mt(a,e,b,c,d);throw f;})})},Mt=function(a,b,c,d,e){return rr(b).then(function(){return dq(a,c,d,e)})},Lt=function(a,b,c,d){return new Promise(function(e,f){a.sendRequest(Nt(b,c,function(a){a&&!a.error?
e(a):a&&401==a.error.code?f("INVALID_ACCESS_ERROR"):f(a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a))},d))})},Kt=function(a){a=new Ct(void 0,void 0,void 0,!1,!1,a);a.init();return a},Nt=function(a,b,c,d){a={callback:c,method:b,path:a.toString()};d&&(a.body=d);return a};var Ot={Is:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},Hs:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Pt=Ot;Pt=Ot;var Qt={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,
"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd",
"RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"\u20ba","TRY"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var Rt={Kj:".",Kh:",",Wj:"%",Wh:"0",en:"+",Tj:"-",Oj:"E",Xj:"\u2030",Lh:"\u221e",Zm:"NaN",Fm:"#,##0.###",hx:"#E0",hw:"#,##0%",Vs:"\u00a4#,##0.00",Lj:"USD"},St=Rt;St=Rt;var Ut=function(){this.B=40;this.f=1;this.g=3;this.C=this.l=0;this.G=!1;this.w=this.A="";this.h=St.Tj;this.u="";this.b=1;this.o=!1;this.j=[];this.D=this.N=!1;var a=St.Fm;a.replace(/ /g,"\u00a0");var b=[0];this.A=Tt(this,a,b);for(var c=b[0],d=-1,e=0,f=0,h=0,l=-1,r=a.length,y=!0;b[0]<r&&y;b[0]++)switch(a.charAt(b[0])){case "#":0<f?h++:e++;0<=l&&0>d&&l++;break;case "0":if(0<h)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=l&&0>d&&l++;break;case ",":0<l&&this.j.push(l);l=0;break;case ".":if(0<=
d)throw Error('Multiple decimal separators in pattern "'+a+'"');d=e+f+h;break;case "E":if(this.D)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.D=!0;this.C=0;b[0]+1<r&&"+"==a.charAt(b[0]+1)&&(b[0]++,this.G=!0);for(;b[0]+1<r&&"0"==a.charAt(b[0]+1);)b[0]++,this.C++;if(1>e+f||1>this.C)throw Error('Malformed exponential pattern "'+a+'"');y=!1;break;default:b[0]--,y=!1}0==f&&0<e&&0<=d&&(f=d,0==f&&f++,h=e-f,e=f-1,f=1);if(0>d&&0<h||0<=d&&(d<e||d>e+f)||0==l)throw Error('Malformed pattern "'+
a+'"');h=e+f+h;this.g=0<=d?h-d:0;0<=d&&(this.l=e+f-d,0>this.l&&(this.l=0));this.f=(0<=d?d:h)-e;this.D&&(this.B=e+this.f,0==this.g&&0==this.f&&(this.f=1));this.j.push(Math.max(0,l));this.N=0==d||d==h;c=b[0]-c;this.w=Tt(this,a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.b&&(this.o=!0),this.h=Tt(this,a,b),b[0]+=c,this.u=Tt(this,a,b)):(this.h+=this.A,this.u+=this.w)};
Ut.prototype.parse=function(a,b){b=b||[0];a=a.replace(/ |\u202f/g,"\u00a0");var c=a.indexOf(this.A,b[0])==b[0],d=a.indexOf(this.h,b[0])==b[0];c&&d&&(this.A.length>this.h.length?d=!1:this.A.length<this.h.length&&(c=!1));c?b[0]+=this.A.length:d&&(b[0]+=this.h.length);if(a.indexOf(St.Lh,b[0])==b[0]){b[0]+=St.Lh.length;var e=Infinity}else{e=a;var f=!1,h=!1,l=!1,r=-1,y=1,B=St.Kj,G=St.Kh,aa=St.Oj;G=G.replace(/\u202f/g,"\u00a0");for(var P="";b[0]<e.length;b[0]++){var ha=e.charAt(b[0]),Ea=Vt(ha);if(0<=Ea&&
9>=Ea)P+=Ea,l=!0;else if(ha==B.charAt(0)){if(f||h)break;P+=".";f=!0}else if(ha==G.charAt(0)&&("\u00a0"!=G.charAt(0)||b[0]+1<e.length&&0<=Vt(e.charAt(b[0]+1)))){if(f||h)break}else if(ha==aa.charAt(0)){if(h)break;P+="E";h=!0;r=b[0]}else if("+"==ha||"-"==ha){if(l&&r!=b[0]-1)break;P+=ha}else if(1==this.b&&ha==St.Wj.charAt(0)){if(1!=y)break;y=100;if(l){b[0]++;break}}else if(1==this.b&&ha==St.Xj.charAt(0)){if(1!=y)break;y=1E3;if(l){b[0]++;break}}else break}1!=this.b&&(y=this.b);e=parseFloat(P)/y}if(c){if(a.indexOf(this.w,
b[0])!=b[0])return NaN;b[0]+=this.w.length}else if(d){if(a.indexOf(this.u,b[0])!=b[0])return NaN;b[0]+=this.u.length}return d?-e:e};
Ut.prototype.format=function(a){if(isNaN(a))return St.Zm;var b=[];var c=Wt;a=Xt(a,-c.Io);b.push(c.prefix);var d=0>a||0==a&&0>1/a;b.push(d?this.h:this.A);if(isFinite(a))if(a=a*(d?-1:1)*this.b,this.D)if(0==a)Yt(this,a,this.f,b),Zt(this,0,b);else{var e=Math.floor(Math.log(a)/Math.log(10)+2E-15);a=Xt(a,-e);var f=this.f;1<this.B&&this.B>this.f?(f=e%this.B,0>f&&(f=this.B+f),a=Xt(a,f),e-=f,f=1):1>this.f?(e++,a=Xt(a,-1)):(e-=this.f-1,a=Xt(a,this.f-1));Yt(this,a,f,b);Zt(this,e,b)}else Yt(this,a,this.f,b);
else b.push(St.Lh);b.push(d?this.u:this.w);b.push(c.wr);return b.join("")};
var Yt=function(a,b,c,d){if(a.l>a.g)throw Error("Min value must be less than max value");d||(d=[]);var e=Xt(b,a.g);e=Math.round(e);if(isFinite(e)){b=Math.floor(Xt(e,-a.g));var f=Math.floor(e-Xt(b,a.g))}else f=0;e=b;b=f;var h=e;f=b;var l=0<a.l||0<f||!1;e=a.l;l&&(e=a.l);var r="";for(b=h;1E20<b;)r="0"+r,b=Math.round(Xt(b,-1));r=b+r;var y=St.Kj;b=St.Wh.charCodeAt(0);var B=r.length,G=0;if(0<h||0<c){for(h=B;h<c;h++)d.push(String.fromCharCode(b));if(2<=a.j.length)for(c=1;c<a.j.length;c++)G+=a.j[c];c=B-G;
if(0<c){h=a.j;G=B=0;for(var aa,P=St.Kh,ha=r.length,Ea=0;Ea<ha;Ea++)if(d.push(String.fromCharCode(b+1*Number(r.charAt(Ea)))),1<ha-Ea)if(aa=h[G],Ea<c){var ae=c-Ea;(1===aa||0<aa&&1===ae%aa)&&d.push(P)}else G<h.length&&(Ea===c?G+=1:aa===Ea-c-B+1&&(d.push(P),B+=aa,G+=1))}else{c=r;r=a.j;h=St.Kh;aa=c.length;P=[];for(B=r.length-1;0<=B&&0<aa;B--){G=r[B];for(ha=0;ha<G&&0<=aa-ha-1;ha++)P.push(String.fromCharCode(b+1*Number(c.charAt(aa-ha-1))));aa-=G;0<aa&&P.push(h)}d.push.apply(d,P.reverse())}}else l||d.push(String.fromCharCode(b));
(a.N||l)&&d.push(y);l=String(f);f=l.split("e+");if(2==f.length){if(l=parseFloat(f[0])){y=l;if(isFinite(y)){for(c=0;1<=(y/=10);)c++;y=c}else y=0<y?y:0;y=0-y-1;l=-1>y?l&&isFinite(l)?Xt(Math.round(Xt(l,-1)),1):l:l&&isFinite(l)?Xt(Math.round(Xt(l,y)),-y):l}l=String(l);l=l.replace(".","");l+=zc("0",parseInt(f[1],10)-l.length+1)}a.g+1>l.length&&(l="1"+zc("0",a.g-l.length)+l);for(a=l.length;"0"==l.charAt(a-1)&&a>e+1;)a--;for(h=1;h<a;h++)d.push(String.fromCharCode(b+1*Number(l.charAt(h))))},Zt=function(a,
b,c){c.push(St.Oj);0>b?(b=-b,c.push(St.Tj)):a.G&&c.push(St.en);b=""+b;for(var d=St.Wh,e=b.length;e<a.C;e++)c.push(d);c.push(b)},Vt=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=St.Wh.charCodeAt(0);return b<=a&&a<b+10?a-b:-1},Tt=function(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var h=b.charAt(c[0]);if("'"==h)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=h;else switch(h){case "#":case "0":case ",":case ".":case ";":return d;case "\u00a4":c[0]+1<f&&"\u00a4"==
b.charAt(c[0]+1)?(c[0]++,d+=St.Lj):d+=Qt[St.Lj][1];break;case "%":if(!a.o&&1!=a.b)throw Error("Too many percent/permill");if(a.o&&100!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=100;a.o=!1;d+=St.Wj;break;case "\u2030":if(!a.o&&1!=a.b)throw Error("Too many percent/permill");if(a.o&&1E3!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=1E3;a.o=!1;d+=St.Xj;break;default:d+=h}}return d},Wt={prefix:"",wr:"",Io:0},Xt=function(a,b){if(!a||!isFinite(a)||0==
b)return a;a=String(a).split("e");return parseFloat(a[0]+"e"+(parseInt(a[1]||0,10)+b))};var $t=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},au=$t;au=$t;var bu=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},cu=bu;cu=bu;var hu=function(){this.h=du;this.f=this.b=this.j=null;var a=St,b=Pt;if(eu!==a||fu!==b)eu=a,fu=b,gu=new Ut;this.l=gu},eu=null,fu=null,gu=null,iu=/'([{}#].*?)'/g,ju=/''/g;hu.prototype.format=function(a){if(this.h){this.j=[];var b=ku(this,this.h);this.f=lu(this,b);this.h=null}if(this.f&&0!=this.f.length)for(this.b=x(this.j),b=[],mu(this,this.f,a,!1,b),a=b.join("");0<this.b.length;)a=a.replace(this.g(this.b),this.b.pop());else a="";return a};
var mu=function(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var h=b[f].value,l=a,r=e,y=c[h];Ia(y)?(l.b.push(y),r.push(l.g(l.b))):r.push("Undefined parameter - "+h);break;case 2:h=b[f].value;l=e;r=h.Yg;Ia(c[r])?(r=h[c[r]],Ia(r)||(r=h.other),mu(a,r,c,d,l)):l.push("Undefined parameter - "+r);break;case 0:h=b[f].value;nu(a,h,c,cu,d,e);break;case 1:h=b[f].value;nu(a,h,c,au,d,e);break;default:Gb("Unrecognized block type: "+b[f].type)}},nu=function(a,b,
c,d,e,f){var h=b.Yg,l=b.qk,r=+c[h];isNaN(r)?f.push("Undefined or invalid parameter - "+h):(l=r-l,h=b[c[h]],Ia(h)||(d=d(l),h=b[d],Ia(h)||(h=b.other)),b=[],mu(a,h,c,e,b),c=b.join(""),e?f.push(c):(a=a.l.format(l),f.push(c.replace(/#/g,a))))},ku=function(a,b){var c=a.j,d=q(a.g,a);b=b.replace(ju,function(){c.push("'");return d(c)});return b=b.replace(iu,function(a,b){c.push(b);return d(c)})},ou=function(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var h=f.index;"}"==f[0]?(c.pop(),
0==c.length&&(f={type:1},f.value=a.substring(b,h),d.push(f),b=h+1)):(0==c.length&&(b=a.substring(b,h),""!=b&&d.push({type:0,value:b}),b=h+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d},pu=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,qu=/^\s*(\w+)\s*,\s*selectordinal\s*,/,ru=/^\s*(\w+)\s*,\s*select\s*,/,lu=function(a,b){var c=[];b=ou(b);for(var d=0;d<b.length;d++){var e={};if(0==b[d].type)e.type=4,e.value=b[d].value;else if(1==b[d].type){var f=b[d].value;switch(pu.test(f)?
0:qu.test(f)?1:ru.test(f)?2:/^\s*\w+\s*/.test(f)?3:5){case 2:e.type=2;e.value=su(a,b[d].value);break;case 0:e.type=0;e.value=tu(a,b[d].value);break;case 1:e.type=1;e.value=uu(a,b[d].value);break;case 3:e.type=3;e.value=b[d].value;break;default:Gb("Unknown block type for pattern: "+b[d].value)}}else Gb("Unknown part of the pattern.");c.push(e)}return c},su=function(a,b){var c="";b=b.replace(ru,function(a,b){c=b;return""});var d={};d.Yg=c;b=ou(b);for(var e=0;e<b.length;){var f=b[e].value;e++;if(1==
b[e].type)var h=lu(a,b[e].value);else Gb("Expected block type.");d[f.replace(/\s/g,"")]=h;e++}return d},tu=function(a,b){var c="",d=0;b=b.replace(pu,function(a,b,e){c=b;e&&(d=parseInt(e,10));return""});var e={};e.Yg=c;e.qk=d;b=ou(b);for(var f=0;f<b.length;){var h=b[f].value;f++;if(1==b[f].type)var l=lu(a,b[f].value);else Gb("Expected block type.");e[h.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=l;f++}return e},uu=function(a,b){var c="";b=b.replace(qu,function(a,b){c=b;return""});var d={};d.Yg=c;d.qk=0;b=ou(b);
for(var e=0;e<b.length;){var f=b[e].value;e++;if(1==b[e].type)var h=lu(a,b[e].value);else Gb("Expected block type.");d[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=h;e++}return d};hu.prototype.g=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var vu=chrome.i18n.getMessage("1522140683318860351"),wu=chrome.i18n.getMessage("4246483347873264186"),xu=chrome.i18n.getMessage("5991427458288444010"),Bf=chrome.i18n.getMessage("6063910461797960050"),yu=chrome.i18n.getMessage("7735695102441495789"),zu=chrome.i18n.getMessage("4575332923598659024"),du=chrome.i18n.getMessage("2297080986956220930"),Au=new hu;var Bu=function(a){this.b=a;this.m=gb("mr.cloud.mesi.MesiService")},jr=function(a){var b=cq(Up.b,["hangouts","search"]);a.m.info("Retrieving Hangouts from MESI: "+b);return dq(a.b,b,"POST",Cu).then(function(a){var c=[];a.result&&(c=a.result.map(function(a){var c=a.hangout,b=c.meeting_room_name,d;c.meeting_domain?d=c.meeting_domain:"BUSINESS"==c.type&&c.company_title&&(d=c.company_title.toLowerCase());var e=Au.format({ORGANIZER:"",PARTICIPANTS:0});if((a=a.participant)&&0<a.length){var y=a[0].display_name;
e=a.reduce(function(a,c){a.add(c.user_id);"ORGANIZER"==c.role&&(y=c.display_name);return a},new Set);e=Au.format({ORGANIZER:y,PARTICIPANTS:e.size})}return b&&d?new Wp(!1,b+"@"+d,d,b,e,c.hangout_id):new Wp(!1,c.hangout_id,d,b,e,c.hangout_id)}));return c})},Cu={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var Du=function(a,b){this.f=a;this.b=b},Gu=function(a,b,c,d){switch(b.type){case "REFRESH_AUTH":var e=d.kd,f=d.deviceId,h=d.Gg;return sr(a.f).then(function(){Eu(a.b,new Qg("AUTH_READY",{kd:e,Wa:f,Gg:h}),c.id)});case "STATUS_REQUEST":return Eu(a.b,b,c.id),Promise.resolve();case "STATUS_RESPONSE":return Eu(a.b,b,c.id,!0),b.data.routeDescription||Eu(a.b,b,c.id),Promise.resolve();case "HANGOUT_INACTIVE":return Fu(a.b,c,4,Ff(new Af(yu,"warning"),c.sinkId));case "HANGOUT_INVALID":return Fu(a.b,c,3,Ff(new Af(zu,
"warning"),c.sinkId));default:return Promise.reject(Error("Unknown type: "+b.type))}};var Hu=new Map([["status","status"],["results","result"],["expirationTime","expiration_time"]]),Iu=function(a,b){jt.call(this,a,b);this.m=Bq("mr.cloud.slarti.CommandsService")};n(Iu,jt);Iu.prototype.get=function(a){a=new ur({method:"GET",Vb:this.b,sc:["commands",a],cb:this.cb});return this.f.execute(a).then(function(a){return a})};
Iu.prototype.list=function(a){a=new ur({method:"GET",Vb:this.b,sc:["commands"],Nl:{deviceId:a},cb:this.cb});return this.f.execute(a).then(function(a){return a.command||[]})};Iu.prototype.send=function(a,b){var c=this;a=new ur({method:"POST",Vb:this.b,sc:["commands:send"],cb:this.cb,body:{command:b,deviceId:a}});return this.f.execute(a).then(function(a){c.m.info("Sent Slarti command with ID "+a.id);return a})};
Iu.prototype.update=function(a,b){for(var c=[],d={},e=k(Hu.keys()),f=e.next();!f.done;f=e.next())f=f.value,b[f]&&(d[f]=b[f],c.push(Hu.get(f)));d.id=a;a=new ur({method:"PUT",Vb:this.b,sc:["commands",a],cb:this.cb,body:{command:d,updateMask:c}});return this.f.execute(a).then(function(a){return a})};var Ju=Ha.JSON.parse;var Ku=function(){};Ku.prototype.b=null;var Mu=function(a){var b;(b=a.b)||(b={},Lu(a)&&(b[0]=!0,b[1]=!0),b=a.b=b);return b};var Nu,Ou=function(){};v(Ou,Ku);var Pu=function(a){return(a=Lu(a))?new ActiveXObject(a):new XMLHttpRequest},Lu=function(a){if(!a.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.f=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.f};Nu=new Ou;var Qu=function(a){Y.call(this);this.headers=new Tj;this.O=a||null;this.g=!1;this.M=this.b=null;this.ha=this.G="";this.o=0;this.h="";this.j=this.da=this.D=this.Y=!1;this.l=0;this.w=null;this.u="";this.K=this.C=!1};v(Qu,Y);Qu.prototype.m=Bq("goog.net.XhrIo");var Ru=/^https?$/i,Su=["POST","PUT"],Tu=[],Uu=function(a,b,c,d,e,f,h){var l=new Qu;Tu.push(l);b&&l.listen("complete",b);fs(l,"ready",l.na);f&&(l.l=Math.max(0,f));h&&(l.C=h);l.send(a,c,d,e);return l};Qu.prototype.na=function(){this.Ua();$b(Tu,this)};
Qu.prototype.send=function(a,b,c,d){if(this.b)throw Error("[goog.net.XhrIo] Object is active with another request="+this.G+"; newUri="+a);b=b?b.toUpperCase():"GET";this.G=a;this.h="";this.o=0;this.ha=b;this.Y=!1;this.g=!0;this.b=this.O?Pu(this.O):Pu(Nu);this.M=this.O?Mu(this.O):Mu(Nu);this.b.onreadystatechange=q(this.ma,this);try{Eq(this.m,Vu(this,"Opening Xhr")),this.da=!0,this.b.open(b,String(a),!0),this.da=!1}catch(f){Eq(this.m,Vu(this,"Error opening Xhr: "+f.message));Wu(this,f);return}a=c||"";
var e=this.headers.clone();d&&Lk(d,function(a,c){e.set(c,a)});d=Rb(e.sb(),Xu);c=Ha.FormData&&a instanceof Ha.FormData;!Tb(Su,b)||d||c||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(a,c){this.b.setRequestHeader(c,a)},this);this.u&&(this.b.responseType=this.u);"withCredentials"in this.b&&this.b.withCredentials!==this.C&&(this.b.withCredentials=this.C);try{Yu(this),0<this.l&&(this.K=Zu(this.b),Eq(this.m,Vu(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+
this.K)),this.K?(this.b.timeout=this.l,this.b.ontimeout=q(this.ra,this)):this.w=et(this.ra,this.l,this)),Eq(this.m,Vu(this,"Sending request")),this.D=!0,this.b.send(a),this.D=!1}catch(f){Eq(this.m,Vu(this,"Send error: "+f.message)),Wu(this,f)}};var Zu=function(a){return kd&&Fd(9)&&p(a.timeout)&&Ia(a.ontimeout)},Xu=function(a){return pc("Content-Type",a)};
Qu.prototype.ra=function(){"undefined"!=typeof Ga&&this.b&&(this.h="Timed out after "+this.l+"ms, aborting",this.o=8,Eq(this.m,Vu(this,this.h)),this.I("timeout"),this.abort(8))};var Wu=function(a,b){a.g=!1;a.b&&(a.j=!0,a.b.abort(),a.j=!1);a.h=b;a.o=5;$u(a);av(a)},$u=function(a){a.Y||(a.Y=!0,a.I("complete"),a.I("error"))};Qu.prototype.abort=function(a){this.b&&this.g&&(Eq(this.m,Vu(this,"Aborting")),this.g=!1,this.j=!0,this.b.abort(),this.j=!1,this.o=a||7,this.I("complete"),this.I("abort"),av(this))};
Qu.prototype.ba=function(){this.b&&(this.g&&(this.g=!1,this.j=!0,this.b.abort(),this.j=!1),av(this,!0));Qu.ua.ba.call(this)};Qu.prototype.ma=function(){this.A()||(this.da||this.D||this.j?bv(this):this.va())};Qu.prototype.va=function(){bv(this)};
var bv=function(a){if(a.g&&"undefined"!=typeof Ga)if(a.M[1]&&4==cv(a)&&2==a.Oa())Eq(a.m,Vu(a,"Local request error detected and ignored"));else if(a.D&&4==cv(a))et(a.ma,0,a);else if(a.I("readystatechange"),4==cv(a)){Eq(a.m,Vu(a,"Request complete"));a.g=!1;try{if(dv(a))a.I("complete"),a.I("success");else{a.o=6;try{var b=2<cv(a)?a.b.statusText:""}catch(c){Eq(a.m,"Can not get status: "+c.message),b=""}a.h=b+" ["+a.Oa()+"]";$u(a)}}finally{av(a)}}},av=function(a,b){if(a.b){Yu(a);var c=a.b,d=a.M[0]?Qa:null;
a.b=null;a.M=null;b||a.I("ready");try{c.onreadystatechange=d}catch(e){Dq(a.m,"Problem encountered resetting onreadystatechange: "+e.message)}}},Yu=function(a){a.b&&a.K&&(a.b.ontimeout=null);a.w&&(ft(a.w),a.w=null)},dv=function(a){var b=a.Oa();a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break a;default:c=!1}if(!c){if(b=0===b)a=String(a.G).match(To)[1]||null,!a&&Ha.self&&Ha.self.location&&(a=Ha.self.location.protocol,a=a.substr(0,a.length-1)),b=!Ru.test(a?a.toLowerCase():
"");c=b}return c},cv=function(a){return a.b?a.b.readyState:0};Qu.prototype.Oa=function(){try{return 2<cv(this)?this.b.status:-1}catch(a){return-1}};
var ev=function(a){try{return a.b?a.b.responseText:""}catch(b){return Eq(a.m,"Can not get responseText: "+b.message),""}},fv=function(a){if(a.b)return Ju(a.b.responseText)},gv=function(a){try{if(!a.b)return null;if("response"in a.b)return a.b.response;switch(a.u){case "":case "text":return a.b.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.b)return a.b.mozResponseArrayBuffer}Dq(a.m,"Response type "+a.u+" is not supported on this browser");return null}catch(b){return Eq(a.m,"Can not get response: "+
b.message),null}};Qu.prototype.getResponseHeader=function(a){if(this.b&&4==cv(this))return a=this.b.getResponseHeader(a),null===a?void 0:a};var hv=function(a){var b={};a=(a.b&&4==cv(a)?a.b.getAllResponseHeaders()||"":"").split("\r\n");for(var c=0;c<a.length;c++)if(!qc(a[c])){var d=Gc(a[c],":",1),e=d[0];d=d[1];if(Ja(d)){d=d.trim();var f=b[e]||[];b[e]=f;f.push(d)}}return Mc(b,function(a){return a.join(", ")})},Vu=function(a,b){return b+" ["+a.ha+" "+a.G+" "+a.Oa()+"]"};var iv=function(){this.m=gb("mr.cloud.CredentialService")},lv=function(a){var b=new Cb,c=Vp.b+"/iceconfig?key="+Vp.f;a.m.info("Requesting TURN credentials from "+c);var d=Uu(c,function(){dv(d)?(a.m.info("Got TURN credentials: "+ev(d)),b.resolve(jv(a,fv(d)))):b.resolve(kv(a))},"POST",void 0,{"Content-Type":"application/json"});return b.b},jv=function(a,b){try{var c=[];b.iceServers.forEach(function(a){a.urls.forEach(function(b){0==b.indexOf("turn:")&&c.push({url:b,credential:a.credential,username:a.username})})});
return c}catch(d){return a.m.error("Error parsing TURN credentials.",d),[]}},kv=function(a){a.m.error("XHR failed fetching TURN credentials.",null);return[]};var mv=function(a,b,c){this.m=gb("mr.cloud.slarti.MessageHandler");this.g=a;this.h=b;this.b=c;this.f=new Map},nv=function(a){if(tg(a.mediaSource))return Promise.resolve({title:"screen"});var b=a.ib&&a.ib.tabId;return null==b?Promise.resolve({title:"",url:""}):new Promise(function(a){chrome.tabs.get(b,function(c){a({title:c&&c.title||"",url:c&&c.url||""})})})},ov=function(a,b,c,d){var e=d.deviceId,f=b.data;return nv(c).then(function(b){b={id:null,issuer:null,name:"stream",status:null,results:null,
expirationTime:null,parameters:JSON.stringify({info:b,sessionDescription:f.description,mediaConstraints:f.mediaConstraints,settings:f.settings})};return a.g.send(e,b).then(function(b){return new Promise(function(e,f){a.f.set(b.id,{routeId:c.id,sinkId:d.id,resolve:e,reject:f,np:"PENDING_APPROVAL"==b.status})})},function(){Fu(a.b,c.id,7,Ff(Ef(Df(new Af(vu,"warning")),c.id),d.id))})})},pv=function(a,b){return lv(a.h).then(function(c){Eu(a.b,new Qg("TURN_CREDENTIALS",{credentials:c}),b.id)})};var qv=function(a,b,c,d){this.f=a;this.g=b;this.h=c;this.b=d},tv=function(a,b,c,d,e){return new Promise(function(f){switch(b){case "slarti":case "weave":case "mesi":break;default:throw Error("Unrecognized channel type: "+b);}if(!c.type)throw Error("Message has no type");switch(c.type){case "STOP":f(Fu(a.b,d,1,null));return;case "SESSION_START_SUCCESS":Np(0);break;case "SESSION_END":break;case "SESSION_FAILURE":Np(1);f(Fu(a.b,d,2,Ff(new Af(vu,"warning"),d?d.sinkId:"")));return;case "__webrtc_stats__":break;
case "PRESENTATION_CONNECTION_MESSAGE":Eu(a.b,c.data,d.id,!0);break;case "OFFER":switch(b){case "slarti":f(ov(a.f,c,d,e));return;case "weave":f(rv(a.g,c,d,e));return;default:throw Error("Unexpected channel type: "+b);}case "GET_TURN_CREDENTIALS":switch(b){case "slarti":f(pv(a.f,d));return;case "weave":f(sv(a.g,d));return;default:throw Error("Unexpected channel type: "+b);}case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":f(Gu(a.h,
c,d,e));return;case "new_session":Eu(a.b,c,d.id,!0);break;case "remove_session":Eu(a.b,c,d.id,!0);a.b.terminateRoute(d.id);break;default:throw Error("Unknown type: "+c.type);}f()})};var uv=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},vv=function(a){this.b=a},yv=function(a,b,c,d){return wv(a,Lq,b,c,d,35E3).then(function(c){return xv(a,c)})},Av=function(a,b,c,d){return wv(a,Mq,b,c,d,23E3).then(function(a){var c=a.state;return"done"==c?(a=zv(a),new uv(c,a.type,new Iq(a.sessionDescription))):new uv(c)})},wv=function(a,b,c,d,e,f){var h={_webrtcMessage:JSON.stringify(d.presentationUrl?new Iq(d.description,null,d.presentationUrl,d.presentationId):
new Iq(d.description))};d.settings&&(h._settings=Ng(d.settings));d.mediaConstraints&&(h._optMediaConstraints=JSON.stringify(d.mediaConstraints));e&&(h._user=JSON.stringify(e));return Bv(a,c,b,h,f)},xv=function(a,b){var c=b.state;switch(c){case "done":return Promise.resolve(Cv(b));case "queued":case "inProgress":return Dv(a,b).then(function(c){return xv(a,c)});default:return Promise.resolve(new uv(c))}},Dv=function(a,b){return new Promise(function(c){var d=setInterval(function(){Ev(a,b.id).then(function(a){"queued"!=
a.state&&"inProgress"!=a.state&&(clearInterval(d),c(a))})},2E3)})},Cv=function(a){a=zv(a);return"__cloud_webrtc_session_message__"==a.type?new uv("done","knocking_cloud_webrtc_session_message",new Iq(a.sessionDescription)):new uv("done",a.type)},Bv=function(a,b,c,d,e){b={deviceId:b,name:"_cloudCast."+c.name,parameters:d,expirationTimeoutMs:e||1E4};c={};e&&(c.responseAwaitMs=Math.min(e+5E3,25E3));e=cq(Rp.b,["commands"],c);return dq(a.b,e,"POST",b)},zv=function(a){return a.results&&a.results.results?
JSON.parse(a.results.results):null},Ev=function(a,b){b=cq(Rp.b,["commands",b]);return dq(a.b,b,"GET")};vv.$inject=["gapiService"];var Fv=function(a,b,c,d){this.f=a;this.g=b;this.h=c;this.b=d},rv=function(a,b,c,d){return Gv(a,b,d).then(function(b){a:{var d=c.id;if("done"!=b.state)d=Promise.reject(Error("Offer not executed by receiver. State: "+b.state));else{switch(b.type){case "__cloud_webrtc_session_message__":b=new Qg("ANSWER",b.results.sessionDescription);Eu(a.b,b,d);break;case "knocking_cloud_webrtc_session_message":Mp(0);b=new Qg("KNOCK_ANSWER",b.results.sessionDescription);Eu(a.b,b,d);break;case "knock_denied":Mp(1);Hv(a,
wu,d);break;case "knock_timeout":Mp(2);Hv(a,xu,d);break;default:d=Promise.reject(Error("Invalid message type: "+b.type));break a}d=Promise.resolve()}}return d})},sv=function(a,b){return lv(a.h).then(function(c){Eu(a.b,new Qg("TURN_CREDENTIALS",{credentials:c}),b.id)})},Gv=function(a,b,c){var d=c.deviceId,e=a.g.b;e=e?new Gq(e):void 0;b=b.data;switch(c.di){case "owner":Pp(0);break;case "manager":Pp(1);break;case "user":Pp(2);break;case "viewer":Pp(3)}return"viewer"==c.di?yv(a.f,d,b,e):Av(a.f,d,b,e)},
Hv=function(a,b,c){b=new Af(b,"warning");Df(b);a.b.b.ze(b);Eu(a.b,new Qg("STOP"),c)};var Iv=function(){var a=this;this.m=gb("mr.cloud.settings.SettingsService");this.b=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){rg(13);if(a.b){b=k(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.b.call(null,c.value);break}}})},Jv=function(a,b){a.b=b},Kv=function(a){var b=a.m;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&b.F("Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})},
Mv=function(a){return Lv().catch(function(){return Lv().catch(function(b){a.m.F("Error retrieving cloud on setting.",b);return!1})})},Lv=function(){return Nv("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})},Nv=function(a){return new Promise(function(b,c){chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?c(chrome.runtime.lastError):b(a)})})},Pv=function(a){return Ov().catch(function(){return Ov().catch(function(b){a.m.F("Error retrieving cloud enabled setting.",
b);return!1})})},Ov=function(){return Qv().then(function(a){return!!a.value})},Qv=function(){return new Promise(function(a,b){chrome.settingsPrivate.getPref("media_router.cloudservices.enabled",function(c){chrome.runtime.lastError?b(chrome.runtime.lastError):a(c)})})},Rv=function(a){var b=a.m;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&b.F("Error setting notified Hangout privacy.",chrome.runtime.lastError)})},Tv=function(a){return Sv().catch(function(){return Sv().catch(function(b){a.m.F("Error retrieving hangouts notified setting.",
b);return!1})})},Sv=function(){return Nv("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var Uv=new Map([["displayName","display_name"],["description","description"],["type","type"],["status","status"],["state","state"],["commandDefs","command_defs"]]),Vv=function(a,b){jt.call(this,a,b)};n(Vv,jt);g=Vv.prototype;g.act=function(a,b){a=new ur({method:"POST",Vb:this.b,sc:["devices:act"],cb:this.cb,body:{gcmId:b,id:a}});return this.f.execute(a).then(function(a){return a})};g.create=function(a){a=new ur({method:"POST",Vb:this.b,sc:["devices"],cb:this.cb,body:a});return this.f.execute(a).then(function(a){return a})};
g.delete=function(a){a=new ur({method:"DELETE",Vb:this.b,sc:["devices",a],cb:this.cb});return this.f.execute(a)};g.get=function(a){a=new ur({method:"GET",Vb:this.b,sc:["devices",a],cb:this.cb});return this.f.execute(a).then(function(a){return a})};g.list=function(a){var b=a.type,c=a.status;a=a.permission;var d={};b&&(d.type=b);c&&(d.status=c);a&&(d.permission=a);b=new ur({method:"GET",Vb:this.b,sc:["devices"],Nl:d,cb:this.cb});return this.f.execute(b).then(function(a){return a.device||[]})};
g.update=function(a,b){for(var c=[],d={},e=k(Uv.keys()),f=e.next();!f.done;f=e.next())f=f.value,b[f]&&(d[f]=b[f],c.push(Uv.get(f)));d.id=a;a=new ur({method:"PUT",Vb:this.b,sc:["devices",a],cb:this.cb,body:{device:d,updateMask:c}});return this.f.execute(a).then(function(a){return a})};var Wv=function(a,b,c,d,e,f){f=void 0===f?null:f;this.m=gb("mr.cloud.slarti.SinkDiscoveryService");this.l=a;this.g=b;this.f=c;this.j=d;this.h=e;this.b=f||new Xq(this.o.bind(this),c,36E5);qt().addListener();kj(this);og("mr.cloud.slarti.SinkDiscoveryService",this)};n(Wv,dg);Wv.prototype.Jd=function(){nt(this.h).catch(function(){});return this.b.Jd().filter(function(a){return a.isAvailable})};Wv.prototype.ka=function(a){return this.b.ka(a)};
Wv.prototype.handleEvent=function(a,b){if(a!=chrome.gcm.onMessage)throw Error("Unhandled event: expected chrome.gcm.onMessage");Xv(this,b)};
var Xv=function(a,b){var c=JSON.parse(b.data.data);a.m.info("Received Slarti GCM notification: "+c.type);nb(a.m,function(){return"Got notification: "+JSON.stringify(c)});switch(c.type){case "DEVICE_ADDED":Yv(a,c).then(function(c){"cast-receiver"==c.type&&(c=new Wq(c.id,c.displayName,"ONLINE"==c.status),a.b.b.set(c.id,c),ar(a.f,[c.jb]))});break;case "DEVICE_CHANGED":Yv(a,c).then(function(c){if("cast-receiver"==c.type){var b=Fj(Ej(),c.id);if(b=a.b.ka(b))b.displayName=c.displayName,b.isAvailable="ONLINE"==
c.status,br(a.f,[b.jb])}});break;case "DEVICE_REMOVED":Zv(a,$v(c));Promise.resolve();break;case "COMMAND_CHANGED":aw(a,c).then(function(c){var b=a.j,d=c.id,h=b.f.get(d);if(h){var l=h.routeId,r=h.sinkId,y=h.resolve,B=h.reject,G=h.np;h=!0;try{var aa=JSON.parse(c.results||"{}"),P=aa.sessionDescription,ha=aa.errorCode,Ea=aa.errorText;switch(c.status){case "SUCCESS":y(Eu(b.b,new Qg("ANSWER",P),l));G&&Mp(0);break;case "ERROR":case "TIMEOUT":var ae="TIMEOUT"==c.status;y=vu;"KNOCK_DENIED"==ha&&(Mp(ae?2:1),
y=ae?xu:wu);Fu(b.b,l,7,Ff(Ef(Df(new Af(y,"warning")),l),r));throw Error("Slarti command "+d+" failed with status: "+(c.status+", errorCode: "+ha+", ")+("errorText: "+Ea));default:h=!1}}catch(ug){B(ug)}finally{h&&b.f.delete(d)}}else b.m.F("Received update to unknown command with "+("name = "+c.name+" and id = "+d))});break;default:Promise.resolve()}};
Wv.prototype.o=function(){return this.g.list({type:"cast-receiver"}).then(function(a){return a.map(function(a){return new Wq(a.id,a.displayName,"ONLINE"==a.status)})})};Wv.prototype.Aa=function(){return"SlartiSinkDiscoveryService"};Wv.prototype.fb=function(){return[{cache:er(this.b)}]};Wv.prototype.eb=function(){var a=hj(this);a&&fr(this.b,a.cache)};
var Zv=function(a,b){b=Fj(Ej(),b);var c=a.b.ka(b);c&&(a.b.b.delete(b),cr(a.f,[c.jb]))},$v=function(a){a=a.deviceInfo;return a.device?a.device.id:a.deviceId},Yv=function(a,b){b=b.deviceInfo;return b.device?Promise.resolve(b.device):a.g.get(b.deviceId)},aw=function(a,b){b=b.commandInfo;return b.command?Promise.resolve(b.command):a.l.get(b.commandId)};var bw=function(){this.b=null},cw=function(a,b){if(!a.b||L(a.b,2)<L(b,2))a.b=Li(b)},dw=function(a){return a.b?L(a.b,2)+";"+L(a.b,1):null};var ew=function(){this.B=this.l=this.G=this.D=this.C=this.w=this.g=this.u=this.h=this.f=this.j=this.da=this.Y=this.Ca=this.N=this.O=this.zb=this.M=this.K=this.o=this.A=this.b=null},fw=function(){var a=ew.Ea();null==a.l&&(a.l=new bw);return a.l},gw=function(a){null==a.b&&(a.b=new pr);return a.b},hw=function(a){null==a.A&&(a.A=new Jt(gw(a)));return a.A},iw=function(a){null==a.o&&(a.o=new ht);return a.o},jw=function(a){null==a.K&&(a.K=new Iu(gw(a),iw(a)));return a.K},lw=function(a,b){null==a.N&&(a.N=
new mv(jw(a),kw(a),b));return a.N},mw=function(a){null==a.u&&(a.u=new vv(hw(a)));return a.u},kw=function(a){null==a.G&&(a.G=new iv(hw(a)));return a.G},nw=function(a){null==a.B&&(a.B=new Fq);return a.B};Ra(ew);var rw=function(a,b){this.g=a;this.l=b;this.j=new Cb;this.Z=this.j.b;this.b=ow(a.id);this.f=new Cb;this.h=!1;pw(this);qw(this);this.b.sendMessage(new Qg("GET_TURN_CREDENTIALS"))};rw.prototype.start=function(){var a=this;return this.Z.then(function(b){if(b.b)return Promise.reject(Error("Presentation already started"));b.start();return a.f.b})};rw.prototype.stop=function(){var a=this;this.h=!1;return this.Z.then(function(b){b.stop();a.Z=Promise.reject(Error("Peer connection has already been stopped"))})};
var pw=function(a){a.b.onMessage=function(b){if(b.type)switch(b.type){case "TURN_CREDENTIALS":a.j.resolve(new Vg(a.g.id,b.data.credentials));break;case "ANSWER":a.Z.then(function(a){ch(a,b.data)});break;case "STOP":a.f.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}else a.Z.then(function(a){var c={type:"PRESENTATION_CONNECTION_MESSAGE",data:b};"string"==typeof c?a.h.send(c):a.h.send(JSON.stringify(c))})}},qw=function(a){a.Z.then(function(b){Zg(b,
function(c){a.b.sendMessage(new Qg("OFFER",new Sg(c,null,null,a.l,a.g.id)))});$g(b,function(c){c=Rg(c);"STOP"==c.type&&a.stop();a.b.sendMessage(c)});Wg(b,function(){a.h=!0;a.b.sendMessage(new Qg("SESSION_START_SUCCESS"));a.f.resolve(a.g)});Yg(b,function(){a.b.sendMessage(new Qg("SESSION_END"))});Xg(b,function(c){a.h||a.f.reject(c);a.b.sendMessage(new Qg("SESSION_FAILURE"))})})};var sw=function(a){this.b=a;this.f=new Map;this.C=new Map;this.D=new Map;this.A=[];this.j=this.G=this.B=this.N=this.l=null;this.o=this.h=this.g=!1;this.w=new Map;this.u=new Map;kj(this)};sw.prototype.getName=function(){return"cloud"};
sw.prototype.initialize=function(){var a=this;this.m.info("Initializing Cloud MRP");var b=ew.Ea();null==b.da&&(null==b.Y&&(b.Y=new Oq(hw(b),nw(b))),b.da=new zt(b.Y,this));this.A.push(b.da);if(null==b.O){var c=jw(b);null==b.M&&(b.M=new Vv(gw(b),iw(b)));var d=b.M,e=lw(b,this);null==b.Ca&&(null==b.zb&&(b.zb=new kt(gw(b),iw(b))),b.Ca=new lt(b.zb,window.localStorage,nw(b)));b.O=new Wv(c,d,this,e,b.Ca)}this.A.push(b.O);null==b.h&&(null==b.f&&(b.f=new Xp(hw(b),gw(b))),c=b.f,null==b.j&&(b.j=new Bu(hw(b))),
b.h=new ir(c,b.j,this));this.l=b.h;this.A.push(this.l);this.N=mw(b);lw(b,this);this.B=gw(b);null==b.C&&(c=lw(b,this),null==b.g&&(b.g=new Fv(mw(b),gw(b),kw(b),this)),d=b.g,null==b.w&&(b.w=new Du(gw(b),this)),b.C=new qv(c,d,b.w,this));this.G=b.C;null==b.D&&(b.D=new Iv);this.j=b.D;Pv(this.j).then(function(c){a.g=c;a.m.info("Cloud enabled setting: "+a.g)});Mv(this.j).then(function(c){a.h=c;a.m.info("Cloud on setting: "+a.h)});Jv(this.j,function(c){a.g=c;a.m.info("Cloud enabled setting: "+a.g);a.g&&tw(a)});
Tv(this.j).then(function(c){a.o=c;a.m.info("Privacy notified setting: "+a.o)})};sw.prototype.fd=function(){return Array.from(this.f.values())};
sw.prototype.fg=function(a){if(!uw(this,a))return Cn;nb(this.m,"GetAvailableSinks for "+a);var b=[];if(this.h||vw())b=tw(this);this.u.clear();for(var c={},d=k(this.w.values()),e=d.next();!e.done;c={Qe:c.Qe,Og:c.Og},e=d.next())c.Qe=e.value,c.Og=!1,b.forEach(function(a){return function(c){c.id==a.Qe.id&&(a.Og=!0,c.jb.friendlyName=a.Qe.jb.friendlyName)}}(c)),c.Og||this.u.set(c.Qe.id,c.Qe);b=b.concat.apply(b,m(this.u.values()));nb(this.m,function(){return"Available sinks are..."+JSON.stringify(b)});c=
b.map(function(a){return a.jb});this.l&&(c=c.concat(ww));return new Bn(c,-1!=a.indexOf("0F5096E8")?xg:null)};var tw=function(a){var b=[];a.m.info("Checking cloud discovery services");Ej().g=t();a.A.forEach(function(a){a=a.Jd();b=b.concat(a)});return b};g=sw.prototype;g.startObservingMediaSinks=function(){};g.stopObservingMediaSinks=function(){};g.startObservingMediaRoutes=function(){};g.stopObservingMediaRoutes=function(){};g.ka=function(a){return(a=xw(this,a))?a.jb:null};
g.createRoute=function(a,b,c,d,e,f,h){var l=this;this.m.info("createRoute called");nb(this.m,"urn: "+a+" sinkId:"+b);if(e=this.C.get(b))return Hf(this.b.pl(this,e,a,c,h,function(c){c.mediaSource=a;c.ib.tabId=h;return If(c)}),function(a){l.b.ye(a);return a});e=xw(this,b);return yw(this,a,e,b,c,d,h)};
var zw=function(a,b,c,d,e){b instanceof An&&2==b.errorCode?Fu(a,c,6,null):(a.m.error("Error on start session",b instanceof Error?b:Error("Expected an Error value, got "+b)),a.f.has(c.id)&&Fu(a,c,e,Ff(new Af(vu,"warning"),c.sinkId)));if(b=a.l)b=a.l,b.f.delete(d.deviceId)?(b.b.b.delete(d.id),b=!0):b=!1;b&&cr(a,[d.jb])},yw=function(a,b,c,d,e,f,h){if(f)return Jf(Error("not supported"));f=!1;switch(c.b){case "slarti":case "weave":Op(1);break;case "mesi":f=!0;if(!a.o){a.o=!0;Rv(a.j);var l=Ff(Cf(),d);a.b.ze(l)}Op(0)}Ej().f=
new Bj(c.model,null);var r=Rm(e,a.getName(),d,b,!0,"");f&&(r.customControllerPath="cloud_route_details/view.html?routeId="+r.id,r.controllerType=mojo.RouteControllerType&&mojo.RouteControllerType.kHangouts);a.f.set(r.id,r);a.C.set(d,r);a.w.set(r.id,c);a.D.set(r.id,c.b);a.b.Cf(a,r);a.b.Ff(a.Aa(),!0);if(wg(b)&&!f)return a.m.info("starting presentation on route: "+r.id),Aw(r,b).catch(function(b){zw(a,b,r,c,7);throw b;});a.m.info("starting mirroring on route: "+r.id);r.ib={tabId:h,sessionId:"",If:"",
Od:c.model};wg(b)&&(r.isOffscreenPresentation=!0);return a.b.Oi(a,r,e).catch(function(b){zw(a,b,r,c,5);throw b;})};sw.prototype.terminateRoute=function(a){return Fu(this,a,0,null)};
var Fu=function(a,b,c,d){var e="string"==typeof b?a.f.get(b):b;if(!e)return Promise.reject(new An(3,"Route in cloud provider not found for routeId "+b));a.m.info("terminating route: "+e.id);a.f.delete(e.id);a.C.delete(e.sinkId);b=a.w.get(e.id);a.w.delete(e.id);d&&a.b.ze(d);Bb("MediaRouter.Cloud.Session.End",c,Jp);switch(c){case 1:break;default:switch(b.b){case "weave":Bv(a.N,b.deviceId,Nq,{})}}a.b.ng(e);0==a.f.size&&a.b.Ff(a.Aa(),!1);a.b.onPresentationConnectionStateChanged(e.id,"terminated");a.u.has(e.sinkId)&&
(c=a.u.get(e.sinkId),cr(a,[c.jb]),a.u.delete(e.sinkId));return Promise.resolve()};g=sw.prototype;g.sendRouteMessage=function(a,b){var c=this.D.get(a);if(c){var d=(a=this.f.get(a)||void 0)?xw(this,a.sinkId):void 0;return tv(this.G,c,b,a,d)}return Ja(b)?(Eu(this,b,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};g.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
g.nf=function(a){var b=new Og;5>b.minFrameRate&&(b.minFrameRate=5);var c=this.te(a);"hangouts"==c||"meetings"==c?(b.maxWidth=Math.min(window.screen&&window.screen.width||Infinity,2880),b.maxHeight=Math.min(window.screen&&window.screen.height||Infinity,1800)):b.senderSideLetterboxing=!0;Pg(b);Object.freeze(b);this.m.info("Settings for "+a+": "+Ng(b));if(!b.shouldCaptureAudio&&!b.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture.");return b};
g.te=function(a){var b=null;a=xw(this,a);switch(a.b){case "slarti":case "weave":b="webrtc";break;case "mesi":b=a.kd?"meetings":"hangouts"}return b};g.zh=function(){};g.Vf=function(a,b){nb(this.m,"Checking canRoute: "+a+" for sinkId: "+b);return uw(this,a)&&!!this.ka(b)};g.ff=function(a,b){return("https://hangouts.google.com/cloudmrp-mirroring"==a||wg(a))&&this.f.has(b)};g.joinRoute=function(a,b){return(a=this.f.get(b))?(this.m.info("joining route: "+a.id),If(a)):Jf(Error("not supported"))};
g.connectRouteByRouteId=function(){return Jf(Error("not supported"))};g.detachRoute=function(){};
var ar=function(a,b){a.m.info(b.length+" sinks added");0<b.length&&!a.h&&(Kv(a.j),a.h=!0);b=xw(a,b[0].id);Ej().b=new Bj(b.model,null);a.b.Nc();a.b.onSinkAvailabilityUpdated(a,2);a.m.info("sinkAvailability changed to AVAILABLE")},cr=function(a,b){a.m.info(b.length+" sinks removed");a.A.some(function(a){return 0<a.Jd().length})||(a.b.onSinkAvailabilityUpdated(a,0),a.m.info("sinkAvailability changed to UNAVAILABLE"));a.b.Nc()},br=function(a,b){a.m.info(b.length+" sinks updated");a.b.Nc()},Eu=function(a,
b,c,d){(void 0===d?0:d)?a.b.Id(c,b):a.b.yh(c,b)},xw=function(a,b){var c=Bw(a,b);c||(c=null,(b=a.C.get(b))&&(c=a.w.get(b.id)));return c},Bw=function(a,b){var c=null;a.A.some(function(a){c=a.ka(b);return!!c});return c},vw=function(){var a=Ej().g;return 3E5<=Date.now()-a},uw=function(a,b){var c=vg(b);b=wg(b);if(a.B.g&&!a.B.f&&c)return a.b.onSinkAvailabilityUpdated(a,2),!0;var d=!1;a.g&&a.B.f&&(d=!0);var e;if(e=!chrome.declarativeWebRequest)a=a.B,e=!(a.g||a.f&&a.b&&(-1!=tr.indexOf(a.b)||-1!=tr.indexOf(qr(a))))&&
b;return e?!1:d&&(c||b)};sw.prototype.searchSinks=function(a,b){var c=this;if(!uw(this,a))return Promise.reject(Error("err"));a=lr(this.l,b);a.then(function(a){ar(c,[a])});return a};var Cw=function(a,b){b=a.f.get(b);if(!b)return Promise.reject(Error("Route not found"));a=a.te(b.sinkId);return"hangouts"!=a&&"meetings"!=a?Promise.reject(Error("Unsupported sink channel type")):Gp(eg.get("mr.ProviderManager")||null,a)};g=sw.prototype;
g.createMediaRouteController=function(a,b,c){return Cw(this,a).then(function(d){return d.createMediaRouteController(a,b,c)})};g.provideSinks=function(){};g.Aa=function(){return"CloudProvider"};g.fb=function(){return[void 0,{cloudEnabled:this.g,cloudOn:this.h,notifiedHangoutsPrivacy:this.o}]};g.eb=function(){var a=ij(this);a&&(a.cloudEnabled&&(this.g=a.cloudEnabled),a.cloudOn&&(this.h=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.o=a.notifiedHangoutsPrivacy))};var Aw=function(a,b){a=new rw(a,b);return Kf(a.start())};
sw.prototype.m=gb("mr.CloudProvider");var ww=new dj("pseudo:cloud","","meeting","","default");var Dw=function(){Km.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};n(Dw,Km);Dw.prototype.Mg=function(a,b){return b.id&&-1!=Ew.indexOf(b.id)?"start"==a.type||"stop"==a.type||"subscribe_log_data"==a.type:!1};Dw.prototype.mi=function(){return!0};var Gw=function(){Fw||(Fw=new Dw);return Fw},Fw=null,Ew=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var Hw=function(){Km.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};n(Hw,Km);Hw.prototype.Mg=function(a,b){return"retrieve_log_data"==a.type&&b.id==chrome.runtime.id&&b.url=="chrome-extension://"+b.id+"/feedback.html"};Hw.prototype.mi=function(){return!0};var Jw=function(){Iw||(Iw=new Hw);return Iw},Iw=null;function Kw(){var a=Lw;var b=new Dn(a);var c=new Mo(a);b=[b,c];b.push(new sw(a));return b};var Mw=function(a,b){this.routeId=a;this.message=b},Nw=function(a){return"string"!=typeof a.message};var Ow=function(a){this.B=a;this.h=this.j=null},Pw=function(a){if(null==a.h)if(null==a.j||Date.now()-a.j>=a.B)a.l();else{var b=Math.max(a.j+a.B-Date.now(),5);a.h=setTimeout(a.l.bind(a),b)}};Ow.prototype.l=function(){null!=this.h&&(clearTimeout(this.h),this.h=null);this.u();this.j=Date.now()};Ow.prototype.u=function(){};var Qw=function(a,b){Ow.call(this,20);this.b=new Map;this.f=new Set;this.A=null;this.o=this.g=0;this.w=!1;this.D=a;this.C=b;this.m=gb("mr.RouteMessageSender")};n(Qw,Ow);Qw.prototype.init=function(a){this.A=a;kj(this)};Qw.prototype.stopListeningForRouteMessages=function(a){this.f.delete(a)};
Qw.prototype.send=function(a,b){var c=this.b.get(a);c||(c=[],this.b.set(a,c));b=new Mw(a,b);c.push(b);50<c.length&&1==c.length%50&&this.m.F(function(){return"Message queue length is excessively large "+("("+c.length+") for route "+a)});this.g+=Nw(b)?0:b.message.length;Nw(b)&&this.o++;Rw(this);this.f.has(a)&&Pw(this)};
var Sw=function(a,b){if(0!=b.length){b=k(b);for(var c=b.next();!c.done;c=b.next())c=c.value,a.g-=Nw(c)?0:c.message.length,Nw(c)&&a.o--}},Rw=function(a){var b=0<a.o||a.g>a.C;b!=a.w&&(a.w=b,a.D.Ff(a.Aa(),b))};Qw.prototype.u=function(){if(this.A){for(var a=k(this.f),b=a.next();!b.done;b=a.next()){b=b.value;var c=this.b.get(b);c&&0!=c.length&&(this.A(b,c),Sw(this,c),this.b.set(b,[]))}Rw(this)}else this.m.error("sendMessagesCallback not set. Messages not delivered.")};Qw.prototype.Aa=function(){return"mr.RouteMessageSender"};
Qw.prototype.fb=function(){var a=[].concat(m(this.b.entries())).map(function(a){return[a[0],a[1].map(function(a){return a.message})]});return[new Tw(a,Array.from(this.f),this.g)]};Qw.prototype.eb=function(){var a=hj(this);if(a){this.b=new Map;for(var b={},c=k(a.f),d=c.next();!d.done;b={Rg:b.Rg},d=c.next())d=d.value,b.Rg=d[0],d=d[1].map(function(a){return function(c){return new Mw(a.Rg,c)}}(b)),this.b.set(b.Rg,d);this.f=new Set(a.b);this.g=a.g}};var Tw=function(a,b,c){this.f=a;this.b=b;this.g=c};var Uw=function(a,b){this.type="internal_message";this.routeId=a;this.message=b};var Vw=function(a,b,c){this.b=a;this.h=b;this.g=c;this.onMessage=function(){};c.listen("internal_message",this.f,this)};Vw.prototype.sendMessage=function(a,b){return this.h(this.b,a,b)};Vw.prototype.f=function(a){if(a.routeId==this.b)this.onMessage(a.message)};Vw.prototype.Ua=function(){this.onMessage=function(){};Sn(this.g,this.f,this)};
var Ww=new Vw("",function(){return Promise.resolve()},new Rn),Xw=function(a){this.b=a},ow=function(a){var b=yf,c=b.b.ui(a);return c?new Vw(a,c.sendRouteMessage.bind(c),b.b.wi()):Ww};var Yw=function(a,b){this.l=null!=b?a.bind(b):a;this.j=this.o.bind(this);this.h=[];this.b=!1;this.f=null};Yw.prototype.g=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];this.h=[].concat(m(b));null==this.f?Zw(this):this.b=!0};var Zw=function(a){a.f=setTimeout(a.j,500);a.l.apply(a,m(a.h))};Yw.prototype.o=function(){this.f=null;this.b&&(this.b=!1,Zw(this))};var $w=function(){this.m=gb("mr.ProviderManager");this.g=[];this.f=new Map;this.o=new Map;this.j=new Set;this.h=new Set;this.B=new Map;this.b=this.u=null;this.K=new Rn;this.M=new Yw(this.dm,this);this.zb=new Yw(this.D,this);this.l=new Qw(this,524288);this.C=0;this.A=new Map;this.w=[];var a=new Bp(this);this.O=a.onMessage.bind(a);a=new sp(this);this.Ca=a.onMessage.bind(a);this.N="";this.G=!1;this.onBeforeInvokeHandler=this.onBeforeInvokeHandler;this.createRoute=this.createRoute;this.joinRoute=this.joinRoute;
this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;this.startObservingMediaRoutes=this.startObservingMediaRoutes;
this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.detachRoute=this.detachRoute;this.searchSinks=this.searchSinks;this.provideSinks=this.provideSinks;this.updateMediaSinks=this.updateMediaSinks;this.createMediaRouteController=this.createMediaRouteController};n($w,dg);
$w.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.runtime.onMessage)this.O.apply(this,m(c));else if(a==chrome.runtime.onMessageExternal)this.Ca.apply(this,m(c));else throw Error("Unhandled event");};
var Gp=function(a,b){b=a.B.get(b);return hg(b).then(function(c){c.initialize(a,a.G);return c})},ax=function(a,b,c){b.forEach(function(b){if(Fp(a,b.getName()))a.m.F("Provider "+b.getName()+" already registered.");else try{b.initialize(c),a.g.push(b),a.A.set(b.getName(),0)}catch(e){a.m.F("Provider "+b.getName()+" failed to initialize.",e)}})};
$w.prototype.initialize=function(a,b,c){this.B.set("webrtc","mr.mirror.webrtc.WebRtcService");this.B.set("cast_streaming","mr.mirror.cast.Service");this.B.set("hangouts","mr.mirror.hangouts.HangoutsService");this.B.set("meetings","mr.mirror.hangouts.MeetingsService");var d=new Xw(this);yf||(yf=d);this.b=a;this.l.init(this.b.onRouteMessagesReceived.bind(this.b));ax(this,b,c);c&&void 0!==c.use_views_dialog&&(this.N=c.use_views_dialog?"Views":"WebUI");c&&void 0!==c.use_mirroring_service&&(this.G=c.use_mirroring_service);
kj(this);og("mr.ProviderManager",this)};var cx=function(a,b,c){return new Promise(function(d,e){var f=null;a.C++;bx(a);f=window.setTimeout(function(){f=null;b.cancel(new An(2,"timeout after "+c+" ms."))},c);b.b.then(function(c){a.C--;bx(a);null!=f&&window.clearTimeout(f);d(c)},function(c){a.C--;bx(a);null!=f&&window.clearTimeout(f);e(c instanceof An?c:c instanceof Error?new An(0,c.message,c.stack):new An(0))})})};$w.prototype.onBeforeInvokeHandler=function(){rg(0)};
var dx=function(a){return"string"==typeof a?a:a.unique?"":a.scheme+"://"+a.host+"\n       "+(a.port?":"+a.port:"")+"/"};g=$w.prototype;
g.createRoute=function(a,b,c,d,e,f,h){var l=this;h=void 0===h?!1:h;var r=ex(this,a,b);if(!r)return Promise.reject(new An(7,"No provider supports createRoute with source: "+a+" and sink: "+b));var y=void 0;void 0!==d&&(y=dx(d));f=f&&0<f?f:6E4;a=r.createRoute(a,b,c,h,f,y,e);return cx(this,a,f).then(function(a){return a},function(a){l.m.error("Error creating route.",a);throw a;})};
g.connectRouteByRouteId=function(a,b,c,d,e,f){var h=this.f.get(b);if(!h)return Promise.reject(new An(7,"No provider supports join "+b));a=h.connectRouteByRouteId(a,b,c,dx(d),e);return cx(this,a,f&&0<f?f:3E4)};g.joinRoute=function(a,b,c,d,e,f){f=void 0===f?!1:f;var h=fx(this,a,b);if(!h)return Promise.reject(new An(7,"No provider supports join "+b));e=e&&0<e?e:3E4;a=h.joinRoute(a,b,f,e,dx(c),d);return cx(this,a,e)};
g.terminateRoute=function(a){var b=this.f.get(a);return b?gx(this,a).then(function(){return b.terminateRoute(a)}):Promise.reject(new An(3,"Route not found for routeId "+a))};g.startObservingMediaSinks=function(a){this.j.has(a)||(this.j.add(a),this.g.forEach(function(b){b.startObservingMediaSinks(a)}));hx(this,a)};g.stopObservingMediaSinks=function(a){this.j.delete(a)?ix(this,a):this.m.info("No existing query "+a)};
var ix=function(a,b){a.g.forEach(function(a){a.stopObservingMediaSinks(b)})},hx=function(a,b){if("urn:x-org.chromium.media:source:tab:-1"==b)a.m.F("No sinks for sourceUrn: "+b);else{var c=new Map,d=[];a.g.forEach(function(e){var f=e.fg(b);0<f.sinks.length&&(d=f.origins);f.sinks.forEach(function(b){c.has(b.id)?a.m.F("Detected duplicate sink "+b.id+" from provider: "+e.getName()):c.set(b.id,b)})});jx(a,b,Array.from(c.values()),d||[])}},jx=function(a,b,c,d){a.m.info("Sending "+c.length+" sinks to MR for "+
b);a.b.onSinksReceived(b,c,d.map(Ll))};g=$w.prototype;g.sendRouteMessage=function(a,b,c){var d=this.f.get(a);d?(a=d.sendRouteMessage(a,b,c),a=cx(this,Kf(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};g.sendRouteBinaryMessage=function(a,b){var c=this.f.get(a);c?(a=c.sendRouteBinaryMessage(a,b),a=cx(this,Kf(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};
g.startListeningForRouteMessages=function(a){var b=this.l;b.f.has(a)||(b.f.add(a),(a=b.b.get(a))&&0<a.length&&Pw(b))};g.stopListeningForRouteMessages=function(a){this.l.stopListeningForRouteMessages(a)};g.detachRoute=function(a){var b=this.f.get(a);b?b.detachRoute(a):this.m.info("Route "+a+" does not exist.")};g.enableMdnsDiscovery=function(){};var ex=function(a,b,c){return a.g.find(function(a){return a.Vf(b,c)})||null},fx=function(a,b,c){return a.g.find(function(a){return a.ff(b,c)})||null};
$w.prototype.D=function(){var a=this;this.j.forEach(function(b){hx(a,b)})};var bx=function(a){a.b.setKeepAlive(0<a.C||0<a.w.length)};g=$w.prototype;g.startObservingMediaRoutes=function(a){this.h.has(a)||(this.h.add(a),this.g.forEach(function(b){b.startObservingMediaRoutes(a)}));this.M.g()};g.stopObservingMediaRoutes=function(a){this.h.delete(a)?this.g.forEach(function(b){b.stopObservingMediaRoutes(a)}):this.m.info("No existing route query "+a)};
g.dm=function(){var a=this;if(0!=this.h.size){var b=[];this.g.forEach(function(a){b=b.concat(a.fd())});this.h.forEach(function(c){var d=[];a.g.forEach(function(a){a.fd().forEach(function(b){!b.jf&&a.ff(c,void 0,b)&&d.push(b.id)})});a.b.onRoutesUpdated(b,c,d)})}};g.Aa=function(){return"ProviderManager"};
g.fb=function(){return[new kx(this.g.map(function(a){return a.getName()}),Array.from(this.j),Array.from(this.h),Array.from(this.f,function(a){var b=k(a);a=b.next().value;b=b.next().value;return[a,b.getName()]}),Array.from(this.A),this.u)]};g.eb=function(){var a=hj(this);if(a){this.j=new Set(a.j);this.h=new Set(a.g);for(var b=k(a.f),c=b.next();!c.done;c=b.next()){var d=k(c.value);c=d.next().value;d=d.next().value;d=Fp(this,d);this.f.set(c,d)}this.A=new Map(a.h);this.u=a.b||null}};g.ui=function(a){return this.f.get(a)};
g.Cf=function(a,b){this.f.set(b.id,a);this.ye(b)};g.ng=function(a){gx(this,a.id);this.f.delete(a.id);var b=this.l,c=a.id;b.f.delete(c);var d=b.b.get(c);d&&(b.b.delete(c),Sw(b,d),Rw(b));this.ye(a)};g.ye=function(){0<this.h.size&&this.M.g()};g.Ai=function(a){var b=this.f.get(a.id);b&&(b.zh(a.id),0<this.h.size&&this.dm())};g.Id=function(a,b){this.f.has(a)?("string"===typeof b||b instanceof Uint8Array||(b=JSON.stringify(b)),this.l.send(a,b)):this.m.F("Got route message for closed route "+a)};
g.onPresentationConnectionStateChanged=function(a,b){"terminated"==b&&this.l.l();this.b.onPresentationConnectionStateChanged(a,b)};g.onPresentationConnectionClosed=function(a,b,c){this.l.l();this.b.onPresentationConnectionClosed(a,b,c)};g.cj=function(a){this.o.delete(a);var b=this.f.get(a);b&&b.terminateRoute(a)};g.yh=function(a,b){Tn(this.K,new Uw(a,b))};g.Nc=function(){this.zb.g()};
g.onSinkAvailabilityUpdated=function(a,b){var c=this;if(this.A.get(a.getName())!=b){var d=lx(this);this.A.set(a.getName(),b);a=lx(this);d!=a&&(0==a&&this.D(),this.b.onSinkAvailabilityUpdated(a),0==a&&(this.j.forEach(function(a){ix(c,a)}),this.j.clear()))}};var lx=function(a){return Array.from(a.A.values()).reduce(function(a,c){return Math.max(a,c)},0)};$w.prototype.wi=function(){return this.K};$w.prototype.ze=function(a){this.b.onIssue(a)};
var gx=function(a,b){return a.o.has(b)?Gp(a,a.o.get(b)).then(function(c){a.o.delete(b);return c.l()}):Promise.resolve(!1)};$w.prototype.Oi=function(a,b,c,d){var e=this,f=a.te(b.sinkId);this.m.info("Starting mirroring using service: "+f);this.o.set(b.id,f);return Lf(Gp(this,f),function(h){e.u=f;return h.Zi(b,b.mediaSource,a.nf(b.sinkId),c,d).catch(function(a){if(a instanceof Nf&&3==a.reason)throw new An(8);throw a;})})};
$w.prototype.pl=function(a,b,c,d,e,f){var h=this,l=this.o.get(b.id);return l?Lf(Gp(this,l),function(r){h.u=l;return r.aj(b,c,a.nf(b.sinkId),d,e,f)}):Jf(Error("Route "+b.id+" is not mirroring"))};$w.prototype.Ff=function(a,b){var c=this.w.indexOf(a),d=0<=c;b&&!d?this.w.push(a):!b&&d&&this.w.splice(c,1);bx(this)};var Fp=function(a,b){return a.g.find(function(a){return a.getName()==b})||null};g=$w.prototype;
g.searchSinks=function(a,b,c){var d=a.startsWith("pseudo:")?a.substring(7):null;return(d=d?Fp(this,d):null)?d.searchSinks(b,c).then(function(a){return a.id}):Promise.reject(Error("No provider supports "+a))};g.provideSinks=function(a,b){var c=Fp(this,a);c?c.provideSinks(b):this.m.error("provideSinks: Provider not found for providerName "+a)};g.updateMediaSinks=function(a){this.j.has(a)||hx(this,a)};
g.createMediaRouteController=function(a,b,c){var d=this,e=this.f.get(a);return e?e.createMediaRouteController(a,b,c).catch(function(a){d.m.error("createMediaRouteController failed: "+a.message);b.close();c.ptr.reset();throw a;}):(a="createMediaRouteController: Provider not found for "+a,this.m.error(a),b.close(),c.ptr.reset(),Promise.reject(Error(a)))};g.onMediaRemoterCreated=function(a,b,c){this.b.onMediaRemoterCreated(a,b,c)};
g.getMediaSinkServiceStatus=function(){return"function"!=typeof this.b.getMediaSinkServiceStatus?Promise.resolve({status:""}):this.b.getMediaSinkServiceStatus()};g.getMirroringServiceHostForTab=function(a,b){this.b.getMirroringServiceHostForTab(a,b)};g.getMirroringServiceHostForDesktop=function(a,b,c){this.b.getMirroringServiceHostForDesktop(a,b,c)};g.getMirroringServiceHostForOffscreenTab=function(a,b,c){this.b.getMirroringServiceHostForOffscreenTab(a,b,c)};
var kx=function(a,b,c,d,e,f){this.j=b;this.g=c;this.f=d;this.h=e;this.b=f};
